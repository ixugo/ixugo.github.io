---
title: Go 项目的思考与架构设计
description: 知道自己正在做什么，搞清楚为什么这样做，这样做的道理和效果，这样可以做出更好的设计决策。
date: 2023-05-16 12:31:29
slug: 
image: 
draft: false
categories:
    - 架构设计
tags:
    - 读书思考
---

读完《Go-with-domain》与《Domain-Driven Design with Golang》这两本书后，我有了一些感悟。

领域驱动设计广泛应用于解决大型复杂项目的问题。然而，将 DDD 应用于 CURD 程序可能会过度设计，并且会使交付速度变缓且更加繁琐。在实际开发中，我们面临更多中小型项目快速落地的情景，因此需要寻求开发效率和架构设计之间的平衡点。

同时，在保证高效率开发和可扩展性的前提下，应避免过度设计，确保代码具有良好的可读性、稳定性和可测试性。

如果您想深入了解领域驱动设计，可以阅读相关的专业书籍。对我而言，将其中的优点应用于我所遇到的项目，不会完全按照DDD规范去设计和开发，有时可能还会采用反模式。

### 从分层架构到分模型架构

通常，编写的应用程序中最多的是 CRUD。在这类项目中，分层架构得到了广泛应用。无论怎样变化，它大致都被分为 API/Service/DAO 三层。随着业务的发展，可能会出现一层内有 20 或 30 个文件，并且一个结构体的方法可能分布在不同的文件中。因此，组件也很难被复用于其他项目。

那么，为什么架构设计需要分层呢？分层架构的优点在于关注点分离、分而治之、低耦合和高内聚。

同样具备这些优点的是分模型架构，所谓分模型架构，基于模型驱动设计的思想，将复杂系统拆分为几个相关的模型。每个模型具有独立的职责，并且负责处理特定的功能，这种架构需要架构师对业务领域非常熟悉。

相比分层架构，它对行为上下文进行了更加明确的界限，使开发者可以专注于自己的领域模型。

领域就像积木，有简单的基层子域，也有依赖子域实现的更复杂领域。领域和子域几乎可以互换使用，这取决于对话上下文。

考虑到并不完全采用 DDD，但基于模型驱动设计，接下来将以“DDD lite”的方式称之。

## DDD lite

Golang 有很多谚语，例如 `不要通过共享内存来通信，通过通信来共享内存` ，遵循谚语会得到更好的编程体验和代码质量的提示。

接下来是 DDD lite 的相关谚语，这些谚语会帮助我们得到更好的架构设计。设计时应该考虑到未来的需求变化，具备高度的可扩展性和灵活性；而开发则需要在当前的需求和限制下，注重实现和可维护性，以达到交付可靠代码的目标。

### 谚语一: 通用语言

团队应该使用统一的术语表，这样在针对业务的讨论中就可以更加精准，不会出现词不达意、两个人说的不是同一件事的情况。

开发者应该在代码中使用这些术语、函数名和变量名，例如用“宝箱的开关”代替“设置属性为 true”。

有些人思维敏捷，可能会在上一秒谈论这个问题，下一秒谈论另一个问题。对于相似行为的页面，使用同一术语很容易造成误解，甚至在没有图片的情况下很难理解对方在说什么。

构建一种健壮、无处不在的语言，需要花费时间，没有捷径可走。在沟通和设计阶段，应记录任何术语，并将其添加到术语表中与其他同事分享。

尽管尝试在多个项目、团队甚至整个公司应用一种共通的语言可能很诱人，但这样做会导致术语失去严谨性，可能会造成混乱。因此，应谨慎考虑并选择最适合特定团队和项目的共通术语。



### 实战 REST ful 

未完结，欲知后事如何，请听下回分解。

### 实战 gRPC

未完结，欲知后事如何，请听下回分解。

