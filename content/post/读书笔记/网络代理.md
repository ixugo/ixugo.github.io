---
title: 网络代理 Hysteria2
description: 
date: 2025-11-19
slug: 
image: 
draft: false
categories:
tags:
---



## 背景

客户端: Clash Verge

服务端: hysteria2

## 部署

创建目录并增加 docker compose 文件

```bash
mkdir -p apps/hysteria2
vim apps/hysteria2/docker-compose.yml
```

文件内容如下:

```yaml
services:
  hysteria2:
    image: tobyxdd/hysteria:v2
    container_name: hysteria2
    restart: unless-stopped
    network_mode: host
    volumes:
      - ./config.yaml:/etc/hysteria/config.yaml:ro
      - ./certs:/etc/hysteria/certs:ro
    command: ["server", "-c", "/etc/hysteria/config.yaml"]
```

增加配置文件 `vim config.json`

配置文件中动态参数需要替换一下

+ `[password]` 替换

```json
# Hysteria2 服务端配置
listen: :443

# TLS 证书配置
tls:
  cert: /etc/hysteria/certs/fullchain.crt
  key: /etc/hysteria/certs/private.key

# 认证配置
auth:
  type: password
  password: [password]

# 伪装配置 (可选，用于绕过检测)
masquerade:
  type: proxy
  proxy:
    url: https://www.bing.com
    rewriteHost: true

# 带宽配置
# 忽略客户端带宽声明，使用服务端限制
# ignoreClientBandwidth: true

# QUIC 参数优化
quic:
  initStreamReceiveWindow: 8388608
  maxStreamReceiveWindow: 8388608
  initConnReceiveWindow: 20971520
  maxConnReceiveWindow: 20971520
  maxIdleTimeout: 30s
  maxIncomingStreams: 1024
  disablePathMTUDiscovery: false

# 出站配置
outbounds:
  - name: direct
    type: direct
```

执行启动命令

```bash
docker compose up -d
```

可以检查容器是否启动成功，确保服务器安全组开放 443/UDP 端口。

## Clash Verge

进入 「配置」-「打开配置文件夹」，快键键是 `CMD+O`

创建配置文件，比如 `my.yaml`，写入以下内容，这里有 2 个动态参数，替换域名和密码，必须跟之前在服务端配置相同的参数。

保存并切换此配置，重载配置文件，上网试试。

```python
# Clash Verge 配置文件 - Hysteria2 代理
# 域名: clash.golang.space
# 协议: Hysteria2 (基于 QUIC/UDP)
#
# 使用方法:
# 1. 打开 Clash Verge -> 配置
# 2. 导入此配置文件或手动添加 proxies 部分到现有配置

proxies:
  - name: "Hysteria2"
    type: hysteria2
    server: [domain]
    port: 443
    password: [password]
    # SNI 用于 TLS 握手
    sni: [domain]
    # 跳过证书验证 (如果使用自签名证书则设为 true)
    skip-cert-verify: false
    # 带宽设置 (根据你的实际带宽调整)
    # 峰值带宽 30Mbps，建议设置稍低一点
    up: "25 Mbps"
    down: "100 Mbps"
    # 启用 UDP 转发
    udp: true

# 如果你有多个节点，可以创建代理组
proxy-groups:
  - name: "PROXY"
    type: select
    proxies:
      - "xx"
      - DIRECT

# 分流规则 (可选，根据需要调整)
rules:
  # 常用国内直连
  - DOMAIN-SUFFIX,cn,DIRECT
  - DOMAIN-SUFFIX,baidu.com,DIRECT
  - DOMAIN-SUFFIX,qq.com,DIRECT
  - DOMAIN-SUFFIX,weixin.qq.com,DIRECT
  - DOMAIN-SUFFIX,taobao.com,DIRECT
  - DOMAIN-SUFFIX,jd.com,DIRECT
  - DOMAIN-SUFFIX,bilibili.com,DIRECT

  # 常用需要代理的域名
  - DOMAIN-SUFFIX,google.com,PROXY
  - DOMAIN-SUFFIX,googleapis.com,PROXY
  - DOMAIN-SUFFIX,github.com,PROXY
  - DOMAIN-SUFFIX,githubusercontent.com,PROXY
  - DOMAIN-SUFFIX,openai.com,PROXY
  - DOMAIN-SUFFIX,cursor.sh,PROXY
  - DOMAIN-SUFFIX,anthropic.com,PROXY

  # 默认走代理
  - MATCH,PROXY

```

### 规则

可以从其他配置中拷贝规则，并替换匹配的 name 即可。



