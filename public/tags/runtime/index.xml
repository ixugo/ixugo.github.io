<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
    <channel>
        <title>Runtime on ixugo</title>
        <link>https://blog.golang.space/tags/runtime/</link>
        <description>Recent content in Runtime on ixugo</description>
        <generator>Hugo -- gohugo.io</generator>
        <language>zh-cn</language>
        <lastBuildDate>Tue, 20 May 2025 00:00:00 +0000</lastBuildDate><atom:link href="https://blog.golang.space/tags/runtime/index.xml" rel="self" type="application/rss+xml" /><item>
        <title>Go è°ƒåº¦å™¨</title>
        <link>https://blog.golang.space/p/go-%E8%B0%83%E5%BA%A6%E5%99%A8/</link>
        <pubDate>Tue, 20 May 2025 00:00:00 +0000</pubDate>
        
        <guid>https://blog.golang.space/p/go-%E8%B0%83%E5%BA%A6%E5%99%A8/</guid>
        <description>&lt;h2 id=&#34;å…è´£å£°æ˜&#34;&gt;å…è´£å£°æ˜&lt;/h2&gt;
&lt;p&gt;æœ¬åšæ–‡ä¸»è¦å…³æ³¨åœ¨ &lt;a class=&#34;link&#34; href=&#34;https://en.wikipedia.org/wiki/ARM_architecture_family&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;ARM&lt;/a&gt; æ¶æ„ &lt;a class=&#34;link&#34; href=&#34;https://en.wikipedia.org/wiki/Linux&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Linux&lt;/a&gt; ä¸Šè¿è¡Œçš„ &lt;a class=&#34;link&#34; href=&#34;https://tip.golang.org/doc/go1.24&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Go 1.24&lt;/a&gt; ç¼–ç¨‹è¯­è¨€ã€‚å®ƒå¯èƒ½ä¸æ¶µç›–å…¶ä»–æ“ä½œç³»ç»Ÿæˆ–ç¡¬ä»¶æ¶æ„çš„å¹³å°ç‰¹å®šç»†èŠ‚ã€‚&lt;/p&gt;
&lt;p&gt;æœ¬æ–‡å†…å®¹åŸºäºå…¶ä»–èµ„æ–™ä»¥åŠæˆ‘ä¸ªäººå¯¹ Go çš„ç†è§£ï¼Œå› æ­¤å¯èƒ½å¹¶ä¸å®Œå…¨å‡†ç¡®ã€‚æ¬¢è¿åœ¨æ–‡æœ«è¯„è®ºåŒºæŒ‡æ­£æˆ–æå‡ºå»ºè®®ğŸ˜„ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ä»‹ç»&#34;&gt;ä»‹ç»&lt;/h2&gt;
&lt;p&gt;Golang äº 2009 å¹´æ¨å‡ºï¼Œä½œä¸ºä¸€ç§ç”¨äºæ„å»ºå¹¶å‘åº”ç”¨ç¨‹åºçš„ç¼–ç¨‹è¯­è¨€ï¼Œå…¶å—æ¬¢è¿ç¨‹åº¦ç¨³æ­¥å¢é•¿ã€‚å®ƒçš„è®¾è®¡ç›®æ ‡æ˜¯ç®€å•ã€é«˜æ•ˆä¸”æ˜“äºä½¿ç”¨ã€‚&lt;/p&gt;
&lt;p&gt;Go çš„å¹¶å‘æ¨¡å‹å›´ç»• goroutine çš„æ¦‚å¿µæ„å»ºï¼Œgoroutine æ˜¯ç”± Go è¿è¡Œæ—¶åœ¨ç”¨æˆ·ç©ºé—´ç®¡ç†çš„è½»é‡çº§ç”¨æˆ·çº¿ç¨‹ã€‚Go æä¾›äº†è¯¸å¦‚é€šé“ (channel) ç­‰ç”¨äºåŒæ­¥çš„å®ç”¨åŸè¯­ï¼Œå¸®åŠ©å¼€å‘è€…è½»æ¾ç¼–å†™å¹¶å‘ä»£ç ã€‚å®ƒè¿˜é‡‡ç”¨äº†ä¸€äº›å·§å¦™çš„æŠ€æœ¯æ¥æé«˜ I/O å¯†é›†å‹ç¨‹åºçš„æ•ˆç‡ã€‚&lt;/p&gt;
&lt;p&gt;ç†è§£ Go è°ƒåº¦å™¨å¯¹äº Go ç¨‹åºå‘˜ç¼–å†™é«˜æ•ˆçš„å¹¶å‘ç¨‹åºè‡³å…³é‡è¦ã€‚å®ƒè¿˜èƒ½å¸®åŠ©æˆ‘ä»¬æ›´å¥½åœ°æ’æŸ¥æ€§èƒ½é—®é¢˜æˆ–ä¼˜åŒ– Go ç¨‹åºçš„æ€§èƒ½ã€‚åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†æ¢è®¨ Go è°ƒåº¦å™¨çš„å‘å±•å†ç¨‹ï¼Œä»¥åŠæˆ‘ä»¬ç¼–å†™çš„ Go ä»£ç åœ¨åº•å±‚æ˜¯å¦‚ä½•è¿ä½œçš„ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ç¼–è¯‘å’Œ-go-è¿è¡Œæ—¶&#34;&gt;ç¼–è¯‘å’Œ Go è¿è¡Œæ—¶&lt;/h2&gt;
&lt;p&gt;æœ¬æ–‡åŒ…å«å¤§é‡æºä»£ç è§£æï¼Œå› æ­¤æœ€å¥½å…ˆå¯¹ Go ä»£ç çš„ç¼–è¯‘å’Œæ‰§è¡Œæ–¹å¼æœ‰ä¸€å®šçš„äº†è§£ã€‚Go ç¨‹åºçš„æ„å»ºè¿‡ç¨‹åˆ†ä¸ºä¸‰ä¸ªé˜¶æ®µï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Go æºæ–‡ä»¶ï¼ˆ &lt;code&gt;*.go&lt;/code&gt; ï¼‰è¢«ç¼–è¯‘æˆæ±‡ç¼–æ–‡ä»¶ï¼ˆ &lt;code&gt;*.s&lt;/code&gt; ï¼‰&lt;/li&gt;
&lt;li&gt;ç„¶åå°†æ±‡ç¼–æ–‡ä»¶ï¼ˆ &lt;code&gt;*.s&lt;/code&gt; ï¼‰æ±‡ç¼–æˆç›®æ ‡æ–‡ä»¶ï¼ˆ &lt;code&gt;*.o&lt;/code&gt; ï¼‰&lt;/li&gt;
&lt;li&gt;ç›®æ ‡æ–‡ä»¶ï¼ˆ &lt;code&gt;*.o&lt;/code&gt; ï¼‰é“¾æ¥åœ¨ä¸€èµ·ï¼Œç”Ÿæˆä¸€ä¸ªå¯æ‰§è¡Œçš„äºŒè¿›åˆ¶æ–‡ä»¶&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è¦ç†è§£ Go è°ƒåº¦å™¨ï¼Œé¦–å…ˆéœ€è¦ç†è§£ Go è¿è¡Œæ—¶ã€‚Go è¿è¡Œæ—¶æ˜¯è¿™é—¨ç¼–ç¨‹è¯­è¨€çš„æ ¸å¿ƒï¼Œå®ƒæä¾›äº†è°ƒåº¦ã€å†…å­˜ç®¡ç†å’Œæ•°æ®ç»“æ„ç­‰åŸºæœ¬åŠŸèƒ½ã€‚å®ƒæœ¬è´¨ä¸Šå°±æ˜¯ä¸€ç³»åˆ—å‡½æ•°å’Œæ•°æ®ç»“æ„çš„é›†åˆï¼Œæ­£æ˜¯è¿™äº›å‡½æ•°å’Œæ•°æ®ç»“æ„ä½¿ Go ç¨‹åºèƒ½å¤Ÿæ­£å¸¸è¿è¡Œã€‚Go è¿è¡Œæ—¶çš„å®ç°ä½äº &lt;a class=&#34;link&#34; href=&#34;https://github.com/golang/go/tree/go1.24.0/src/runtime&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;runtime&lt;/a&gt; åŒ…ä¸­ã€‚Go è¿è¡Œæ—¶æ˜¯ç”¨ Go ä»£ç å’Œæ±‡ç¼–ä»£ç æ··åˆç¼–å†™çš„ï¼Œå…¶ä¸­æ±‡ç¼–ä»£ç ä¸»è¦ç”¨äºå¤„ç†å¯„å­˜å™¨ç­‰åº•å±‚æ“ä½œã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://img.golang.space/img-1769564763579.png&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;img&#34;
	
	
&gt;&lt;/p&gt;
&lt;p&gt;ç¼–è¯‘æ—¶ï¼ŒGo ç¼–è¯‘å™¨ä¼šå°†ä¸€äº›å…³é”®å­—å’Œå†…ç½®å‡½æ•°æ›¿æ¢ä¸º Go è¿è¡Œæ—¶çš„å‡½æ•°è°ƒç”¨ã€‚ä¾‹å¦‚ï¼Œç”¨äºåˆ›å»ºæ–° goroutine çš„ &lt;code&gt;go&lt;/code&gt; å…³é”®å­—ä¼šè¢«æ›¿æ¢ä¸ºå¯¹ &lt;a class=&#34;link&#34; href=&#34;https://github.com/golang/go/blob/go1.24.0/src/runtime/proc.go#L5014-L5030&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;&lt;code&gt;runtime.newproc&lt;/code&gt;&lt;/a&gt; çš„è°ƒç”¨ï¼Œæˆ–è€…ç”¨äºåˆ†é…æ–°å¯¹è±¡çš„ &lt;code&gt;new&lt;/code&gt; å‡½æ•°ä¼šè¢«æ›¿æ¢ä¸ºå¯¹ &lt;a class=&#34;link&#34; href=&#34;https://github.com/golang/go/blob/go1.24.0/src/runtime/malloc.go#L1710-L1715&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;&lt;code&gt;runtime.newobject&lt;/code&gt;&lt;/a&gt; çš„è°ƒç”¨ã€‚&lt;/p&gt;
&lt;p&gt;ä½ å¯èƒ½ä¼šæƒŠè®¶åœ°å‘ç°ï¼ŒGo è¿è¡Œæ—¶ä¸­çš„æŸäº›å‡½æ•°æ ¹æœ¬æ²¡æœ‰ Go å®ç°ã€‚ä¾‹å¦‚ï¼Œåƒ &lt;a class=&#34;link&#34; href=&#34;https://github.com/golang/go/blob/go1.24.0/src/runtime/stubs.go#L28-L31&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;&lt;code&gt;getg&lt;/code&gt;&lt;/a&gt; è¿™æ ·çš„å‡½æ•°ä¼šè¢« Go ç¼–è¯‘å™¨è¯†åˆ«ï¼Œå¹¶åœ¨ç¼–è¯‘è¿‡ç¨‹ä¸­è¢«æ›¿æ¢ä¸ºåº•å±‚æ±‡ç¼–ä»£ç ã€‚è€Œåƒ &lt;a class=&#34;link&#34; href=&#34;https://github.com/golang/go/blob/go1.24.0/src/runtime/stubs.go#L214-L214&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;&lt;code&gt;gogo&lt;/code&gt;&lt;/a&gt; è¿™æ ·çš„å…¶ä»–å‡½æ•°åˆ™æ˜¯å¹³å°ç‰¹å®šçš„ï¼Œå®Œå…¨ç”¨æ±‡ç¼–è¯­è¨€å®ç°ã€‚Go é“¾æ¥å™¨çš„èŒè´£æ˜¯å°†è¿™äº›æ±‡ç¼–å®ç°ä¸å…¶ Go å£°æ˜è¿æ¥èµ·æ¥ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œä¸€ä¸ªå‡½æ•°åœ¨å…¶åŒ…ä¸­ä¼¼ä¹æ²¡æœ‰å®ç°ï¼Œä½†å®é™…ä¸Šå®ƒé€šè¿‡ &lt;a class=&#34;link&#34; href=&#34;https://pkg.go.dev/cmd/compile#hdr-Linkname_Directive&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;&lt;code&gt;//go:linkname&lt;/code&gt;&lt;/a&gt; ç¼–è¯‘å™¨æŒ‡ä»¤é“¾æ¥åˆ°äº† Go è¿è¡Œæ—¶ä¸­çš„å®šä¹‰ã€‚ä¾‹å¦‚ï¼Œå¸¸ç”¨çš„ &lt;a class=&#34;link&#34; href=&#34;https://github.com/golang/go/blob/go1.24.0/src/time/sleep.go#L12-L14&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;&lt;code&gt;time.Sleep&lt;/code&gt;&lt;/a&gt; å‡½æ•°å°±é“¾æ¥åˆ°äº†å…¶åœ¨ &lt;a class=&#34;link&#34; href=&#34;https://github.com/golang/go/blob/go1.24.0/src/runtime/time.go#L297-L340&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;&lt;code&gt;runtime.timeSleep&lt;/code&gt;&lt;/a&gt; ä¸­çš„å®é™…å®ç°ã€‚&lt;/p&gt;
&lt;h2 id=&#34;åŸå§‹è°ƒåº¦å™¨&#34;&gt;åŸå§‹è°ƒåº¦å™¨&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;âš ï¸ Go è°ƒåº¦å™¨å¹¶éä¸€ä¸ªç‹¬ç«‹çš„å¯¹è±¡ï¼Œè€Œæ˜¯ä¸€ç»„ç”¨äºè¾…åŠ©è°ƒåº¦çš„å‡½æ•°é›†åˆã€‚æ­¤å¤–ï¼Œå®ƒå¹¶ä¸è¿è¡Œåœ¨ä¸“ç”¨çº¿ç¨‹ä¸Šï¼›ç›¸åï¼Œå®ƒä¸ goroutine è¿è¡Œåœ¨ç›¸åŒçš„çº¿ç¨‹ä¸Šã€‚é˜…è¯»æœ¬æ–‡åç»­å†…å®¹åï¼Œè¿™äº›æ¦‚å¿µå°†å˜å¾—æ›´åŠ æ¸…æ™°ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;å¦‚æœä½ æ›¾ç»ä»äº‹è¿‡å¹¶å‘ç¼–ç¨‹ï¼Œä½ å¯èƒ½å¯¹å¤šçº¿ç¨‹æ¨¡å‹æœ‰æ‰€äº†è§£ã€‚å®ƒè§„å®šäº†ç”¨æˆ·ç©ºé—´çº¿ç¨‹ï¼ˆKotlinã€Lua ä¸­çš„åç¨‹æˆ– Go ä¸­çš„ goroutineï¼‰å¦‚ä½•å¤ç”¨åˆ°å•ä¸ªæˆ–å¤šä¸ªå†…æ ¸çº¿ç¨‹ä¸Šã€‚é€šå¸¸æœ‰ä¸‰ç§æ¨¡å‹ï¼šå¤šå¯¹ä¸€ (N:1)ã€ä¸€å¯¹ä¸€ (1:1) å’Œå¤šå¯¹å¤š (M:N)ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://img.golang.space/img-1769567248984.png&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;img&#34;
	
	
&gt;&lt;/p&gt;
&lt;p&gt;Go é‡‡ç”¨å¤šå¯¹å¤šï¼ˆM:Nï¼‰çš„çº¿ç¨‹æ¨¡å‹ï¼Œå…è®¸å¤šä¸ª goroutine è¢«å¤ç”¨ï¼ˆå¤šè·¯å¤ç”¨ï¼‰åˆ°å¤šä¸ªå†…æ ¸çº¿ç¨‹ä¸Šã€‚è¿™ç§æ–¹æ³•åœ¨ä¸€å®šç¨‹åº¦ä¸Šå¢åŠ äº†å¤æ‚æ€§ï¼Œä½†èƒ½å¤Ÿå……åˆ†åˆ©ç”¨å¤šæ ¸ç³»ç»Ÿçš„æ€§èƒ½ï¼Œå¹¶é«˜æ•ˆå¤„ç†ç³»ç»Ÿè°ƒç”¨ï¼Œä»è€Œå…‹æœäº† N:1 æ¨¡å‹å’Œ 1:1 æ¨¡å‹å„è‡ªå­˜åœ¨çš„é—®é¢˜ã€‚ç”±äºå†…æ ¸å¹¶ä¸çŸ¥é“ goroutine çš„å­˜åœ¨ï¼Œå®ƒä»…å‘ç”¨æˆ·ç©ºé—´åº”ç”¨ç¨‹åºæä¾›çº¿ç¨‹ä½œä¸ºå¹¶å‘å•å…ƒï¼Œå› æ­¤æ˜¯ç”±å†…æ ¸çº¿ç¨‹æ¥è¿è¡Œè°ƒåº¦é€»è¾‘ã€æ‰§è¡Œ goroutine çš„ä»£ç ï¼Œå¹¶ä»£è¡¨ goroutine å‘èµ·ç³»ç»Ÿè°ƒç”¨ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨æ—©æœŸï¼Œå°¤å…¶æ˜¯åœ¨ 1.1 ç‰ˆæœ¬ä¹‹å‰ï¼ŒGo ä»¥ä¸€ç§è¾ƒä¸ºç®€å•çš„æ–¹å¼å®ç°äº† M:N å¤šçº¿ç¨‹æ¨¡å‹ã€‚å½“æ—¶åªæœ‰ä¸¤ç§å®ä½“ï¼šgoroutineï¼ˆ &lt;code&gt;G&lt;/code&gt; ï¼‰å’Œå†…æ ¸çº¿ç¨‹ï¼ˆ &lt;code&gt;M&lt;/code&gt; ï¼Œæˆ–&lt;em&gt;ç§°æœºå™¨&lt;/em&gt; ï¼‰ã€‚æ‰€æœ‰å¯è¿è¡Œçš„ goroutine éƒ½å­˜å‚¨åœ¨ä¸€ä¸ªå…¨å±€è¿è¡Œé˜Ÿåˆ—ä¸­ï¼Œå¹¶ä½¿ç”¨é”æ¥é˜²æ­¢ç«æ€æ¡ä»¶ã€‚è°ƒåº¦å™¨ï¼ˆè¿è¡Œåœ¨æ¯ä¸ªçº¿ç¨‹ &lt;code&gt;M&lt;/code&gt; ä¸Šï¼‰è´Ÿè´£ä»å…¨å±€è¿è¡Œé˜Ÿåˆ—ä¸­é€‰æ‹©ä¸€ä¸ª goroutine å¹¶æ‰§è¡Œå®ƒã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://img.golang.space/img-1769567426040.png&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;img&#34;
	
	
&gt;&lt;/p&gt;
&lt;p&gt;å¦‚ä»Šï¼ŒGo ä»¥å…¶é«˜æ•ˆçš„å¹¶å‘æ¨¡å‹å¹¿ä¸ºäººçŸ¥ã€‚ä½†æ—©æœŸçš„ Go å¹¶éå¦‚æ­¤ã€‚Go çš„æ ¸å¿ƒè´¡çŒ®è€…ä¹‹ä¸€ Dmitry Vyukov åœ¨ä»–è‘—åçš„ã€Šå¯æ‰©å±•çš„ Go è°ƒåº¦å™¨è®¾è®¡ã€‹ä¸€æ–‡ä¸­æŒ‡å‡ºäº†å½“æ—¶å®ç°çš„å¤šä¸ªé—®é¢˜ã€‚ä»–æåˆ°ï¼šâ€œæ€»ä½“è€Œè¨€ï¼Œå½“æ—¶çš„è°ƒåº¦å™¨ä¼šé˜»ç¢ç”¨æˆ·åœ¨æ€§èƒ½å…³é”®çš„åœºæ™¯ä¸­ä½¿ç”¨ç¬¦åˆ Go é£æ ¼çš„ç»†ç²’åº¦å¹¶å‘ã€‚â€ ä¸‹é¢æˆ‘æ¥è¯¦ç»†è§£é‡Šä»–çš„æ„æ€ã€‚&lt;/p&gt;
&lt;p&gt;é¦–å…ˆï¼Œå…¨å±€è¿è¡Œé˜Ÿåˆ—æ˜¯æ€§èƒ½ç“¶é¢ˆã€‚å½“åˆ›å»ºä¸€ä¸ª goroutine æ—¶ï¼Œçº¿ç¨‹å¿…é¡»è·å–é”æ‰èƒ½å°†å…¶æ”¾å…¥å…¨å±€è¿è¡Œé˜Ÿåˆ—ã€‚åŒæ ·ï¼Œå½“çº¿ç¨‹æƒ³è¦ä»å…¨å±€è¿è¡Œé˜Ÿåˆ—ä¸­å–å‡º goroutine æ—¶ï¼Œä¹Ÿå¿…é¡»è·å–é”ã€‚æ‚¨å¯èƒ½çŸ¥é“ï¼ŒåŠ é”å¹¶éæ²¡æœ‰å¼€é”€ï¼Œå®ƒä¼šå¸¦æ¥é”ç«äº‰çš„å¼€é”€ã€‚é”ç«äº‰ä¼šå¯¼è‡´æ€§èƒ½ä¸‹é™ï¼Œå°¤å…¶æ˜¯åœ¨é«˜å¹¶å‘åœºæ™¯ä¸‹ã€‚&lt;/p&gt;
&lt;p&gt;å…¶æ¬¡ï¼Œçº¿ç¨‹ç»å¸¸ä¼šå°†å…³è”çš„ goroutine ç§»äº¤ç»™å¦ä¸€ä¸ªçº¿ç¨‹ã€‚è¿™ä¼šå¯¼è‡´å±€éƒ¨æ€§å·®å’Œè¿‡å¤šçš„ä¸Šä¸‹æ–‡åˆ‡æ¢å¼€é”€ã€‚å­ goroutine é€šå¸¸éœ€è¦ä¸å…¶çˆ¶ goroutine é€šä¿¡ã€‚å› æ­¤ï¼Œè®©å­ goroutine ä¸å…¶çˆ¶ goroutine è¿è¡Œåœ¨åŒä¸€ä¸ªçº¿ç¨‹ä¸Šæ€§èƒ½æ›´é«˜ã€‚&lt;/p&gt;
&lt;p&gt;ç¬¬ä¸‰ï¼Œç”±äº Go è¯­è¨€ä½¿ç”¨&lt;a class=&#34;link&#34; href=&#34;https://google.github.io/tcmalloc/design.html&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;çº¿ç¨‹ç¼“å­˜ Malloc&lt;/a&gt; ï¼Œæ¯ä¸ªçº¿ç¨‹ &lt;code&gt;M&lt;/code&gt; éƒ½æœ‰ä¸€ä¸ªçº¿ç¨‹å±€éƒ¨ç¼“å­˜ &lt;a class=&#34;link&#34; href=&#34;https://nghiant3223.github.io/2025/06/03/memory_allocation_in_go.html#processors-memory-allocator-mcache&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;&lt;code&gt;mcache&lt;/code&gt;&lt;/a&gt; ï¼Œç”¨äºå†…å­˜åˆ†é…æˆ–å­˜æ”¾ç©ºé—²å†…å­˜ã€‚è™½ç„¶ &lt;a class=&#34;link&#34; href=&#34;https://nghiant3223.github.io/2025/06/03/memory_allocation_in_go.html#processors-memory-allocator-mcache&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;&lt;code&gt;mcache&lt;/code&gt;&lt;/a&gt; ä»…ä¾›æ‰§è¡Œ Go ä»£ç çš„ &lt;code&gt;M&lt;/code&gt; ä½¿ç”¨ï¼Œä½†å³ä½¿æ˜¯é˜»å¡åœ¨ç³»ç»Ÿè°ƒç”¨ä¸­çš„ &lt;code&gt;M&lt;/code&gt; ï¼ˆè¿™äº›çº¿ç¨‹æ ¹æœ¬ä¸ä½¿ç”¨ &lt;a class=&#34;link&#34; href=&#34;https://nghiant3223.github.io/2025/06/03/memory_allocation_in_go.html#processors-memory-allocator-mcache&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;&lt;code&gt;mcache&lt;/code&gt;&lt;/a&gt; ä¹Ÿä¼šå ç”¨å®ƒã€‚ä¸€ä¸ª &lt;a class=&#34;link&#34; href=&#34;https://nghiant3223.github.io/2025/06/03/memory_allocation_in_go.html#processors-memory-allocator-mcache&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;&lt;code&gt;mcache&lt;/code&gt;&lt;/a&gt; æœ€å¤šå¯ä»¥å ç”¨ 2MB çš„å†…å­˜ï¼Œå¹¶ä¸”åªæœ‰åœ¨çº¿ç¨‹ &lt;code&gt;M&lt;/code&gt; è¢«é”€æ¯æ—¶æ‰ä¼šé‡Šæ”¾ã€‚ç”±äºæ‰§è¡Œ Go ä»£ç çš„ &lt;code&gt;M&lt;/code&gt; ä¸æ‰€æœ‰ &lt;code&gt;M&lt;/code&gt; çš„æ¯”ä¾‹å¯èƒ½é«˜è¾¾ 1:100ï¼ˆè¿‡å¤šçš„çº¿ç¨‹é˜»å¡åœ¨ç³»ç»Ÿè°ƒç”¨ä¸­ï¼‰ï¼Œè¿™å¯èƒ½å¯¼è‡´èµ„æºè¿‡åº¦æ¶ˆè€—å’Œæ•°æ®å±€éƒ¨æ€§å·®ã€‚&lt;/p&gt;
&lt;h2 id=&#34;è°ƒåº¦å™¨å¢å¼º&#34;&gt;è°ƒåº¦å™¨å¢å¼º&lt;/h2&gt;
&lt;p&gt;æ—¢ç„¶æ‚¨å·²ç»äº†è§£äº†æ—©æœŸ Go è°ƒåº¦å™¨çš„é—®é¢˜ï¼Œè®©æˆ‘ä»¬æ¥çœ‹çœ‹ä¸€äº›æ”¹è¿›ææ¡ˆï¼Œçœ‹çœ‹ Go å›¢é˜Ÿæ˜¯å¦‚ä½•è§£å†³è¿™äº›é—®é¢˜çš„ï¼Œä»è€Œä½¿æˆ‘ä»¬ä»Šå¤©æ‹¥æœ‰ä¸€ä¸ªé«˜æ€§èƒ½çš„è°ƒåº¦å™¨ã€‚&lt;/p&gt;
&lt;h3 id=&#34;æ–¹æ¡ˆä¸€--å¼•å…¥æœ¬åœ°è¿è¡Œé˜Ÿåˆ—&#34;&gt;æ–¹æ¡ˆä¸€:  å¼•å…¥æœ¬åœ°è¿è¡Œé˜Ÿåˆ—&lt;/h3&gt;
&lt;p&gt;æ¯ä¸ªçº¿ç¨‹ &lt;code&gt;M&lt;/code&gt; éƒ½é…å¤‡ä¸€ä¸ªæœ¬åœ°è¿è¡Œé˜Ÿåˆ—ï¼Œç”¨äºå­˜å‚¨å¯è¿è¡Œçš„ goroutineã€‚å½“çº¿ç¨‹ &lt;code&gt;M&lt;/code&gt; ä¸Šæ­£åœ¨è¿è¡Œçš„ goroutine &lt;code&gt;G&lt;/code&gt; ä½¿ç”¨ &lt;code&gt;go&lt;/code&gt; å…³é”®å­—ç”Ÿæˆä¸€ä¸ªæ–°çš„ goroutine &lt;code&gt;G1&lt;/code&gt; æ—¶ï¼Œ &lt;code&gt;G1&lt;/code&gt; ä¼šè¢«æ·»åŠ åˆ° &lt;code&gt;M&lt;/code&gt; çš„æœ¬åœ°è¿è¡Œé˜Ÿåˆ—ä¸­ã€‚å¦‚æœæœ¬åœ°é˜Ÿåˆ—å·²æ»¡ï¼Œåˆ™ &lt;code&gt;G1&lt;/code&gt; ä¼šè¢«æ”¾å…¥å…¨å±€è¿è¡Œé˜Ÿåˆ—ã€‚åœ¨é€‰æ‹©è¦æ‰§è¡Œçš„ goroutine æ—¶ï¼Œ &lt;code&gt;M&lt;/code&gt; ä¼šé¦–å…ˆæ£€æŸ¥å…¶æœ¬åœ°è¿è¡Œé˜Ÿåˆ—ï¼Œç„¶åå†æŸ¥è¯¢å…¨å±€è¿è¡Œé˜Ÿåˆ—ã€‚å› æ­¤ï¼Œæœ¬æ–¹æ¡ˆè§£å†³äº†ä¸Šä¸€èŠ‚ä¸­æè¿°çš„ç¬¬ä¸€ä¸ªå’Œç¬¬äºŒä¸ªé—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://img.golang.space/img-1769568770970.png&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;img&#34;
	
	
&gt;&lt;/p&gt;
&lt;p&gt;ç„¶è€Œï¼Œå®ƒæ— æ³•è§£å†³ç¬¬ä¸‰ä¸ªé—®é¢˜ã€‚å½“è®¸å¤šçº¿ç¨‹ &lt;code&gt;M&lt;/code&gt; é˜»å¡åœ¨ç³»ç»Ÿè°ƒç”¨ä¸­æ—¶ï¼Œå®ƒä»¬çš„ &lt;a class=&#34;link&#34; href=&#34;https://nghiant3223.github.io/2025/06/03/memory_allocation_in_go.html#processors-memory-allocator-mcache&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;&lt;code&gt;mcache&lt;/code&gt;&lt;/a&gt; ä¼šä¸€ç›´æŒ‚è½½ï¼Œå¯¼è‡´ Go è°ƒåº¦å™¨æœ¬èº«å†…å­˜å ç”¨è¿‡é«˜ï¼Œæ›´ä¸ç”¨è¯´æˆ‘ä»¬â€”â€”Go ç¨‹åºå‘˜â€”â€”ç¼–å†™çš„ç¨‹åºçš„å†…å­˜å ç”¨äº†ã€‚&lt;/p&gt;
&lt;p&gt;è¿™è¿˜ä¼šå¼•å…¥å¦ä¸€ä¸ªæ€§èƒ½é—®é¢˜ã€‚ä¸ºäº†é¿å…é˜»å¡çº¿ç¨‹ &lt;code&gt;M&lt;/code&gt; çš„æœ¬åœ°è¿è¡Œé˜Ÿåˆ—ï¼ˆä¾‹å¦‚ä¸Šå›¾ä¸­çš„ &lt;code&gt;M1&lt;/code&gt; ä¸­çš„ goroutine å› é¥¥é¥¿è€Œæ— æ³•æ‰§è¡Œï¼Œè°ƒåº¦å™¨åº”è¯¥å…è®¸å…¶ä»–çº¿ç¨‹ä»è¯¥é˜Ÿåˆ—ä¸­ &lt;em&gt;â€œçªƒå–&lt;/em&gt; â€goroutineã€‚ç„¶è€Œï¼Œå½“é˜»å¡çº¿ç¨‹æ•°é‡åºå¤§æ—¶ï¼Œæ‰«ææ‰€æœ‰çº¿ç¨‹ä»¥æ‰¾åˆ°éç©ºçš„è¿è¡Œé˜Ÿåˆ—ä¼šå˜å¾—éå¸¸è€—æ—¶ã€‚&lt;/p&gt;
&lt;h3 id=&#34;æ–¹æ¡ˆäºŒ-å¼•å…¥é€»è¾‘å¤„ç†å™¨&#34;&gt;æ–¹æ¡ˆäºŒ: å¼•å…¥é€»è¾‘å¤„ç†å™¨&lt;/h3&gt;
&lt;p&gt;è¯¥æ–¹æ¡ˆåœ¨ &lt;a class=&#34;link&#34; href=&#34;https://docs.google.com/document/d/1TTj4T2JO42uD5ID9e89oa0sLKhJYD0Y_kqxDv3I3XMw&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;ã€Šå¯æ‰©å±•çš„ Go è°ƒåº¦å™¨è®¾è®¡ã€‹ä¸€æ–‡&lt;/a&gt;ä¸­æœ‰æ‰€æè¿°ï¼Œå…¶ä¸­å¼•å…¥äº†&lt;em&gt;é€»è¾‘&lt;/em&gt;å¤„ç†å™¨ &lt;code&gt;P&lt;/code&gt; çš„æ¦‚å¿µã€‚æ‰€è°“ &lt;em&gt;â€œé€»è¾‘â€&lt;/em&gt; ï¼Œæ˜¯æŒ‡ &lt;code&gt;P&lt;/code&gt; è¡¨é¢ä¸Šæ‰§è¡Œ goroutine ä»£ç ï¼Œä½†å®é™…ä¸Šï¼Œæ‰§è¡Œä»£ç çš„æ˜¯ä¸ &lt;code&gt;P&lt;/code&gt; å…³è”çš„çº¿ç¨‹ &lt;code&gt;M&lt;/code&gt; çº¿ç¨‹çš„æœ¬åœ°è¿è¡Œé˜Ÿåˆ—å’Œ &lt;a class=&#34;link&#34; href=&#34;https://nghiant3223.github.io/2025/06/03/memory_allocation_in_go.html#processors-memory-allocator-mcache&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;&lt;code&gt;mcache&lt;/code&gt;&lt;/a&gt; ç°åœ¨éƒ½å½’ &lt;code&gt;P&lt;/code&gt; æ‰€æœ‰ã€‚&lt;/p&gt;
&lt;p&gt;è¯¥æ–¹æ¡ˆæœ‰æ•ˆåœ°è§£å†³äº†ä¸Šä¸€èŠ‚ä¸­é—ç•™çš„é—®é¢˜ã€‚ç”±äº &lt;a class=&#34;link&#34; href=&#34;https://nghiant3223.github.io/2025/06/03/memory_allocation_in_go.html#processors-memory-allocator-mcache&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;&lt;code&gt;mcache&lt;/code&gt;&lt;/a&gt; ç°åœ¨é™„åŠ åˆ° &lt;code&gt;P&lt;/code&gt; è€Œä¸æ˜¯ &lt;code&gt;M&lt;/code&gt; ï¼Œå¹¶ä¸”å½“ &lt;code&gt;G&lt;/code&gt; è¿›è¡Œç³»ç»Ÿè°ƒç”¨æ—¶ &lt;code&gt;M&lt;/code&gt; ä¼šä» &lt;code&gt;P&lt;/code&gt; åˆ†ç¦»ï¼Œå› æ­¤å³ä½¿æœ‰å¤§é‡ &lt;code&gt;M&lt;/code&gt; è¿›è¡Œç³»ç»Ÿè°ƒç”¨ï¼Œå†…å­˜æ¶ˆè€—ä¹Ÿèƒ½ä¿æŒè¾ƒä½æ°´å¹³ã€‚æ­¤å¤–ï¼Œç”±äº &lt;code&gt;P&lt;/code&gt; çš„æ•°é‡æœ‰é™ï¼Œè¿™ç§&lt;em&gt;å†…å­˜çªƒå–&lt;/em&gt;æœºåˆ¶ä¹Ÿååˆ†é«˜æ•ˆã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://img.golang.space/img-1769569563522.png&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;img&#34;
	
	
&gt;&lt;/p&gt;
&lt;p&gt;éšç€é€»è¾‘å¤„ç†å™¨çš„å¼•å…¥ï¼Œå¤šçº¿ç¨‹æ¨¡å‹ä»ç„¶æ˜¯ M:Nã€‚ä½†åœ¨ Go è¯­è¨€ä¸­ï¼Œå®ƒè¢«ä¸“é—¨ç§°ä¸º GMP æ¨¡å‹ï¼Œå› ä¸ºæœ‰ä¸‰ç§å®ä½“ï¼šgoroutineã€çº¿ç¨‹å’Œå¤„ç†å™¨ã€‚&lt;/p&gt;
&lt;h3 id=&#34;gmp-æ¨¡å¼&#34;&gt;GMP æ¨¡å¼&lt;/h3&gt;
&lt;p&gt;å½“ &lt;code&gt;go&lt;/code&gt; å…³é”®å­—åé¢è·Ÿç€å‡½æ•°è°ƒç”¨æ—¶ï¼Œä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„ &lt;a class=&#34;link&#34; href=&#34;https://github.com/golang/go/blob/go1.24.0/src/runtime/runtime2.go#L396-L508&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;&lt;code&gt;g&lt;/code&gt;&lt;/a&gt; å®ä¾‹ï¼Œç§°ä¸º &lt;code&gt;G&lt;/code&gt; &lt;code&gt;G&lt;/code&gt; æ˜¯ä¸€ä¸ªä»£è¡¨ goroutine çš„å¯¹è±¡ï¼ŒåŒ…å«è¯¸å¦‚æ‰§è¡ŒçŠ¶æ€ã€å †æ ˆä»¥åŠæŒ‡å‘å…³è”å‡½æ•°çš„ç¨‹åºè®¡æ•°å™¨ç­‰å…ƒæ•°æ®ã€‚æ‰§è¡Œ goroutine å°±ç›¸å½“äºè¿è¡Œ &lt;code&gt;G&lt;/code&gt; å¼•ç”¨çš„å‡½æ•°ã€‚&lt;/p&gt;
&lt;p&gt;å½“ä¸€ä¸ª goroutine æ‰§è¡Œå®Œæ¯•åï¼Œå®ƒä¸ä¼šè¢«é”€æ¯ï¼›ç›¸åï¼Œå®ƒä¼šå˜æˆ &lt;em&gt;â€œæ­»äº¡â€çŠ¶æ€&lt;/em&gt; ï¼Œå¹¶è¢«æ”¾å…¥å½“å‰å¤„ç†å™¨ &lt;code&gt;P&lt;/code&gt; çš„ç©ºé—²åˆ—è¡¨ä¸­ã€‚å¦‚æœ &lt;code&gt;P&lt;/code&gt; çš„ç©ºé—²åˆ—è¡¨å·²æ»¡ï¼Œåˆ™è¯¥æ­»äº¡çš„ goroutine ä¼šè¢«ç§»è‡³å…¨å±€ç©ºé—²åˆ—è¡¨ã€‚å½“åˆ›å»ºä¸€ä¸ªæ–°çš„ goroutine æ—¶ï¼Œè°ƒåº¦å™¨ä¼šé¦–å…ˆå°è¯•ä»ç©ºé—²åˆ—è¡¨ä¸­é‡ç”¨ä¸€ä¸ªï¼Œç„¶åå†ä»å¤´å¼€å§‹åˆ†é…ä¸€ä¸ªæ–°çš„ã€‚è¿™ç§å¾ªç¯æœºåˆ¶ä½¿å¾—åˆ›å»º goroutine çš„å¼€é”€è¿œä½äºåˆ›å»ºæ–°çº¿ç¨‹ã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹å›¾å’Œè¡¨æ ¼æè¿°äº† GMP æ¨¡å‹ä¸­ goroutine çš„çŠ¶æ€æœºã€‚ä¸ºç®€åŒ–èµ·è§ï¼Œçœç•¥äº†ä¸€äº›çŠ¶æ€å’Œè½¬æ¢ã€‚è§¦å‘çŠ¶æ€è½¬æ¢çš„åŠ¨ä½œå°†åœ¨åç»­æ–‡ç« ä¸­è¿›è¡Œæè¿°ã€‚&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:center&#34;&gt;State çŠ¶æ€&lt;/th&gt;
&lt;th&gt;Description æè¿°&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;&lt;a class=&#34;link&#34; href=&#34;https://github.com/golang/go/blob/go1.24.0/src/runtime/runtime2.go#L36-L39&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Idle&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;åˆšåˆšåˆ›å»ºï¼Œå°šæœªåˆå§‹åŒ–&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;&lt;a class=&#34;link&#34; href=&#34;https://github.com/golang/go/blob/go1.24.0/src/runtime/runtime2.go#L40-L42&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Runnable&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;å½“å‰å·²è¿›å…¥è¿è¡Œé˜Ÿåˆ—ï¼Œå³å°†æ‰§è¡Œä»£ç &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;&lt;a class=&#34;link&#34; href=&#34;https://github.com/golang/go/blob/go1.24.0/src/runtime/runtime2.go#L44-L47&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Running&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;ä¸åœ¨è¿è¡Œé˜Ÿåˆ—ä¸­ï¼Œæ­£åœ¨æ‰§è¡Œä»£ç &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;&lt;a class=&#34;link&#34; href=&#34;https://github.com/golang/go/blob/go1.24.0/src/runtime/runtime2.go#L49-L52&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Syscall&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;æ‰§è¡Œç³»ç»Ÿè°ƒç”¨ï¼Œè€Œä¸æ˜¯æ‰§è¡Œä»£ç &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;&lt;a class=&#34;link&#34; href=&#34;https://github.com/golang/go/blob/go1.24.0/src/runtime/runtime2.go#L54-L62&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Waiting&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;æœªæ‰§è¡Œä»£ç ï¼Œä¸”ä¸åœ¨è¿è¡Œé˜Ÿåˆ—ä¸­ï¼Œä¾‹å¦‚æ­£åœ¨ç­‰å¾…é€šé“&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;&lt;a class=&#34;link&#34; href=&#34;https://github.com/golang/go/blob/go1.24.0/src/runtime/runtime2.go#L68-L74&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Dead&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;å½“å‰å¤„äºç©ºé—²åˆ—è¡¨ã€åˆšåˆšé€€å‡ºæˆ–åˆšåˆšåˆå§‹åŒ–&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;&lt;img src=&#34;http://img.golang.space/img-1769569806061.png&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;img&#34;
	
	
&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;çº¿ç¨‹ M&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;æ‰€æœ‰ Go ä»£ç â€”â€”æ— è®ºæ˜¯ç”¨æˆ·ä»£ç ã€è°ƒåº¦å™¨è¿˜æ˜¯åƒåœ¾å›æ”¶å™¨â€”â€”éƒ½è¿è¡Œåœ¨ç”±æ“ä½œç³»ç»Ÿå†…æ ¸ç®¡ç†çš„çº¿ç¨‹ä¸Šã€‚ä¸ºäº†ä½¿ Go è°ƒåº¦å™¨èƒ½å¤Ÿåœ¨ GMP æ¨¡å‹ä¸‹è‰¯å¥½åœ°è¿è¡Œçº¿ç¨‹ï¼Œå¼•å…¥äº†è¡¨ç¤ºçº¿ç¨‹çš„ &lt;a class=&#34;link&#34; href=&#34;https://github.com/golang/go/blob/go1.24.0/src/runtime/runtime2.go#L528-L630&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;&lt;code&gt;m&lt;/code&gt;&lt;/a&gt; ç»“æ„ä½“ï¼Œ &lt;a class=&#34;link&#34; href=&#34;https://github.com/golang/go/blob/go1.24.0/src/runtime/runtime2.go#L528-L630&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;&lt;code&gt;m&lt;/code&gt;&lt;/a&gt; çš„ä¸€ä¸ªå®ä¾‹ç§°ä¸º &lt;code&gt;M&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;M ä¼šæŒæœ‰ä»¥ä¸‹å¼•ç”¨ï¼šå½“å‰çš„ goroutine Gï¼›å¦‚æœ M æ­£åœ¨æ‰§è¡Œ Go ä»£ç ï¼Œåˆ™æŒæœ‰å½“å‰çš„å¤„ç†å™¨ Pï¼›å¦‚æœ M æ­£åœ¨æ‰§è¡Œç³»ç»Ÿè°ƒç”¨ï¼Œåˆ™æŒæœ‰ä¹‹å‰çš„å¤„ç†å™¨ Pï¼›å¦‚æœ M å³å°†è¢«åˆ›å»ºï¼Œåˆ™æŒæœ‰ä¸‹ä¸€ä¸ªå¤„ç†å™¨ Pã€‚&lt;/p&gt;
&lt;p&gt;æ¯ä¸ª &lt;code&gt;M&lt;/code&gt; è¿˜æŒæœ‰ä¸€ä¸ªåä¸º &lt;code&gt;g0&lt;/code&gt; çš„ç‰¹æ®Š goroutine çš„å¼•ç”¨ï¼Œè¯¥ goroutine è¿è¡Œåœ¨ç³»ç»Ÿæ ˆä¸Šâ€”â€”ç³»ç»Ÿæ ˆæ˜¯ç”±å†…æ ¸æä¾›ç»™çº¿ç¨‹çš„æ ˆã€‚ä¸ç³»ç»Ÿæ ˆä¸åŒï¼Œæ™®é€š goroutine çš„æ ˆæ˜¯åŠ¨æ€è°ƒæ•´å¤§å°çš„ï¼›å®ƒä¼šæ ¹æ®éœ€è¦å¢é•¿å’Œæ”¶ç¼©ã€‚ç„¶è€Œï¼Œå¢é•¿æˆ–æ”¶ç¼©æ ˆçš„æ“ä½œæœ¬èº«å¿…é¡»åœ¨æœ‰æ•ˆçš„æ ˆä¸Šè¿è¡Œã€‚ä¸ºæ­¤ï¼Œç³»ç»Ÿæ ˆè¢«ä½¿ç”¨ã€‚å½“è¿è¡Œåœ¨ &lt;code&gt;M&lt;/code&gt; çº¿ç¨‹ä¸Šçš„è°ƒåº¦å™¨éœ€è¦æ‰§è¡Œæ ˆç®¡ç†æ—¶ï¼Œå®ƒä¼šä» goroutine çš„æ ˆåˆ‡æ¢åˆ°ç³»ç»Ÿæ ˆã€‚é™¤äº†æ ˆçš„å¢é•¿å’Œæ”¶ç¼©ä¹‹å¤–ï¼Œè¯¸å¦‚åƒåœ¾å›æ”¶å’Œ &lt;a class=&#34;link&#34; href=&#34;https://nghiant3223.github.io/2025/04/15/go-scheduler.html#goroutine-parking-gopark&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;goroutine çš„åœç”¨ä¹‹&lt;/a&gt;ç±»çš„æ“ä½œä¹Ÿéœ€è¦åœ¨ç³»ç»Ÿæ ˆä¸Šæ‰§è¡Œã€‚æ¯å½“çº¿ç¨‹æ‰§è¡Œæ­¤ç±»æ“ä½œæ—¶ï¼Œå®ƒéƒ½ä¼šåˆ‡æ¢åˆ°ç³»ç»Ÿæ ˆï¼Œå¹¶åœ¨ &lt;code&gt;g0&lt;/code&gt; çš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œè¯¥æ“ä½œã€‚&lt;/p&gt;
&lt;p&gt;ä¸ goroutine ä¸åŒï¼Œçº¿ç¨‹åœ¨ &lt;code&gt;M&lt;/code&gt; åˆ›å»ºåç«‹å³è¿è¡Œè°ƒåº¦å™¨ä»£ç ï¼Œå› æ­¤ &lt;code&gt;M&lt;/code&gt; çš„åˆå§‹çŠ¶æ€ä¸º&lt;em&gt;è¿è¡Œä¸­&lt;/em&gt; ã€‚å½“ &lt;code&gt;M&lt;/code&gt; åˆ›å»ºæˆ–è¢«å”¤é†’æ—¶ï¼Œè°ƒåº¦å™¨ä¼šä¿è¯å§‹ç»ˆå­˜åœ¨ä¸€ä¸ª&lt;em&gt;ç©ºé—²&lt;/em&gt;å¤„ç†å™¨ &lt;code&gt;P&lt;/code&gt; ï¼Œä»¥ä¾¿å°†å…¶ä¸ &lt;code&gt;M&lt;/code&gt; å…³è”ä»¥è¿è¡Œ Go ä»£ç ã€‚å¦‚æœ &lt;code&gt;M&lt;/code&gt; æ­£åœ¨æ‰§è¡Œç³»ç»Ÿè°ƒç”¨ï¼Œå®ƒå°†ä¸ &lt;code&gt;P&lt;/code&gt; åˆ†ç¦»ï¼ˆå°†åœ¨ &lt;a class=&#34;link&#34; href=&#34;https://nghiant3223.github.io/2025/04/15/go-scheduler.html#handling-system-calls&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;â€œå¤„ç†ç³»ç»Ÿè°ƒç”¨â€&lt;/a&gt; éƒ¨åˆ†ä¸­æè¿°ï¼‰ï¼Œå¹¶ä¸” &lt;code&gt;P&lt;/code&gt; å¯èƒ½è¢«å¦ä¸€ä¸ªçº¿ç¨‹ &lt;code&gt;M1&lt;/code&gt; è·å–ä»¥ç»§ç»­å…¶å·¥ä½œã€‚å¦‚æœ &lt;code&gt;M&lt;/code&gt; æ— æ³•ä»å…¶æœ¬åœ°è¿è¡Œé˜Ÿåˆ—ã€å…¨å±€è¿è¡Œé˜Ÿåˆ—æˆ– &lt;code&gt;netpoll&lt;/code&gt; ï¼ˆå°†åœ¨ &lt;a class=&#34;link&#34; href=&#34;https://nghiant3223.github.io/2025/04/15/go-scheduler.html#how-netpoll-works&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;â€œnetpoll å·¥ä½œåŸç† &lt;/a&gt;â€éƒ¨åˆ†ä¸­æè¿°ï¼‰ä¸­æ‰¾åˆ°å¯è¿è¡Œçš„ goroutineï¼Œå®ƒå°†æŒç»­è‡ªæ—‹ä»¥å†æ¬¡ä»å…¶ä»–å¤„ç†å™¨ &lt;code&gt;P&lt;/code&gt; å’Œå…¨å±€è¿è¡Œé˜Ÿåˆ—ä¸­çªƒå– goroutineã€‚è¯·æ³¨æ„ï¼Œå¹¶éæ‰€æœ‰ &lt;code&gt;M&lt;/code&gt; éƒ½ä¼šè¿›å…¥è‡ªæ—‹çŠ¶æ€ï¼Œåªæœ‰å½“è‡ªæ—‹çº¿ç¨‹æ•°å°‘äºç¹å¿™å¤„ç†å™¨æ•°çš„ä¸€åŠæ—¶æ‰ä¼šè¿›å…¥è‡ªæ—‹çŠ¶æ€ã€‚å½“ &lt;code&gt;M&lt;/code&gt; æ²¡æœ‰äº‹å¯åšæ—¶ï¼Œå®ƒä¸ä¼šé”€æ¯ï¼Œè€Œæ˜¯è¿›å…¥ç¡çœ çŠ¶æ€ï¼Œç­‰å¾…ç¨åè¢«å¦ä¸€ä¸ªå¤„ç†å™¨ &lt;code&gt;P1&lt;/code&gt; è·å–ï¼ˆåœ¨ &lt;a class=&#34;link&#34; href=&#34;https://nghiant3223.github.io/2025/04/15/go-scheduler.html#finding-a-runnable-goroutine&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;â€œå¯»æ‰¾å¯è¿è¡Œçš„ Goroutine&lt;/a&gt; â€ä¸­æè¿°ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹å›¾å’Œè¡¨æ ¼æè¿°äº† GMP æ¨¡å‹ä¸­çº¿ç¨‹çš„çŠ¶æ€æœºã€‚ ä¸ºç®€åŒ–èµ·è§ï¼Œçœç•¥äº†ä¸€äº›çŠ¶æ€å’Œè½¬æ¢ã€‚ &lt;em&gt;è‡ªæ—‹&lt;/em&gt;æ˜¯&lt;em&gt;ç©ºé—²çŠ¶æ€&lt;/em&gt;çš„ä¸€ç§å­çŠ¶æ€ï¼Œåœ¨è¿™ç§çŠ¶æ€ä¸‹ï¼Œçº¿ç¨‹ä¼šæ¶ˆè€— CPU å‘¨æœŸæ¥æ‰§è¡Œå ç”¨ goroutine çš„ Go è¿è¡Œæ—¶ä»£ç ã€‚è§¦å‘çŠ¶æ€è½¬æ¢çš„æ“ä½œå°†åœ¨åç»­æ–‡ç« ä¸­è¿›è¡Œæè¿°ã€‚&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:center&#34;&gt;State çŠ¶æ€&lt;/th&gt;
&lt;th&gt;Description æè¿°&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;Running&lt;/td&gt;
&lt;td&gt;æ‰§è¡Œ Go è¿è¡Œæ—¶ä»£ç æˆ–ç”¨æˆ· Go ä»£ç &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;Syscall&lt;/td&gt;
&lt;td&gt;å½“å‰æ­£åœ¨æ‰§è¡Œï¼ˆé˜»å¡ï¼‰ç³»ç»Ÿè°ƒç”¨&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;Spinning&lt;/td&gt;
&lt;td&gt;ä»å…¶ä»–å¤„ç†å™¨çªƒå– goroutine&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;Sleep&lt;/td&gt;
&lt;td&gt;ç¡çœ çŠ¶æ€ï¼Œä¸å ç”¨ CPU å‘¨æœŸ&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;&lt;img src=&#34;http://img.golang.space/img-1769570601286.png&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;img&#34;
	
	
&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;å¤„ç†å™¨ P&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://github.com/golang/go/blob/go1.24.0/src/runtime/runtime2.go#L632-L757&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;&lt;code&gt;p&lt;/code&gt;&lt;/a&gt; ç»“æ„ä½“åœ¨æ¦‚å¿µä¸Šä»£è¡¨ä¸€ä¸ªç”¨äºæ‰§è¡Œ goroutine &lt;code&gt;P&lt;/code&gt; &lt;a class=&#34;link&#34; href=&#34;https://github.com/golang/go/blob/go1.24.0/src/runtime/runtime2.go#L632-L757&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;&lt;code&gt;p&lt;/code&gt;&lt;/a&gt; å®ƒä»¬åœ¨ç¨‹åºçš„å¼•å¯¼é˜¶æ®µåˆ›å»ºã€‚è™½ç„¶åˆ›å»ºçš„çº¿ç¨‹æ•°å¯èƒ½å¾ˆå¤§ï¼ˆåœ¨ Go 1.24 ä¸­å¯è¾¾ &lt;a class=&#34;link&#34; href=&#34;https://github.com/golang/go/blob/go1.24.0/src/runtime/proc.go#L827-L827&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;10000&lt;/a&gt; ï¼‰ï¼Œä½†å¤„ç†å™¨çš„æ•°é‡é€šå¸¸å¾ˆå°‘ï¼Œç”± &lt;a class=&#34;link&#34; href=&#34;https://pkg.go.dev/runtime#GOMAXPROCS&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;&lt;code&gt;GOMAXPROCS&lt;/code&gt;&lt;/a&gt; å†³å®šã€‚æ— è®ºç¨‹åºå¤„äºä½•ç§çŠ¶æ€ï¼Œå¤„ç†å™¨çš„æ•°é‡éƒ½æ°å¥½ä¸º &lt;a class=&#34;link&#34; href=&#34;https://pkg.go.dev/runtime#GOMAXPROCS&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;&lt;code&gt;GOMAXPROCS&lt;/code&gt;&lt;/a&gt; ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†æœ€å¤§é™åº¦åœ°å‡å°‘å…¨å±€è¿è¡Œé˜Ÿåˆ—ä¸Šçš„é”äº‰ç”¨ï¼ŒGo è¿è¡Œæ—¶ä¸­çš„æ¯ä¸ªå¤„ç†å™¨ &lt;code&gt;P&lt;/code&gt; éƒ½ç»´æŠ¤ä¸€ä¸ªæœ¬åœ°è¿è¡Œé˜Ÿåˆ—ã€‚æœ¬åœ°è¿è¡Œé˜Ÿåˆ—å¹¶éä»…ä»…æ˜¯ä¸€ä¸ªé˜Ÿåˆ—ï¼Œè€Œæ˜¯ç”±ä¸¤ä¸ªç»„ä»¶æ„æˆï¼š &lt;a class=&#34;link&#34; href=&#34;https://github.com/golang/go/blob/go1.24.0/src/runtime/runtime2.go#L655-L667&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;&lt;code&gt;runnext&lt;/code&gt;&lt;/a&gt; ï¼Œç”¨äºå­˜æ”¾å•ä¸ªä¼˜å…ˆçº§ä¸åŒçš„ goroutineï¼›ä»¥åŠ &lt;a class=&#34;link&#34; href=&#34;https://github.com/golang/go/blob/go1.24.0/src/runtime/runtime2.go#L654-L654&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;&lt;code&gt;runq&lt;/code&gt;&lt;/a&gt; ï¼Œä¸€ä¸ª goroutine é˜Ÿåˆ—ã€‚è¿™ä¸¤ä¸ªç»„ä»¶éƒ½ä¸ºå¤„ç†å™¨ &lt;code&gt;P&lt;/code&gt; æä¾›å¯è¿è¡Œçš„ goroutineï¼Œä½† &lt;a class=&#34;link&#34; href=&#34;https://github.com/golang/go/blob/go1.24.0/src/runtime/runtime2.go#L655-L667&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;&lt;code&gt;runnext&lt;/code&gt;&lt;/a&gt; å­˜åœ¨æœ¬èº«å°±æ˜¯ä¸ºäº†ä¼˜åŒ–æ€§èƒ½ã€‚Go è°ƒåº¦å™¨å…è®¸å¤„ç†å™¨ &lt;code&gt;P&lt;/code&gt; ä»å…¶ä»–å¤„ç†å™¨ &lt;code&gt;P1&lt;/code&gt; çš„æœ¬åœ°è¿è¡Œé˜Ÿåˆ—ä¸­â€œçªƒå–â€goroutineã€‚ åªæœ‰å½“ä» P1 çš„ &lt;a class=&#34;link&#34; href=&#34;https://github.com/golang/go/blob/go1.24.0/src/runtime/runtime2.go#L654-L654&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;&lt;code&gt;runq&lt;/code&gt;&lt;/a&gt; ä¸­çªƒå– goroutine çš„å‰ä¸‰æ¬¡å°è¯•å‡å¤±è´¥åï¼Œæ‰ä¼šæŸ¥è¯¢ &lt;code&gt;P1&lt;/code&gt; çš„ &lt;a class=&#34;link&#34; href=&#34;https://github.com/golang/go/blob/go1.24.0/src/runtime/runtime2.go#L655-L667&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;&lt;code&gt;runnext&lt;/code&gt;&lt;/a&gt; ã€‚å› æ­¤ï¼Œå½“ &lt;code&gt;P&lt;/code&gt; æƒ³è¦æ‰§è¡Œä¸€ä¸ª goroutine æ—¶ï¼Œå¦‚æœå®ƒé¦–å…ˆä»è‡ªå·±çš„ &lt;a class=&#34;link&#34; href=&#34;https://github.com/golang/go/blob/go1.24.0/src/runtime/runtime2.go#L655-L667&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;&lt;code&gt;runnext&lt;/code&gt;&lt;/a&gt; ä¸­æŸ¥æ‰¾å¯è¿è¡Œçš„ goroutineï¼Œåˆ™å¯ä»¥å‡å°‘é”äº‰ç”¨ã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;P&lt;/code&gt; çš„ &lt;a class=&#34;link&#34; href=&#34;https://github.com/golang/go/blob/go1.24.0/src/runtime/runtime2.go#L654-L654&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;&lt;code&gt;runq&lt;/code&gt;&lt;/a&gt; ç»„ä»¶æ˜¯ä¸€ä¸ªåŸºäºæ•°ç»„çš„ã€å›ºå®šå¤§å°çš„å¾ªç¯é˜Ÿåˆ—ã€‚ç”±äºé‡‡ç”¨æ•°ç»„ç»“æ„å¹¶å›ºå®šå¤§å°ï¼ˆ256 ä¸ªæ§½ä½ï¼‰ï¼Œå®ƒå¯ä»¥æ›´å¥½åœ°ä¿è¯ç¼“å­˜å±€éƒ¨æ€§å¹¶é™ä½å†…å­˜åˆ†é…å¼€é”€ã€‚å›ºå®šå¤§å°å¯¹äº &lt;code&gt;P&lt;/code&gt; çš„æœ¬åœ°è¿è¡Œé˜Ÿåˆ—æ¥è¯´æ˜¯å®‰å…¨çš„ï¼Œå› ä¸ºæˆ‘ä»¬è¿˜æœ‰å…¨å±€è¿è¡Œé˜Ÿåˆ—ä½œä¸ºå¤‡ä»½ã€‚å¾ªç¯ç»“æ„å…è®¸é«˜æ•ˆåœ°æ·»åŠ å’Œåˆ é™¤ goroutineï¼Œè€Œæ— éœ€ç§»åŠ¨å…ƒç´ ã€‚&lt;/p&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://nghiant3223.github.io/2025/06/03/memory_allocation_in_go.html#processors-memory-allocator-mcache&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;&lt;code&gt;mcache&lt;/code&gt;&lt;/a&gt; åœ¨&lt;a class=&#34;link&#34; href=&#34;https://google.github.io/tcmalloc/design.html&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;çº¿ç¨‹ç¼“å­˜ Malloc&lt;/a&gt; æ¨¡å‹ä¸­å……å½“å‰ç«¯ï¼Œå¹¶ç”± &lt;code&gt;P&lt;/code&gt; ç”¨æ¥åˆ†é…å¾®å‹å’Œå°å‹å¯¹è±¡ã€‚ å¦ä¸€æ–¹é¢ï¼Œ &lt;a class=&#34;link&#34; href=&#34;https://github.com/golang/go/blob/go1.24.0/src/runtime/mpagecache.go#L14-L22&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;&lt;code&gt;pageCache&lt;/code&gt;&lt;/a&gt; ä½¿å†…å­˜åˆ†é…å™¨èƒ½å¤Ÿåœ¨ä¸è·å–&lt;a class=&#34;link&#34; href=&#34;https://www.ibm.com/docs/en/sdk-java-technology/8?topic=management-heap-allocation#the-allocator&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;å †é”çš„&lt;/a&gt;æƒ…å†µä¸‹è·å–å†…å­˜é¡µï¼Œä»è€Œæé«˜é«˜å¹¶å‘ä¸‹çš„æ€§èƒ½ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†ä½¿ Go ç¨‹åºèƒ½å¤Ÿå¾ˆå¥½åœ°å¤„ç†&lt;a class=&#34;link&#34; href=&#34;https://pkg.go.dev/time#Sleep&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;ç¡çœ  &lt;/a&gt;ã€&lt;a class=&#34;link&#34; href=&#34;https://pkg.go.dev/time#After&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt; è¶…æ—¶&lt;/a&gt;æˆ–&lt;a class=&#34;link&#34; href=&#34;https://pkg.go.dev/time#Tick&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;é—´éš”&lt;/a&gt;æ“ä½œï¼Œ &lt;code&gt;P&lt;/code&gt; è¿˜ç®¡ç†ç€ç”±&lt;a class=&#34;link&#34; href=&#34;https://en.wikipedia.org/wiki/Heap_%28data_structure%29&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;æœ€å°å †&lt;/a&gt;æ•°æ®ç»“æ„å®ç°çš„å®šæ—¶å™¨ï¼Œå…¶ä¸­æœ€è¿‘çš„å®šæ—¶å™¨ä½äºå †é¡¶ã€‚åœ¨æŸ¥æ‰¾å¯è¿è¡Œçš„ goroutine æ—¶ï¼Œ &lt;code&gt;P&lt;/code&gt; è¿˜ä¼šæ£€æŸ¥æ˜¯å¦å­˜åœ¨å·²è¿‡æœŸçš„å®šæ—¶å™¨ã€‚å¦‚æœå­˜åœ¨ï¼Œ &lt;code&gt;P&lt;/code&gt; ä¼šå°†å¸¦æœ‰ç›¸åº”å®šæ—¶å™¨çš„ goroutine æ·»åŠ åˆ°å…¶æœ¬åœ°è¿è¡Œé˜Ÿåˆ—ä¸­ï¼Œä»è€Œç»™è¯¥ goroutine è¿è¡Œçš„æœºä¼šã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹å›¾å’Œè¡¨æ ¼æè¿°äº† GMP æ¨¡å‹ä¸­å¤„ç†å™¨çš„çŠ¶æ€æœºã€‚ä¸ºç®€åŒ–èµ·è§ï¼Œçœç•¥äº†ä¸€äº›çŠ¶æ€å’Œè½¬æ¢ã€‚è§¦å‘çŠ¶æ€è½¬æ¢çš„æ“ä½œå°†åœ¨åç»­æ–‡ç« ä¸­è¿›è¡Œæè¿°ã€‚&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:center&#34;&gt;State çŠ¶æ€&lt;/th&gt;
&lt;th&gt;Description æè¿°&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;&lt;a class=&#34;link&#34; href=&#34;https://github.com/golang/go/blob/go1.24.0/src/runtime/runtime2.go#L113-L120&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Idle&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;æœªæ‰§è¡Œ Go è¿è¡Œæ—¶ä»£ç æˆ–ç”¨æˆ· Go ä»£ç &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;&lt;a class=&#34;link&#34; href=&#34;https://github.com/golang/go/blob/go1.24.0/src/runtime/runtime2.go#L122-L129&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Running&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;ä¸æ­£åœ¨æ‰§è¡Œç”¨æˆ· Go ä»£ç çš„ &lt;code&gt;M&lt;/code&gt; ç›¸å…³è”&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;&lt;a class=&#34;link&#34; href=&#34;https://github.com/golang/go/blob/go1.24.0/src/runtime/runtime2.go#L131-L141&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Syscall&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;ä¸æ­£åœ¨æ‰§è¡Œç³»ç»Ÿè°ƒç”¨çš„ &lt;code&gt;M&lt;/code&gt; ç›¸å…³è”&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;&lt;a class=&#34;link&#34; href=&#34;https://github.com/golang/go/blob/go1.24.0/src/runtime/runtime2.go#L143-L151&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;GCStop&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;ä¸ä¸€ä¸ªå› åƒåœ¾æ”¶é›†è€Œå¯¼è‡´ä¸–ç•Œåœæ‘†çš„ &lt;code&gt;M&lt;/code&gt; æœ‰å…³&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:center&#34;&gt;&lt;a class=&#34;link&#34; href=&#34;https://github.com/golang/go/blob/go1.24.0/src/runtime/runtime2.go#L153-L157&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Dead&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;ä¸å†ä½¿ç”¨ï¼Œç­‰å¾… &lt;a class=&#34;link&#34; href=&#34;https://pkg.go.dev/runtime#GOMAXPROCS&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;GOMAXPROCS&lt;/a&gt; å¢é•¿æ—¶é‡æ–°ä½¿ç”¨ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;&lt;img src=&#34;http://img.golang.space/img-1769611601457.png&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;img&#34;
	
	
&gt;&lt;/p&gt;
&lt;p&gt;åœ¨ Go ç¨‹åºæ‰§è¡ŒåˆæœŸï¼Œæœ‰ &lt;a class=&#34;link&#34; href=&#34;https://pkg.go.dev/runtime#GOMAXPROCS&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;&lt;code&gt;GOMAXPROCS&lt;/code&gt;&lt;/a&gt; ä¸ªå¤„ç†å™¨ &lt;code&gt;P&lt;/code&gt; å¤„äº&lt;em&gt;ç©ºé—²&lt;/em&gt;çŠ¶æ€ã€‚å½“çº¿ç¨‹ &lt;code&gt;M&lt;/code&gt; è·å–ä¸€ä¸ªå¤„ç†å™¨æ¥è¿è¡Œç”¨æˆ· Go ä»£ç æ—¶ï¼Œ &lt;code&gt;P&lt;/code&gt; ä¼šè½¬æ¢åˆ°&lt;em&gt;è¿è¡Œ&lt;/em&gt;çŠ¶æ€ã€‚å¦‚æœå½“å‰ goroutine &lt;code&gt;G&lt;/code&gt; å‘èµ·ç³»ç»Ÿè°ƒç”¨ï¼Œ &lt;code&gt;P&lt;/code&gt; ä¼šä» &lt;code&gt;M&lt;/code&gt; åˆ†ç¦»å¹¶è¿›å…¥&lt;em&gt;ç³»ç»Ÿè°ƒç”¨&lt;/em&gt;çŠ¶æ€ã€‚åœ¨ç³»ç»Ÿè°ƒç”¨æœŸé—´ï¼Œå¦‚æœ &lt;code&gt;P&lt;/code&gt; è¢« &lt;code&gt;sysmon&lt;/code&gt; æŠ¢å ï¼ˆå‚è§&lt;a class=&#34;link&#34; href=&#34;https://nghiant3223.github.io/2025/04/15/go-scheduler.html#non-cooperative-preemption&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;éåˆä½œæŠ¢å  &lt;/a&gt;ï¼‰ï¼Œå®ƒé¦–å…ˆè½¬æ¢åˆ°&lt;em&gt;ç©ºé—²çŠ¶æ€&lt;/em&gt; ï¼Œç„¶åè¢«ç§»äº¤ç»™å¦ä¸€ä¸ªçº¿ç¨‹ï¼ˆ &lt;code&gt;M1&lt;/code&gt; ï¼‰å¹¶è¿›å…¥&lt;em&gt;è¿è¡Œ&lt;/em&gt;çŠ¶æ€ã€‚å¦åˆ™ï¼Œç³»ç»Ÿè°ƒç”¨å®Œæˆåï¼Œ &lt;code&gt;P&lt;/code&gt; ä¼šé‡æ–°é™„åŠ åˆ°ä¹‹å‰çš„ &lt;code&gt;M&lt;/code&gt; å¹¶æ¢å¤&lt;em&gt;è¿è¡Œ&lt;/em&gt;çŠ¶æ€ï¼ˆå‚è§&lt;a class=&#34;link&#34; href=&#34;https://nghiant3223.github.io/2025/04/15/go-scheduler.html#handling-system-calls&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;å¤„ç†ç³»ç»Ÿè°ƒç”¨ &lt;/a&gt;ï¼‰ã€‚å½“å‘ç”Ÿ stop-the-world åƒåœ¾å›æ”¶æ—¶ï¼Œ &lt;code&gt;P&lt;/code&gt; ä¼šè½¬æ¢åˆ° &lt;em&gt;gcStop&lt;/em&gt; çŠ¶æ€ï¼Œå¹¶åœ¨ start-the-world æ¢å¤åè¿”å›åˆ°ä¹‹å‰çš„çŠ¶æ€ã€‚å¦‚æœåœ¨è¿è¡Œæ—¶ &lt;a class=&#34;link&#34; href=&#34;https://pkg.go.dev/runtime#GOMAXPROCS&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;&lt;code&gt;GOMAXPROCS&lt;/code&gt;&lt;/a&gt; å‡å°‘ï¼Œå†—ä½™å¤„ç†å™¨ä¼šè½¬æ¢åˆ° &lt;em&gt;dead&lt;/em&gt; çŠ¶æ€ï¼Œå¹¶åœ¨ &lt;a class=&#34;link&#34; href=&#34;https://pkg.go.dev/runtime#GOMAXPROCS&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;&lt;code&gt;GOMAXPROCS&lt;/code&gt;&lt;/a&gt; ç¨åå¢åŠ æ—¶è¢«é‡ç”¨ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ç¨‹åºå¼•å¯¼&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;è¦å¯ç”¨ Go è°ƒåº¦å™¨ï¼Œå¿…é¡»åœ¨ç¨‹åºå¯åŠ¨æœŸé—´å¯¹å…¶è¿›è¡Œåˆå§‹åŒ–ã€‚æ­¤åˆå§‹åŒ–è¿‡ç¨‹é€šè¿‡æ±‡ç¼–è¯­è¨€ä¸­çš„ &lt;a class=&#34;link&#34; href=&#34;https://github.com/golang/go/blob/go1.24.0/src/runtime/asm_amd64.s#L159-L159&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;&lt;code&gt;runtimeÂ·rt0_go&lt;/code&gt;&lt;/a&gt; å‡½æ•°å®Œæˆã€‚åœ¨æ­¤é˜¶æ®µï¼Œå°†åˆ›å»ºçº¿ç¨‹ &lt;a class=&#34;link&#34; href=&#34;https://github.com/golang/go/blob/go1.24.0/src/runtime/proc.go#L117-L117&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;&lt;code&gt;M0&lt;/code&gt;&lt;/a&gt; ï¼ˆä»£è¡¨ä¸»çº¿ç¨‹ï¼‰å’Œ goroutine &lt;a class=&#34;link&#34; href=&#34;https://github.com/golang/go/blob/go1.24.0/src/runtime/proc.go#L118-L118&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;&lt;code&gt;G0&lt;/code&gt;&lt;/a&gt; ï¼ˆ &lt;a class=&#34;link&#34; href=&#34;https://github.com/golang/go/blob/go1.24.0/src/runtime/proc.go#L117-L117&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;&lt;code&gt;M0&lt;/code&gt;&lt;/a&gt; çš„ç³»ç»Ÿæ ˆ goroutineï¼‰ã€‚ è¿˜ä¸ºä¸»çº¿ç¨‹è®¾ç½®äº†&lt;a class=&#34;link&#34; href=&#34;https://en.wikipedia.org/wiki/Thread-local_storage&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;çº¿ç¨‹æœ¬åœ°å­˜å‚¨ &lt;/a&gt;ï¼ˆTLSï¼‰ï¼Œå¹¶å°† &lt;a class=&#34;link&#34; href=&#34;https://github.com/golang/go/blob/go1.24.0/src/runtime/proc.go#L118-L118&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;&lt;code&gt;G0&lt;/code&gt;&lt;/a&gt; çš„åœ°å€å­˜å‚¨åœ¨æ­¤ TLS ä¸­ï¼Œä»¥ä¾¿ç¨åé€šè¿‡ &lt;a class=&#34;link&#34; href=&#34;https://nghiant3223.github.io/2025/04/15/go-scheduler.html#getting-goroutine-getg&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;&lt;code&gt;getg&lt;/code&gt;&lt;/a&gt; æ£€ç´¢å®ƒã€‚&lt;/p&gt;
&lt;p&gt;å¼•å¯¼ç¨‹åºéšåè°ƒç”¨æ±‡ç¼–å‡½æ•° &lt;a class=&#34;link&#34; href=&#34;https://github.com/golang/go/blob/go1.24.0/src/runtime/asm_amd64.s#L349&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;&lt;code&gt;runtimeÂ·schedinit&lt;/code&gt;&lt;/a&gt; ï¼Œå…¶ Go å®ç°ä½äº &lt;a class=&#34;link&#34; href=&#34;https://github.com/golang/go/blob/go1.24.0/src/runtime/proc.go#L790-L898&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;&lt;code&gt;runtime.schedinit&lt;/code&gt;&lt;/a&gt; ã€‚è¯¥å‡½æ•°æ‰§è¡Œå„ç§åˆå§‹åŒ–æ“ä½œï¼Œå…¶ä¸­æœ€é‡è¦çš„æ˜¯è°ƒç”¨ &lt;a class=&#34;link&#34; href=&#34;https://github.com/golang/go/blob/go1.24.0/src/runtime/proc.go#L5719-L5868&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;&lt;code&gt;procresize&lt;/code&gt;&lt;/a&gt; ï¼Œå°† &lt;a class=&#34;link&#34; href=&#34;https://pkg.go.dev/runtime#GOMAXPROCS&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;&lt;code&gt;GOMAXPROCS&lt;/code&gt;&lt;/a&gt; ä¸ªé€»è¾‘å¤„ç†å™¨ &lt;code&gt;P&lt;/code&gt; è®¾ç½®ä¸º&lt;em&gt;ç©ºé—²&lt;/em&gt;çŠ¶æ€ã€‚ç„¶åï¼Œä¸»çº¿ç¨‹ &lt;a class=&#34;link&#34; href=&#34;https://github.com/golang/go/blob/go1.24.0/src/runtime/proc.go#L117-L117&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;&lt;code&gt;M0&lt;/code&gt;&lt;/a&gt; ä¸ç¬¬ä¸€ä¸ªå¤„ç†å™¨å…³è”ï¼Œå…¶çŠ¶æ€ä»&lt;em&gt;ç©ºé—²&lt;/em&gt;è½¬æ¢ä¸º&lt;em&gt;è¿è¡ŒçŠ¶æ€&lt;/em&gt;ä»¥æ‰§è¡Œ goroutineã€‚&lt;/p&gt;
&lt;p&gt;ä¹‹åï¼Œåˆ›å»ºä¸» goroutine æ¥è¿è¡Œ &lt;a class=&#34;link&#34; href=&#34;https://github.com/golang/go/blob/go1.24.0/src/runtime/proc.go#L146-L148&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;&lt;code&gt;runtime.main&lt;/code&gt;&lt;/a&gt; å‡½æ•°ï¼Œè¯¥å‡½æ•°ä½œä¸º Go è¿è¡Œæ—¶å…¥å£ç‚¹ã€‚åœ¨ &lt;a class=&#34;link&#34; href=&#34;https://github.com/golang/go/blob/go1.24.0/src/runtime/proc.go#L146-L148&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;&lt;code&gt;runtime.main&lt;/code&gt;&lt;/a&gt; å‡½æ•°å†…éƒ¨ï¼Œä¼šåˆ›å»ºä¸€ä¸ªä¸“ç”¨çº¿ç¨‹æ¥å¯åŠ¨ &lt;code&gt;sysmon&lt;/code&gt; ï¼Œè¿™å°†åœ¨ &lt;a class=&#34;link&#34; href=&#34;https://nghiant3223.github.io/2025/04/15/go-scheduler.html#non-cooperative-preemption&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;â€œéåˆä½œæŠ¢å â€&lt;/a&gt; éƒ¨åˆ†è¿›è¡Œæè¿°ã€‚è¯·æ³¨æ„ï¼Œ &lt;a class=&#34;link&#34; href=&#34;https://github.com/golang/go/blob/go1.24.0/src/runtime/proc.go#L146-L148&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;&lt;code&gt;runtime.main&lt;/code&gt;&lt;/a&gt; ä¸æˆ‘ä»¬ç¼–å†™çš„ &lt;code&gt;main&lt;/code&gt; å‡½æ•°ä¸åŒï¼›åè€…åœ¨è¿è¡Œæ—¶ä¸­æ˜¾ç¤ºä¸º &lt;a class=&#34;link&#34; href=&#34;https://github.com/golang/go/blob/go1.24.0/src/runtime/proc.go#L134-L135&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;&lt;code&gt;main_main&lt;/code&gt;&lt;/a&gt; ã€‚&lt;/p&gt;
&lt;p&gt;ä¸»çº¿ç¨‹éšåè°ƒç”¨ &lt;a class=&#34;link&#34; href=&#34;https://github.com/golang/go/blob/go1.24.0/src/runtime/proc.go#L1769-L1769&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;&lt;code&gt;mstart&lt;/code&gt;&lt;/a&gt; åœ¨å†…å­˜ &lt;a class=&#34;link&#34; href=&#34;https://github.com/golang/go/blob/go1.24.0/src/runtime/proc.go#L117-L117&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;&lt;code&gt;M0&lt;/code&gt;&lt;/a&gt; ä¸Šå¼€å§‹æ‰§è¡Œï¼Œå¯åŠ¨&lt;a class=&#34;link&#34; href=&#34;https://nghiant3223.github.io/2025/04/15/go-scheduler.html#schedule-loop&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;è°ƒåº¦å¾ªç¯&lt;/a&gt;ä»¥è·å–å¹¶æ‰§è¡Œä¸» goroutineã€‚åœ¨ &lt;a class=&#34;link&#34; href=&#34;https://github.com/golang/go/blob/go1.24.0/src/runtime/proc.go#L146-L148&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;&lt;code&gt;runtime.main&lt;/code&gt;&lt;/a&gt; å‡½æ•°ä¸­ï¼Œç»è¿‡é¢å¤–çš„åˆå§‹åŒ–æ­¥éª¤åï¼Œæ§åˆ¶æƒæœ€ç»ˆäº¤ç»™ç”¨æˆ·å®šä¹‰çš„ &lt;a class=&#34;link&#34; href=&#34;https://github.com/golang/go/blob/go1.24.0/src/runtime/proc.go#L134-L135&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;&lt;code&gt;main_main&lt;/code&gt;&lt;/a&gt; å‡½æ•°ï¼Œç¨‹åºå¼€å§‹æ‰§è¡Œç”¨æˆ·ç¼–å†™çš„ Go ä»£ç ã€‚&lt;/p&gt;
&lt;p&gt;å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œä¸»çº¿ç¨‹ &lt;a class=&#34;link&#34; href=&#34;https://github.com/golang/go/blob/go1.24.0/src/runtime/proc.go#L117-L117&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;&lt;code&gt;M0&lt;/code&gt;&lt;/a&gt; ä¸ä»…è´Ÿè´£è¿è¡Œä¸» goroutineï¼Œè¿˜è´Ÿè´£æ‰§è¡Œå…¶ä»– goroutineã€‚æ¯å½“ä¸» goroutine è¢«é˜»å¡æ—¶â€”â€”ä¾‹å¦‚ç­‰å¾…ç³»ç»Ÿè°ƒç”¨æˆ–ç­‰å¾…é€šé“æ—¶â€”â€”ä¸»çº¿ç¨‹éƒ½ä¼šå¯»æ‰¾å¦ä¸€ä¸ªå¯è¿è¡Œçš„ goroutine å¹¶æ‰§è¡Œå®ƒã€‚&lt;/p&gt;
&lt;p&gt;ç»¼ä¸Šæ‰€è¿°ï¼Œç¨‹åºå¯åŠ¨æ—¶ï¼Œæœ‰ä¸€ä¸ª goroutine &lt;code&gt;G&lt;/code&gt; æ‰§è¡Œ &lt;code&gt;main&lt;/code&gt; å‡½æ•°ï¼›ä¸¤ä¸ªçº¿ç¨‹â€”â€”ä¸€ä¸ªæ˜¯ä¸»çº¿ç¨‹ &lt;code&gt;M0&lt;/code&gt; ï¼Œå¦ä¸€ä¸ªç”¨äºå¯åŠ¨ &lt;code&gt;sysmon&lt;/code&gt; ï¼›ä¸€ä¸ªå¤„ç†å™¨ &lt;code&gt;P0&lt;/code&gt; å¤„äº&lt;em&gt;è¿è¡Œ&lt;/em&gt;çŠ¶æ€ï¼Œä»¥åŠ &lt;code&gt;GOMAXPROCSâˆ’1&lt;/code&gt; å¤„ç†å™¨å¤„äº&lt;em&gt;ç©ºé—²&lt;/em&gt;çŠ¶æ€ã€‚ä¸»çº¿ç¨‹ &lt;code&gt;M0&lt;/code&gt; æœ€åˆä¸å¤„ç†å™¨ &lt;code&gt;P0&lt;/code&gt; å…³è”ï¼Œä»¥è¿è¡Œä¸» goroutine &lt;code&gt;G&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;ä¸‹å›¾å±•ç¤ºäº†ç¨‹åºå¯åŠ¨æ—¶çš„çŠ¶æ€ã€‚å›¾ä¸­å‡è®¾ &lt;a class=&#34;link&#34; href=&#34;https://pkg.go.dev/runtime#GOMAXPROCS&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;&lt;code&gt;GOMAXPROCS&lt;/code&gt;&lt;/a&gt; è®¾ç½®ä¸º 2ï¼Œå¹¶ä¸” &lt;code&gt;main&lt;/code&gt; å‡½æ•°åˆšåˆšå¼€å§‹æ‰§è¡Œã€‚å¤„ç†å™¨ &lt;code&gt;P0&lt;/code&gt; æ­£åœ¨æ‰§è¡Œä¸» goroutineï¼Œå› æ­¤å¤„äº&lt;em&gt;è¿è¡Œ&lt;/em&gt;çŠ¶æ€ã€‚å¤„ç†å™¨ &lt;code&gt;P1&lt;/code&gt; æ²¡æœ‰æ‰§è¡Œä»»ä½• goroutineï¼Œå¤„äº&lt;em&gt;ç©ºé—²&lt;/em&gt;çŠ¶æ€ã€‚ä¸»çº¿ç¨‹ &lt;code&gt;M0&lt;/code&gt; ä¸å¤„ç†å™¨ &lt;code&gt;P0&lt;/code&gt; å…³è”ä»¥æ‰§è¡Œä¸» goroutine çš„åŒæ—¶ï¼Œåˆ›å»ºäº†å¦ä¸€ä¸ªçº¿ç¨‹ &lt;code&gt;M1&lt;/code&gt; æ¥è¿è¡Œ &lt;code&gt;sysmon&lt;/code&gt; ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://img.golang.space/img-1769611886747.png&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;img&#34;
	
	
&gt;&lt;/p&gt;
&lt;p&gt;å€¼å¾—ä¸€æçš„æ˜¯ï¼Œåœ¨å¯åŠ¨é˜¶æ®µï¼Œè¿è¡Œæ—¶è¿˜ä¼šç”Ÿæˆä¸€äº›ä¸å†…å­˜ç®¡ç†ç›¸å…³çš„ goroutineï¼Œä¾‹å¦‚æ ‡è®°ã€æ¸…é™¤å’Œæ¸…ç†ã€‚ä¸è¿‡ï¼Œæœ¬æ–‡æš‚ä¸è®¨è®ºè¿™äº›ï¼Œæˆ‘ä»¬å°†åœ¨åç»­æ–‡ç« ä¸­è¿›è¡Œæ›´è¯¦ç»†çš„æ¢è®¨ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;åˆ›å»º Goroutine&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Go æä¾›äº†ä¸€ä¸ªç®€å•çš„ API æ¥å¯åŠ¨å¹¶å‘æ‰§è¡Œå•å…ƒï¼š &lt;code&gt;go func() { ... } ()&lt;/code&gt; &lt;code&gt;go&lt;/code&gt; å®é™…ä¸Šï¼ŒGo è¿è¡Œæ—¶åœ¨åº•å±‚åšäº†å¾ˆå¤šå¤æ‚çš„å·¥ä½œæ¥å®ç°è¿™ä¸€ç‚¹ã€‚&lt;code&gt;go&lt;/code&gt; å…³é”®å­—åªæ˜¯ Go è¿è¡Œæ—¶ &lt;a class=&#34;link&#34; href=&#34;https://github.com/golang/go/blob/go1.24.0/src/runtime/proc.go#L5014-L5030&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;&lt;code&gt;newproc&lt;/code&gt;&lt;/a&gt; å‡½æ•°çš„è¯­æ³•ç³–ï¼Œè¯¥å‡½æ•°è´Ÿè´£è°ƒåº¦ä¸€ä¸ªæ–°çš„ goroutineã€‚è¿™ä¸ªå‡½æ•°ä¸»è¦æ‰§è¡Œä¸‰ä»¶äº‹ï¼šåˆå§‹åŒ– goroutineï¼Œå°†å…¶æ”¾å…¥è°ƒç”¨ goroutine çš„å¤„ç†å™¨ &lt;code&gt;P&lt;/code&gt; çš„è¿è¡Œé˜Ÿåˆ—ä¸­ï¼Œä»¥åŠå”¤é†’å¦ä¸€ä¸ªå¤„ç†å™¨ &lt;code&gt;P1&lt;/code&gt; ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;åˆå§‹åŒ– Goroutine&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;è°ƒç”¨ &lt;a class=&#34;link&#34; href=&#34;https://github.com/golang/go/blob/go1.24.0/src/runtime/proc.go#L5014-L5030&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;&lt;code&gt;newproc&lt;/code&gt;&lt;/a&gt; æ—¶ï¼Œä»…å½“æ²¡æœ‰ç©ºé—²çš„ goroutine å¯ç”¨æ—¶æ‰ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„ goroutine &lt;code&gt;G&lt;/code&gt; åœ¨æ‰§è¡Œå®Œæ¯•è¿”å›åä¼šå˜ä¸ºç©ºé—²çŠ¶æ€ã€‚æ–°åˆ›å»ºçš„ goroutine &lt;code&gt;G&lt;/code&gt; ä¼šè¢«åˆå§‹åŒ–ä¸ºä¸€ä¸ª 2KB çš„æ ˆï¼Œè¯¥æ ˆå¤§å°ç”± Go è¿è¡Œæ—¶ä¸­çš„ &lt;a class=&#34;link&#34; href=&#34;https://github.com/golang/go/blob/go1.24.0/src/runtime/stack.go#L75-L75&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;stackMin&lt;/a&gt; å¸¸é‡å®šä¹‰ã€‚æ­¤å¤–ï¼Œ &lt;a class=&#34;link&#34; href=&#34;https://github.com/golang/go/blob/go1.24.0/src/runtime/stubs.go#L281-L291&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;&lt;code&gt;goexit&lt;/code&gt;&lt;/a&gt; ï¼ˆè´Ÿè´£æ¸…ç†é€»è¾‘å’Œè°ƒåº¦é€»è¾‘ï¼‰ä¼šè¢«å‹å…¥ &lt;code&gt;G&lt;/code&gt; çš„è°ƒç”¨æ ˆï¼Œä»¥ç¡®ä¿å®ƒåœ¨ &lt;code&gt;G&lt;/code&gt; è¿”å›æ—¶æ‰§è¡Œã€‚åˆå§‹åŒ–å®Œæˆåï¼Œ &lt;code&gt;G&lt;/code&gt; ä¼šä»&lt;em&gt;æ­»&lt;/em&gt;çŠ¶æ€è½¬æ¢ä¸º&lt;em&gt;å¯è¿è¡Œ&lt;/em&gt;çŠ¶æ€ï¼Œè¡¨æ˜å®ƒå·²å‡†å¤‡å¥½è¢«è°ƒåº¦æ‰§è¡Œã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;å°† Goroutine æ”¾å…¥é˜Ÿåˆ—&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;å¦‚å‰æ‰€è¿°ï¼Œæ¯ä¸ªå¤„ç†å™¨ &lt;code&gt;P&lt;/code&gt; éƒ½æœ‰ä¸€ä¸ªç”±ä¸¤éƒ¨åˆ†ç»„æˆçš„è¿è¡Œé˜Ÿåˆ—ï¼š &lt;a class=&#34;link&#34; href=&#34;https://github.com/golang/go/blob/go1.24.0/src/runtime/runtime2.go#L655-L667&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;&lt;code&gt;runnext&lt;/code&gt;&lt;/a&gt; å’Œ &lt;a class=&#34;link&#34; href=&#34;https://github.com/golang/go/blob/go1.24.0/src/runtime/runtime2.go#L654-L654&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;&lt;code&gt;runq&lt;/code&gt;&lt;/a&gt; ã€‚å½“ä¸€ä¸ªæ–°çš„ goroutine åˆ›å»ºæ—¶ï¼Œå®ƒä¼šè¢«æ”¾å…¥ &lt;a class=&#34;link&#34; href=&#34;https://github.com/golang/go/blob/go1.24.0/src/runtime/runtime2.go#L655-L667&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;&lt;code&gt;runnext&lt;/code&gt;&lt;/a&gt; ä¸­ã€‚å¦‚æœ &lt;a class=&#34;link&#34; href=&#34;https://github.com/golang/go/blob/go1.24.0/src/runtime/runtime2.go#L655-L667&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;&lt;code&gt;runnext&lt;/code&gt;&lt;/a&gt; å·²ç»å­˜åœ¨ goroutine &lt;code&gt;G1&lt;/code&gt; ï¼Œè°ƒåº¦å™¨ä¼šå°è¯•å°† &lt;code&gt;G1&lt;/code&gt; ç§»è‡³ &lt;a class=&#34;link&#34; href=&#34;https://github.com/golang/go/blob/go1.24.0/src/runtime/runtime2.go#L654-L654&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;&lt;code&gt;runq&lt;/code&gt;&lt;/a&gt; ï¼ˆå‰ææ˜¯ &lt;a class=&#34;link&#34; href=&#34;https://github.com/golang/go/blob/go1.24.0/src/runtime/runtime2.go#L654-L654&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;&lt;code&gt;runq&lt;/code&gt;&lt;/a&gt; æœªæ»¡ï¼‰ï¼Œå¹¶å°† &lt;code&gt;G&lt;/code&gt; æ”¾å› &lt;a class=&#34;link&#34; href=&#34;https://github.com/golang/go/blob/go1.24.0/src/runtime/runtime2.go#L655-L667&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;&lt;code&gt;runnext&lt;/code&gt;&lt;/a&gt; ã€‚å¦‚æœ &lt;a class=&#34;link&#34; href=&#34;https://github.com/golang/go/blob/go1.24.0/src/runtime/runtime2.go#L654-L654&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;&lt;code&gt;runq&lt;/code&gt;&lt;/a&gt; å·²æ»¡ï¼Œåˆ™ &lt;code&gt;G1&lt;/code&gt; ä»¥åŠ &lt;a class=&#34;link&#34; href=&#34;https://github.com/golang/go/blob/go1.24.0/src/runtime/runtime2.go#L654-L654&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;&lt;code&gt;runq&lt;/code&gt;&lt;/a&gt; ä¸­ä¸€åŠçš„ goroutine ä¼šè¢«ç§»è‡³å…¨å±€è¿è¡Œé˜Ÿåˆ—ï¼Œä»¥å‡è½»å¤„ç†å™¨ &lt;code&gt;P&lt;/code&gt; çš„å·¥ä½œè´Ÿè½½ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;å”¤é†’å¤„ç†å™¨&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;å½“åˆ›å»ºä¸€ä¸ªæ–°çš„ goroutine æ—¶ï¼Œä¸ºäº†æœ€å¤§åŒ–ç¨‹åºå¹¶å‘æ€§ï¼Œè¿è¡Œè¯¥ goroutine çš„çº¿ç¨‹ä¼šå°è¯•é€šè¿‡ &lt;a class=&#34;link&#34; href=&#34;https://man7.org/linux/man-pages/man2/futex.2.html&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;&lt;code&gt;futex&lt;/code&gt;&lt;/a&gt; ç³»ç»Ÿè°ƒç”¨å”¤é†’å¦ä¸€ä¸ªå¤„ç†å™¨ &lt;code&gt;P&lt;/code&gt; ä¸ºæ­¤ï¼Œå®ƒé¦–å…ˆæ£€æŸ¥æ˜¯å¦æœ‰ç©ºé—²çš„å¤„ç†å™¨ Pã€‚å¦‚æœæœ‰ç©ºé—²çš„å¤„ç†å™¨ &lt;code&gt;P&lt;/code&gt; å¯ç”¨ï¼Œåˆ™ä¼šåˆ›å»ºä¸€ä¸ªæ–°çº¿ç¨‹ï¼Œæˆ–è€…å”¤é†’ä¸€ä¸ªç°æœ‰çº¿ç¨‹è¿›å…¥&lt;a class=&#34;link&#34; href=&#34;https://nghiant3223.github.io/2025/04/15/go-scheduler.html#schedule-loop&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;è°ƒåº¦å¾ªç¯ &lt;/a&gt;ï¼Œå¹¶åœ¨å¾ªç¯ä¸­å¯»æ‰¾å¯æ‰§è¡Œçš„ goroutineã€‚åˆ›å»ºæˆ–é‡ç”¨çº¿ç¨‹çš„é€»è¾‘åœ¨ &lt;a class=&#34;link&#34; href=&#34;https://nghiant3223.github.io/2025/04/15/go-scheduler.html#start-thread-startm&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;â€œå¯åŠ¨çº¿ç¨‹â€&lt;/a&gt; éƒ¨åˆ†ä¸­è¿›è¡Œäº†æè¿°ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚å‰æ‰€è¿°ï¼Œ &lt;a class=&#34;link&#34; href=&#34;https://pkg.go.dev/runtime#GOMAXPROCS&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;&lt;code&gt;GOMAXPROCS&lt;/code&gt;&lt;/a&gt; ï¼ˆå³æ´»åŠ¨å¤„ç†å™¨æ•°é‡ &lt;code&gt;P&lt;/code&gt; å†³å®šäº†å¯ä»¥åŒæ—¶è¿è¡Œçš„ goroutine æ•°é‡ã€‚å¦‚æœæ‰€æœ‰å¤„ç†å™¨éƒ½å¤„äºå¿™ç¢ŒçŠ¶æ€ï¼Œå¹¶ä¸”ä¸æ–­ç”Ÿæˆæ–°çš„ goroutineï¼Œåˆ™æ—¢ä¸ä¼šå”¤é†’ç°æœ‰çº¿ç¨‹ï¼Œä¹Ÿä¸ä¼šåˆ›å»ºæ–°çº¿ç¨‹ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;æ€»ç»“&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ä¸‹å›¾å±•ç¤ºäº† goroutine çš„åˆ›å»ºè¿‡ç¨‹ã€‚ä¸ºç®€åŒ–èµ·è§ï¼Œå›¾ä¸­å‡è®¾ &lt;a class=&#34;link&#34; href=&#34;https://pkg.go.dev/runtime#GOMAXPROCS&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;&lt;code&gt;GOMAXPROCS&lt;/code&gt;&lt;/a&gt; è®¾ç½®ä¸º 2ï¼Œå¤„ç†å™¨ &lt;code&gt;P1&lt;/code&gt; å°šæœªè¿›å…¥&lt;a class=&#34;link&#34; href=&#34;https://nghiant3223.github.io/2025/04/15/go-scheduler.html#schedule-loop&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;è°ƒåº¦å¾ªç¯ &lt;/a&gt;ï¼Œä¸” &lt;code&gt;main&lt;/code&gt; å‡½æ•°é™¤äº†ä¸æ–­åˆ›å»ºæ–°çš„ goroutine ä¹‹å¤–ä¸åšä»»ä½•å…¶ä»–æ“ä½œã€‚ç”±äº goroutine ä¸æ‰§è¡Œç³»ç»Ÿè°ƒç”¨ï¼ˆè¯¦è§ &lt;a class=&#34;link&#34; href=&#34;https://nghiant3223.github.io/2025/04/15/go-scheduler.html#handling-system-calls&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;â€œå¤„ç†ç³»ç»Ÿè°ƒç”¨â€&lt;/a&gt; éƒ¨åˆ†ï¼‰ï¼Œå› æ­¤ä¼šåˆ›å»ºä¸€ä¸ªé¢å¤–çš„çº¿ç¨‹ &lt;code&gt;M2&lt;/code&gt; ä¸å¤„ç†å™¨ &lt;code&gt;P1&lt;/code&gt; å…³è”ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://img.golang.space/img-1769612199196.png&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;img&#34;
	
	
&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;è°ƒåº¦å¾ªç¯&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Go è¿è¡Œæ—¶ä¸­çš„ &lt;a class=&#34;link&#34; href=&#34;https://github.com/golang/go/blob/go1.24.0/src/runtime/proc.go#L3986-L4068&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;&lt;code&gt;schedule&lt;/code&gt;&lt;/a&gt; å‡½æ•°è´Ÿè´£æŸ¥æ‰¾å’Œæ‰§è¡Œå¯è¿è¡Œçš„ goroutineã€‚å®ƒä¼šåœ¨å„ç§æƒ…å†µä¸‹è¢«è°ƒç”¨ï¼šåˆ›å»ºæ–°çº¿ç¨‹æ—¶ã€è°ƒç”¨ &lt;a class=&#34;link&#34; href=&#34;https://pkg.go.dev/runtime#Gosched&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;&lt;code&gt;Gosched&lt;/code&gt;&lt;/a&gt; æ—¶ã€goroutine è¢«æš‚åœæˆ–æŠ¢å æ—¶ï¼Œæˆ–è€… goroutine å®Œæˆç³»ç»Ÿè°ƒç”¨å¹¶è¿”å›åã€‚&lt;/p&gt;
&lt;p&gt;é€‰æ‹©å¯è¿è¡Œçš„ goroutine çš„è¿‡ç¨‹æ¯”è¾ƒå¤æ‚ï¼Œå°†åœ¨ &lt;a class=&#34;link&#34; href=&#34;https://nghiant3223.github.io/2025/04/15/go-scheduler.html#finding-a-runnable-goroutine&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;â€œæŸ¥æ‰¾å¯è¿è¡Œçš„ goroutineâ€&lt;/a&gt; ä¸€èŠ‚ä¸­è¯¦ç»†ä»‹ç»ã€‚ä¸€æ—¦ goroutine è¢«é€‰ä¸­ï¼Œå®ƒçš„çŠ¶æ€å°±ä¼šä»&lt;em&gt;å¯è¿è¡Œ&lt;/em&gt;çŠ¶æ€è½¬å˜ä¸º&lt;em&gt;è¿è¡Œ&lt;/em&gt;çŠ¶æ€ï¼Œè¡¨æ˜å®ƒå·²å‡†å¤‡å¥½è¿è¡Œã€‚æ­¤æ—¶ï¼Œå†…æ ¸çº¿ç¨‹ä¼šè°ƒç”¨ &lt;a class=&#34;link&#34; href=&#34;https://github.com/golang/go/blob/go1.24.0/src/runtime/stubs.go#L214-L214&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;&lt;code&gt;gogo&lt;/code&gt;&lt;/a&gt; å‡½æ•°æ¥å¯åŠ¨ goroutine çš„æ‰§è¡Œã€‚&lt;/p&gt;
&lt;p&gt;ä½†ä¸ºä»€ä¹ˆç§°ä¹‹ä¸º&lt;em&gt;å¾ªç¯&lt;/em&gt;å‘¢ï¼Ÿæ­£å¦‚ &lt;a class=&#34;link&#34; href=&#34;https://nghiant3223.github.io/2025/04/15/go-scheduler.html#initializing-goroutine&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;â€œåˆå§‹åŒ– Goroutineâ€&lt;/a&gt; ä¸€èŠ‚æ‰€è¿°ï¼Œå½“ä¸€ä¸ª goroutine æ‰§è¡Œå®Œæ¯•æ—¶ï¼Œä¼šè°ƒç”¨ &lt;a class=&#34;link&#34; href=&#34;https://github.com/golang/go/blob/go1.24.0/src/runtime/stubs.go#L281-L291&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;&lt;code&gt;goexit&lt;/code&gt;&lt;/a&gt; å‡½æ•°ã€‚è¯¥å‡½æ•°æœ€ç»ˆä¼šè°ƒç”¨ &lt;a class=&#34;link&#34; href=&#34;https://github.com/golang/go/blob/go1.24.0/src/runtime/proc.go#L4307-L4310&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;&lt;code&gt;goexit0&lt;/code&gt;&lt;/a&gt; ï¼Œåè€…è´Ÿè´£æ¸…ç†ç»ˆæ­¢çš„ goroutine å¹¶é‡æ–°è¿›å…¥ &lt;a class=&#34;link&#34; href=&#34;https://github.com/golang/go/blob/go1.24.0/src/runtime/proc.go#L3986-L4068&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;&lt;code&gt;schedule&lt;/code&gt;&lt;/a&gt; å‡½æ•°â€”â€”ä»è€Œå†æ¬¡å½¢æˆ &lt;a class=&#34;link&#34; href=&#34;https://nghiant3223.github.io/2025/04/15/go-scheduler.html#schedule-loop&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;schedule å¾ªç¯ &lt;/a&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹å›¾å±•ç¤ºäº† Go è¿è¡Œæ—¶ä¸­çš„è°ƒåº¦å¾ªç¯ï¼Œå…¶ä¸­ç²‰è‰²ä»£ç å—æ˜¯ç”¨æˆ·ç¼–å†™çš„ Go ä»£ç ï¼Œ é»„è‰²ä»£ç å—æ˜¯ Go è¿è¡Œæ—¶ä»£ç ã€‚è™½ç„¶ä»¥ä¸‹å†…å®¹çœ‹ä¼¼æ˜¾è€Œæ˜“è§ï¼Œä½†è¯·æ³¨æ„ï¼Œè°ƒåº¦å¾ªç¯æ˜¯ç”±çº¿ç¨‹æ‰§è¡Œçš„ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆå®ƒä¼šåœ¨çº¿ç¨‹åˆå§‹åŒ–ï¼ˆ è“è‰²ä»£ç å—ï¼‰ä¹‹åæ‰§è¡Œçš„åŸå› ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://img.golang.space/img-1769612399600.png&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;image-20260128225959394&#34;
	
	
&gt;&lt;/p&gt;
&lt;p&gt;ä½†å¦‚æœä¸»çº¿ç¨‹é™·å…¥è°ƒåº¦å¾ªç¯ï¼Œè¿›ç¨‹å¦‚ä½•é€€å‡ºå‘¢ï¼Ÿåªéœ€æŸ¥çœ‹ Go è¿è¡Œæ—¶ä¸­çš„ &lt;a class=&#34;link&#34; href=&#34;https://github.com/golang/go/blob/go1.24.0/src/runtime/proc.go#L307-L307&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;&lt;code&gt;main&lt;/code&gt;&lt;/a&gt; å‡½æ•°ï¼Œå®ƒç”± main goroutine æ‰§è¡Œã€‚main_main &lt;a class=&#34;link&#34; href=&#34;https://github.com/golang/go/blob/go1.24.0/src/runtime/proc.go#L134-L135&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;&lt;code&gt;main_main&lt;/code&gt;&lt;/a&gt; Go ç¨‹åºå‘˜ç¼–å†™çš„ &lt;code&gt;main&lt;/code&gt; å‡½æ•°çš„åˆ«åï¼Œè¿”å›åï¼Œä¼šè°ƒç”¨ &lt;a class=&#34;link&#34; href=&#34;https://man7.org/linux/man-pages/man3/exit.3.html&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;&lt;code&gt;exit&lt;/code&gt;&lt;/a&gt; ç³»ç»Ÿè°ƒç”¨æ¥ç»ˆæ­¢è¿›ç¨‹ã€‚è¿™å°±æ˜¯è¿›ç¨‹é€€å‡ºçš„æ–¹å¼ï¼Œä¹Ÿæ˜¯ main goroutine ä¸ä¼šç­‰å¾…ç”± &lt;code&gt;go&lt;/code&gt; å…³é”®å­—åˆ›å»ºçš„ goroutine çš„åŸå› ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;å¯»æ‰¾å¯è¿è¡Œçš„ Goroutine&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;çº¿ç¨‹ &lt;code&gt;M&lt;/code&gt; çš„èŒè´£æ˜¯æ‰¾åˆ°åˆé€‚çš„å¯è¿è¡Œ goroutineï¼Œä»¥æœ€å¤§ç¨‹åº¦åœ°å‡å°‘ goroutine é¥¥é¥¿ç°è±¡ã€‚è¿™ä¸€é€»è¾‘åœ¨ &lt;a class=&#34;link&#34; href=&#34;https://github.com/golang/go/blob/go1.24.0/src/runtime/proc.go#L3267-L3646&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;&lt;code&gt;findRunnable&lt;/code&gt;&lt;/a&gt; å‡½æ•°ä¸­å®ç°ï¼Œè¯¥å‡½æ•°ç”±&lt;a class=&#34;link&#34; href=&#34;https://nghiant3223.github.io/2025/04/15/go-scheduler.html#schedule-loop&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;è°ƒåº¦å¾ªç¯&lt;/a&gt;è°ƒç”¨ã€‚&lt;/p&gt;
&lt;p&gt;çº¿ç¨‹ &lt;code&gt;M&lt;/code&gt; æŒ‰ä»¥ä¸‹é¡ºåºæŸ¥æ‰¾å¯è¿è¡Œçš„ goroutineï¼Œå¦‚æœæ‰¾åˆ°åˆ™åœæ­¢é“¾å¼è°ƒç”¨ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;æ£€æŸ¥&lt;a class=&#34;link&#34; href=&#34;https://go.dev/blog/execution-traces-2024#trace-reader-api&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;è·Ÿè¸ªè¯»å–å™¨ &lt;/a&gt;goroutine çš„å¯ç”¨æ€§ï¼ˆç”¨äº&lt;a class=&#34;link&#34; href=&#34;https://nghiant3223.github.io/2025/04/15/go-scheduler.html#non-cooperative-preemption&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;éåˆä½œæŠ¢å &lt;/a&gt;éƒ¨åˆ†ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;æ£€æŸ¥åƒåœ¾å›æ”¶å·¥ä½œç¨‹åº goroutine çš„å¯ç”¨æ€§ï¼ˆè¯¦è§&lt;a class=&#34;link&#34; href=&#34;https://nghiant3223.github.io/2025/04/15/go-scheduler.html#garbage-collector&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;åƒåœ¾å›æ”¶å™¨&lt;/a&gt;éƒ¨åˆ†ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;1/61 æ¬¡ï¼Œæ£€æŸ¥å…¨å±€è¿è¡Œé˜Ÿåˆ—ã€‚&lt;/li&gt;
&lt;li&gt;æ£€æŸ¥å…³è”å¤„ç†å™¨ &lt;code&gt;P&lt;/code&gt; çš„æœ¬åœ°è¿è¡Œé˜Ÿåˆ—ï¼Œå¦‚æœ &lt;code&gt;M&lt;/code&gt; æ­£åœ¨è¿è¡Œã€‚&lt;/li&gt;
&lt;li&gt;å†æ¬¡æ£€æŸ¥å…¨å±€è¿è¡Œé˜Ÿåˆ—ã€‚&lt;/li&gt;
&lt;li&gt;æ£€æŸ¥ netpoll æ˜¯å¦æœ‰ I/O å°±ç»ªçš„ goroutineï¼ˆè¯¦è§ &lt;a class=&#34;link&#34; href=&#34;https://nghiant3223.github.io/2025/04/15/go-scheduler.html#how-netpoll-works&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;netpoll å·¥ä½œåŸç†&lt;/a&gt;éƒ¨åˆ†ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;ä»å…¶ä»–å¤„ç†å™¨ &lt;code&gt;P1&lt;/code&gt; çš„æœ¬åœ°è¿è¡Œé˜Ÿåˆ—ä¸­çªƒå–èµ„æºã€‚&lt;/li&gt;
&lt;li&gt;å†æ¬¡æ£€æŸ¥åƒåœ¾å›æ”¶å·¥ä½œç¨‹åº goroutine çš„å¯ç”¨æ€§ã€‚&lt;/li&gt;
&lt;li&gt;å¦‚æœ &lt;code&gt;M&lt;/code&gt; æ­£åœ¨è¿è¡Œï¼Œè¯·å†æ¬¡æ£€æŸ¥å…¨å±€è¿è¡Œé˜Ÿåˆ—&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;æ­¥éª¤ 1ã€2 å’Œ 8 ä»…ä¾› Go è¿è¡Œæ—¶å†…éƒ¨ä½¿ç”¨ã€‚åœ¨æ­¥éª¤ 1 ä¸­ï¼Œä½¿ç”¨è·Ÿè¸ªè¯»å–å™¨æ¥è·Ÿè¸ªç¨‹åºçš„æ‰§è¡Œæƒ…å†µã€‚ç¨åæ‚¨å°†åœ¨ &lt;a class=&#34;link&#34; href=&#34;https://nghiant3223.github.io/2025/04/15/go-scheduler.html#goroutine-preemption&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;â€œGoroutine æŠ¢å â€&lt;/a&gt; éƒ¨åˆ†çœ‹åˆ°å®ƒçš„ç”¨æ³•ã€‚åŒæ—¶ï¼Œæ­¥éª¤ 2 å’Œ 8 å…è®¸åƒåœ¾å›æ”¶å™¨ä¸å¸¸è§„ goroutine å¹¶å‘è¿è¡Œã€‚è™½ç„¶è¿™äº›æ­¥éª¤ä¸ä¼šå¯¹â€œç”¨æˆ·å¯è§â€çš„è¿›åº¦äº§ç”Ÿå½±å“ï¼Œä½†å®ƒä»¬å¯¹äº Go è¿è¡Œæ—¶çš„æ­£å¸¸è¿è¡Œè‡³å…³é‡è¦ã€‚&lt;/p&gt;
&lt;p&gt;æ­¥éª¤ 3ã€5 å’Œ 9 å¹¶éåªè·å–ä¸€ä¸ª goroutineï¼Œè€Œæ˜¯å°è¯•è·å–ä¸€æ‰¹ goroutine ä»¥æé«˜æ•ˆç‡ã€‚æ‰¹å¤„ç†å¤§å°è®¡ç®—ä¸º &lt;code&gt;(global_queue_size/number_of_processors)+1&lt;/code&gt; ï¼Œä½†å—åˆ°å‡ ä¸ªå› ç´ çš„é™åˆ¶ï¼šå®ƒä¸ä¼šè¶…è¿‡æŒ‡å®šçš„æœ€å¤§å‚æ•°ï¼Œä¹Ÿä¸ä¼šè¶…è¿‡ P æœ¬åœ°é˜Ÿåˆ—å®¹é‡çš„ä¸€åŠã€‚ç¡®å®šè¦è·å–çš„ goroutine æ•°é‡åï¼Œå®ƒä¼šå¼¹å‡ºä¸€ä¸ª goroutine ç›´æ¥è¿”å›ï¼ˆè¯¥ goroutine å°†ç«‹å³è¿è¡Œï¼‰ï¼Œå¹¶å°†å…¶ä½™çš„ goroutine æ”¾å…¥ P çš„æœ¬åœ°è¿è¡Œé˜Ÿåˆ—ä¸­ã€‚è¿™ç§æ‰¹å¤„ç†æ–¹æ³•æœ‰åŠ©äºåœ¨å¤„ç†å™¨ä¹‹é—´è¿›è¡Œè´Ÿè½½å‡è¡¡ï¼Œå¹¶å‡å°‘å¯¹å…¨å±€é˜Ÿåˆ—é”çš„äº‰ç”¨ï¼Œå› ä¸ºå¤„ç†å™¨ä¸éœ€è¦é¢‘ç¹è®¿é—®å…¨å±€é˜Ÿåˆ—ã€‚&lt;/p&gt;
&lt;p&gt;æ­¥éª¤ 4 ç¨å¾®å¤æ‚ä¸€äº›ï¼Œå› ä¸º &lt;code&gt;P&lt;/code&gt; çš„æœ¬åœ°è¿è¡Œé˜Ÿåˆ—åŒ…å«ä¸¤éƒ¨åˆ†ï¼š &lt;code&gt;runnext&lt;/code&gt; å’Œ &lt;code&gt;runq&lt;/code&gt; ã€‚å¦‚æœ &lt;code&gt;runnext&lt;/code&gt; ä¸ä¸ºç©ºï¼Œåˆ™è¿”å› &lt;code&gt;runnext&lt;/code&gt; ä¸­çš„ goroutineã€‚å¦åˆ™ï¼Œå®ƒä¼šæ£€æŸ¥ &lt;code&gt;runq&lt;/code&gt; æ˜¯å¦æœ‰å¯è¿è¡Œçš„ goroutine å¹¶å°†å…¶å‡ºé˜Ÿã€‚æ­¥éª¤ 6 å°†åœ¨ &lt;a class=&#34;link&#34; href=&#34;https://nghiant3223.github.io/2025/04/15/go-scheduler.html#how-netpoll-works&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;â€œnetpoll å·¥ä½œåŸç†â€&lt;/a&gt; éƒ¨åˆ†è¯¦ç»†æè¿°ã€‚&lt;/p&gt;
&lt;p&gt;æ­¥éª¤ 7 æ˜¯æ•´ä¸ªè¿‡ç¨‹ä¸­æœ€å¤æ‚çš„éƒ¨åˆ†ã€‚å®ƒæœ€å¤šä¼šå°è¯•å››æ¬¡ä»å¦ä¸€ä¸ªå¤„ç†å™¨ï¼ˆç§°ä¸º &lt;code&gt;P1&lt;/code&gt; çªƒå–å·¥ä½œã€‚åœ¨å‰ä¸‰æ¬¡å°è¯•ä¸­ï¼Œå®ƒåªå°è¯•ä» &lt;code&gt;P1&lt;/code&gt; çš„ &lt;code&gt;runq&lt;/code&gt; ä¸­çªƒå– goroutineã€‚å¦‚æœæˆåŠŸï¼Œ &lt;code&gt;P1&lt;/code&gt; &lt;code&gt;runq&lt;/code&gt; ä¸­ä¸€åŠçš„ goroutine ä¼šè¢«è½¬ç§»åˆ°å½“å‰å¤„ç†å™¨ &lt;code&gt;P&lt;/code&gt; çš„ &lt;code&gt;runq&lt;/code&gt; ä¸­ã€‚åœ¨æœ€åä¸€æ¬¡å°è¯•ä¸­ï¼Œå®ƒé¦–å…ˆå°è¯•ä» &lt;code&gt;P1&lt;/code&gt; çš„ &lt;code&gt;runnext&lt;/code&gt; æ§½ï¼ˆå¦‚æœå¯ç”¨ï¼‰ä¸­çªƒå–å·¥ä½œï¼Œå¦‚æœä»ç„¶æ— æ³•ä»ä¸­çªƒå–ï¼Œåˆ™å›é€€åˆ° &lt;code&gt;P1&lt;/code&gt; çš„ &lt;code&gt;runq&lt;/code&gt; ã€‚&lt;/p&gt;
&lt;p&gt;è¯·æ³¨æ„ï¼Œ &lt;a class=&#34;link&#34; href=&#34;https://github.com/golang/go/blob/go1.24.0/src/runtime/proc.go#L3267-L3646&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;&lt;code&gt;findRunnable&lt;/code&gt;&lt;/a&gt; ä¸ä»…èƒ½æ‰¾åˆ°å¯è¿è¡Œçš„ goroutineï¼Œè¿˜èƒ½å”¤é†’åœ¨æ­¥éª¤ 1 å‘ç”Ÿä¹‹å‰è¿›å…¥ç¡çœ çŠ¶æ€çš„ goroutineã€‚goroutine è¢«å”¤é†’åï¼Œå°†è¢«æ”¾å…¥æ‰§è¡Œå®ƒçš„å¤„ç†å™¨ &lt;code&gt;P&lt;/code&gt; çš„æœ¬åœ°è¿è¡Œé˜Ÿåˆ—ä¸­ï¼Œç­‰å¾…è¢«æŸä¸ªçº¿ç¨‹ &lt;code&gt;M&lt;/code&gt; é¢†å–å¹¶æ‰§è¡Œã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœåœ¨æ­¥éª¤ 9 ä¹‹åä»æœªæ‰¾åˆ° goroutineï¼Œçº¿ç¨‹ &lt;code&gt;M&lt;/code&gt; å°†ç­‰å¾… &lt;code&gt;netpoll&lt;/code&gt; è¿”å›ï¼Œç›´åˆ°æœ€è¿‘çš„&lt;a class=&#34;link&#34; href=&#34;https://github.com/golang/go/blob/go1.24.0/src/runtime/time.go#L35-L107&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;å®šæ—¶å™¨&lt;/a&gt;è¶…æ—¶â€”â€”ä¾‹å¦‚ goroutine ä»ç¡çœ çŠ¶æ€å”¤é†’æ—¶ï¼ˆå› ä¸º Go å†…éƒ¨çš„ç¡çœ æ“ä½œä¼šåˆ›å»ºä¸€ä¸ªå®šæ—¶å™¨ï¼‰ã€‚ä¸ºä»€ä¹ˆ &lt;code&gt;netpoll&lt;/code&gt; ä¼šä¸å®šæ—¶å™¨ç›¸å…³ï¼Ÿè¿™æ˜¯å› ä¸º Go çš„å®šæ—¶å™¨ç³»ç»Ÿä¸¥é‡ä¾èµ–äº &lt;code&gt;netpoll&lt;/code&gt; ï¼Œæ­£å¦‚&lt;a class=&#34;link&#34; href=&#34;https://github.com/golang/go/blob/go1.24.0/src/runtime/time.go#L427-L427&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;è¿™æ®µ&lt;/a&gt;ä»£ç æ³¨é‡Šä¸­æ‰€è¿°ã€‚netpoll è¿”å›åï¼Œ &lt;code&gt;M&lt;/code&gt; å°†é‡æ–°è¿›å…¥&lt;a class=&#34;link&#34; href=&#34;https://nghiant3223.github.io/2025/04/15/go-scheduler.html#schedule-loop&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;è°ƒåº¦å¾ªç¯ &lt;/a&gt;&lt;code&gt;netpoll&lt;/code&gt; å†æ¬¡æœç´¢å¯è¿è¡Œçš„ goroutineã€‚&lt;/p&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://github.com/golang/go/blob/go1.24.0/src/runtime/proc.go#L3267-L3646&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;&lt;code&gt;findRunnable&lt;/code&gt;&lt;/a&gt; çš„å‰ä¸¤ä¸ªè¡Œä¸ºå…è®¸ Go è°ƒåº¦å™¨å”¤é†’ä¼‘çœ çš„ goroutineï¼Œä»è€Œä½¿ç¨‹åºèƒ½å¤Ÿç»§ç»­æ‰§è¡Œã€‚å®ƒä»¬è§£é‡Šäº†ä¸ºä»€ä¹ˆæ¯ä¸ª goroutineï¼ˆåŒ…æ‹¬ä¸» goroutineï¼‰åœ¨ä¼‘çœ åéƒ½æœ‰æœºä¼šè¿è¡Œã€‚æˆ‘ä»¬å°†åœ¨å¦ä¸€ç¯‡æ–‡ç« ä¸­çœ‹çœ‹ä¸‹é¢çš„ Go ç¨‹åºæ˜¯å¦‚ä½•å·¥ä½œçš„ ğŸ˜„ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;package&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;main&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;time&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;go&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nx&#34;&gt;time&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Sleep&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;time&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Second&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;}()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nx&#34;&gt;time&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Sleep&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;time&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Second&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;å¦‚æœ &lt;code&gt;P&lt;/code&gt; æ²¡æœ‰&lt;a class=&#34;link&#34; href=&#34;https://github.com/golang/go/blob/go1.24.0/src/runtime/time.go#L35-L107&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;å®šæ—¶å™¨ &lt;/a&gt;ï¼Œåˆ™å…¶å¯¹åº”çš„çº¿ç¨‹ &lt;code&gt;M&lt;/code&gt; å°†å¤„äºç©ºé—²çŠ¶æ€ã€‚ &lt;code&gt;P&lt;/code&gt; è¢«æ”¾å…¥ç©ºé—²åˆ—è¡¨ï¼Œ &lt;code&gt;M&lt;/code&gt; é€šè¿‡è°ƒç”¨ &lt;a class=&#34;link&#34; href=&#34;https://nghiant3223.github.io/2025/04/15/go-scheduler.html#stop-thread-stopm&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;&lt;code&gt;stopm&lt;/code&gt;&lt;/a&gt; å‡½æ•°è¿›å…¥ç¡çœ çŠ¶æ€ã€‚å®ƒä¼šä¸€ç›´ä¿æŒç¡çœ çŠ¶æ€ï¼Œç›´åˆ°å¦ä¸€ä¸ª &lt;code&gt;M1&lt;/code&gt; çº¿ç¨‹å°†å…¶å”¤é†’ï¼Œé€šå¸¸æ˜¯åœ¨åˆ›å»ºæ–°çš„ goroutine æ—¶ï¼Œå¦‚ &lt;a class=&#34;link&#34; href=&#34;https://nghiant3223.github.io/2025/04/15/go-scheduler.html#waking-up-processor&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;â€œå”¤é†’å¤„ç†å™¨â€&lt;/a&gt; éƒ¨åˆ†æ‰€è¿°ã€‚ä¸€æ—¦è¢«å”¤é†’ï¼Œ &lt;code&gt;M&lt;/code&gt; ä¼šé‡æ–°è¿›å…¥&lt;a class=&#34;link&#34; href=&#34;https://nghiant3223.github.io/2025/04/15/go-scheduler.html#schedule-loop&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;è°ƒåº¦å¾ªç¯ &lt;/a&gt;ï¼Œä»¥æŸ¥æ‰¾å¹¶æ‰§è¡Œå¯è¿è¡Œçš„ goroutineã€‚&lt;/p&gt;
&lt;h2 id=&#34;å‚è€ƒ&#34;&gt;å‚è€ƒ&lt;/h2&gt;
&lt;p&gt;æœ¬æ–‡ç¿»è¯‘äº &lt;a class=&#34;link&#34; href=&#34;https://nghiant3223.github.io/2025/04/15/go-scheduler.html#go-scheduler&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;go-scheduler.html#go-scheduler&lt;/a&gt;&lt;/p&gt;
</description>
        </item>
        
    </channel>
</rss>
