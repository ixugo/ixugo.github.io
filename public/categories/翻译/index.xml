<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
    <channel>
        <title>ç¿»è¯‘ on ixugo</title>
        <link>https://blog.golang.space/categories/%E7%BF%BB%E8%AF%91/</link>
        <description>Recent content in ç¿»è¯‘ on ixugo</description>
        <generator>Hugo -- gohugo.io</generator>
        <language>zh-cn</language>
        <lastBuildDate>Fri, 25 Apr 2025 00:00:00 +0000</lastBuildDate><atom:link href="https://blog.golang.space/categories/%E7%BF%BB%E8%AF%91/index.xml" rel="self" type="application/rss+xml" /><item>
        <title>åœ¨ Go å’Œ Docker ä¸­æœå¯»åƒµå°¸è¿›ç¨‹</title>
        <link>https://blog.golang.space/p/%E5%9C%A8-go-%E5%92%8C-docker-%E4%B8%AD%E6%90%9C%E5%AF%BB%E5%83%B5%E5%B0%B8%E8%BF%9B%E7%A8%8B/</link>
        <pubDate>Fri, 25 Apr 2025 00:00:00 +0000</pubDate>
        
        <guid>https://blog.golang.space/p/%E5%9C%A8-go-%E5%92%8C-docker-%E4%B8%AD%E6%90%9C%E5%AF%BB%E5%83%B5%E5%B0%B8%E8%BF%9B%E7%A8%8B/</guid>
        <description>&lt;p&gt;ä¸Šå‘¨ï¼Œæˆ‘é‡åˆ°äº†ä¸€ä¸ªæ£˜æ‰‹çš„é—®é¢˜ï¼šåƒµå°¸è¿›ç¨‹å¯¼è‡´æˆ‘çš„æ¼”ç¤ºæœåŠ¡å™¨å´©æºƒ ğŸ§Ÿâ€â™‚ï¸ å¦‚æœä½ æœ‰è¿‡åœ¨ Go æˆ– Docker ä¸­å¤„ç†è¿›ç¨‹ç®¡ç†çš„ç»éªŒï¼Œä½ å¯èƒ½ä¼šå¯¹è¿™æ®µç»å†æ„ŸåŒèº«å—ã€‚ä¸‹é¢æ˜¯å¯¹è¿™ä¸ªé—®é¢˜çš„æ·±å…¥æŠ€æœ¯åˆ†æï¼Œä»¥åŠæˆ‘æ˜¯å¦‚ä½•è¿½è¸ªå¹¶è§£å†³å®ƒçš„ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬æœ‰ä¸€ä¸ªåŠŸèƒ½ï¼Œåœ¨ Stormkit ä¸­å¯ä»¥æ ¹æ®è‡ªæ‰˜ç®¡ç”¨æˆ·çš„éœ€æ±‚å¯åŠ¨ Node.js æœåŠ¡å™¨ï¼Œä½¿ç”¨åŠ¨æ€ç«¯å£åˆ†é…åœ¨åŒä¸€æœåŠ¡å™¨ä¸Šè¿è¡Œå¤šä¸ªå®ä¾‹ã€‚å®ƒæ˜¯ç”¨ Go ç¼–å†™çš„ï¼Œåˆ©ç”¨ &lt;code&gt;os/exec&lt;/code&gt; æ¥ç®¡ç†è¿›ç¨‹ã€‚è¯¥ç³»ç»Ÿä¸€ç›´éå¸¸ç¨³å®šâ€”â€”æ²¡æœ‰å®•æœºæ—¶é—´ï¼Œç”¨æˆ·ä¹Ÿå¾ˆæ»¡æ„ã€‚&lt;/p&gt;
&lt;p&gt;æœ€è¿‘ï¼Œæˆ‘è®¾ç½®äº†ä¸€ä¸ªç”¨äºæ‰˜ç®¡ Next.js å’Œ Svelte æœåŠ¡å™¨ç«¯åº”ç”¨çš„æ¼”ç¤ºæœåŠ¡å™¨ã€‚ä¸€åˆ‡çœ‹èµ·æ¥éƒ½æ­£å¸¸ï¼Œç›´åˆ°æœåŠ¡å™¨å¼€å§‹éšæœºå‡ºç° Redis å‘å¸ƒ/è®¢é˜…é”™è¯¯è€Œå´©æºƒã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘å°† Redis å‡çº§åˆ°äº† 7.x ç‰ˆæœ¬ï¼Œæ£€æŸ¥äº†æ—¥å¿—å¹¶å°è¯•åœ¨æœ¬åœ°é‡ç°é—®é¢˜â€”â€”æ²¡æœ‰å‘ç°ä»»ä½•é—®é¢˜ã€‚å´©æºƒæ˜¯éšæœºä¸”éš¾ä»¥æ‰æ‘¸çš„ã€‚ç„¶åï¼Œæˆ‘ç¦ç”¨äº† Next.js åº”ç”¨ï¼Œå´©æºƒå°±åœæ­¢äº†ã€‚æˆ‘æ€€ç–‘æ˜¯ Next.js æœ¬èº«çš„é—®é¢˜ï¼Œäºæ˜¯æ·±å…¥ç ”ç©¶äº†å…¶è¿è¡Œæ—¶è¡Œä¸ºï¼Œä½†æ²¡æœ‰å‘ç°ä»€ä¹ˆå¼‚å¸¸ã€‚&lt;/p&gt;
&lt;p&gt;æŸ¥çœ‹æœåŠ¡å™¨æŒ‡æ ‡æ—¶ï¼Œæˆ‘å‘ç°å†…å­˜ä½¿ç”¨ç‡åœ¨å´©æºƒå‰ä¼šæ¿€å¢ã€‚å¿«é€Ÿè¿è¡Œ &lt;code&gt;ps aux&lt;/code&gt; å‘½ä»¤åï¼Œæˆ‘å‘ç°æœ‰ä¸€å †é—ç•™çš„ Next.js è¿›ç¨‹æ²¡æœ‰è¢«ç»ˆæ­¢ã€‚æˆ‘ä»¬çš„å…³æœºé€»è¾‘å¤±è´¥äº†ï¼Œå¯¼è‡´å†…å­˜æ³„æ¼ï¼Œæœ€ç»ˆè€—å°½äº†æœåŠ¡å™¨èµ„æºã€‚&lt;/p&gt;
&lt;p&gt;ç½ªé­ç¥¸é¦–åœ¨äºæˆ‘ä»¬çš„ Go ä»£ç ã€‚æˆ‘ä½¿ç”¨ &lt;code&gt;os.Process.Kill&lt;/code&gt; æ¥ç»ˆæ­¢è¿›ç¨‹ï¼Œä½†æ²¡æœ‰æ€æ­»ç”± npm å¯åŠ¨çš„å­è¿›ç¨‹ï¼ˆä¾‹å¦‚ï¼Œ &lt;code&gt;npm run start&lt;/code&gt; å¯åŠ¨äº† &lt;code&gt;next start&lt;/code&gt; ï¼‰ã€‚è¿™å¯¼è‡´å­¤å„¿è¿›ç¨‹ä¸æ–­ç´¯ç§¯ã€‚è¿™é‡Œæœ‰ä¸€ä¸ªåŸå§‹ä»£ç çš„ç®€åŒ–ç‰ˆæœ¬ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;stopProcess&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;cmd&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;exec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Cmd&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;error&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;cmd&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Process&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!=&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;nil&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;cmd&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Process&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Kill&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;nil&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;æˆ‘é€šè¿‡å¯åŠ¨ä¸€ä¸ªå¸¦æœ‰å­è¿›ç¨‹çš„ Node.js è¿›ç¨‹å¹¶æ€æ­»çˆ¶è¿›ç¨‹æ¥æœ¬åœ°é‡ç°äº†è¿™ä¸ªé—®é¢˜ã€‚æœç„¶ï¼Œå­è¿›ç¨‹è¿˜åœ¨è¿è¡Œã€‚åœ¨ Go ä¸­ï¼Œ &lt;code&gt;os.Process.Kill&lt;/code&gt; å‘è¿›ç¨‹å‘é€ä¿¡å·ï¼Œä½†ä¸å¤„ç†å…¶å­è¿›ç¨‹ã€‚&lt;/p&gt;
&lt;h2 id=&#34;è§£å†³å°è¯•è¿›ç¨‹ç»„&#34;&gt;è§£å†³å°è¯•ï¼šè¿›ç¨‹ç»„&lt;/h2&gt;
&lt;p&gt;è¦æ€æ­»å­è¿›ç¨‹ï¼Œæˆ‘ä¿®æ”¹ä»£ç ä½¿ç”¨äº†è¿›ç¨‹ç»„ã€‚é€šè¿‡ä½¿ç”¨ &lt;code&gt;syscall.SysProcAttr&lt;/code&gt; è®¾ç½®è¿›ç¨‹ç»„ IDï¼ˆPGIDï¼‰ï¼Œæˆ‘å¯ä»¥å‘æ•´ä¸ªç»„å‘é€ä¿¡å·ã€‚è¿™æ˜¯æ›´æ–°åçš„ä»£ç ï¼ˆç®€åŒ–ç‰ˆï¼‰ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;package&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;main&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;s&#34;&gt;&amp;#34;log&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;s&#34;&gt;&amp;#34;os/exec&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;s&#34;&gt;&amp;#34;syscall&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;startProcess&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;exec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Cmd&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;error&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;nx&#34;&gt;cmd&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;exec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Command&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;npm&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;run&amp;#34;&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;start&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;nx&#34;&gt;cmd&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;SysProcAttr&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;syscall&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;SysProcAttr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Setpgid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;true&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// Assign PGID
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;cmd&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Start&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!=&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;nil&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;nil&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;cmd&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;nil&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;stopProcess&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;cmd&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;exec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Cmd&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;error&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;cmd&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Process&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;nil&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;nil&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;c1&#34;&gt;// Send SIGTERM to the process group
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;  &lt;span class=&#34;nx&#34;&gt;pgid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;syscall&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Getpgid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;cmd&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Process&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Pid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!=&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;nil&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;syscall&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Kill&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;pgid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;syscall&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;SIGTERM&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// Negative PGID targets group
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;è¿™åœ¨æœ¬åœ°å·¥ä½œäº†ï¼šæ€æ­»çˆ¶è¿›ç¨‹ä¹Ÿç»ˆæ­¢äº†å­è¿›ç¨‹ã€‚æˆ‘å°†ä¸€ä¸ªæµ‹è¯•ç‰ˆæœ¬éƒ¨ç½²åˆ°æˆ‘ä»¬çš„è¿œç¨‹æœåŠ¡å™¨ä¸Šï¼ŒæœŸæœ›èƒœåˆ©ã€‚ä½† &lt;code&gt;ps aux&lt;/code&gt; æ˜¾ç¤º &lt;code&gt;&amp;lt;defunct&amp;gt;&lt;/code&gt; æ¥è¿‘è¿›ç¨‹æ—è¾¹â€”â€”åƒµå°¸è¿›ç¨‹ï¼ğŸ§ &lt;/p&gt;
&lt;h2 id=&#34;åƒµå°¸è¿›ç¨‹-101&#34;&gt;åƒµå°¸è¿›ç¨‹ 101&lt;/h2&gt;
&lt;p&gt;åœ¨ Linux ä¸­ï¼Œå½“ä¸€ä¸ªå­è¿›ç¨‹ç»ˆæ­¢ï¼Œä½†å…¶çˆ¶è¿›ç¨‹æ²¡æœ‰æ”¶é›†å…¶é€€å‡ºçŠ¶æ€ï¼ˆé€šè¿‡ wait æˆ– waitpidï¼‰æ—¶ï¼Œå°±ä¼šå‡ºç°åƒµå°¸è¿›ç¨‹ã€‚è¯¥è¿›ç¨‹ä¼šåœç•™åœ¨è¿›ç¨‹è¡¨ä¸­ï¼Œæ ‡è®°ä¸º &lt;code&gt;&amp;lt;defunct&amp;gt;&lt;/code&gt; ã€‚å°‘é‡çš„åƒµå°¸è¿›ç¨‹æ˜¯æ— å®³çš„ï¼Œä½†å½“å®ƒä»¬ç§¯ç´¯æ—¶ï¼Œä¼šè€—å°½è¿›ç¨‹è¡¨ï¼Œé˜»æ­¢æ–°è¿›ç¨‹çš„å¯åŠ¨ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨æœ¬åœ°ï¼Œæˆ‘çš„ Go äºŒè¿›åˆ¶æ–‡ä»¶å¯ä»¥æ­£å¸¸å›æ”¶è¿›ç¨‹ã€‚ä½†åœ¨è¿œç¨‹ï¼Œåƒµå°¸è¿›ç¨‹ä»ç„¶å­˜åœ¨ã€‚å…³é”®åŒºåˆ«åœ¨äºè¿œç¨‹æœåŠ¡å™¨åœ¨ Docker å®¹å™¨ä¸­è¿è¡Œäº† Stormkitã€‚&lt;/p&gt;
&lt;h2 id=&#34;docker-çš„åƒµå°¸è¿›ç¨‹é—®é¢˜&#34;&gt;Docker çš„åƒµå°¸è¿›ç¨‹é—®é¢˜&lt;/h2&gt;
&lt;p&gt;Docker å°† PID 1 åˆ†é…ç»™å®¹å™¨çš„å…¥å£ç‚¹ï¼ˆå³æˆ‘ä»¬çš„ Go äºŒè¿›åˆ¶æ–‡ä»¶ï¼‰ã€‚åœ¨ Linux ä¸­ï¼ŒPID 1ï¼ˆ &lt;code&gt;init/systemd&lt;/code&gt; ï¼‰è´Ÿè´£æ”¶å…»å­¤å„¿è¿›ç¨‹å¹¶å›æ”¶å…¶è‡ªèº«çš„åƒµå°¸å­è¿›ç¨‹ï¼ŒåŒ…æ‹¬å®ƒå·²ç»æ”¶å…»çš„å‰å­¤å„¿è¿›ç¨‹ã€‚å¦‚æœ PID 1 æ²¡æœ‰å¤„ç† &lt;code&gt;SIGCHLD&lt;/code&gt; ä¿¡å·å¹¶è°ƒç”¨ waitï¼Œåƒµå°¸è¿›ç¨‹å°±ä¼šç´¯ç§¯ã€‚æˆ‘ä»¬çš„ Go ç¨‹åºå¹¶æ²¡æœ‰è®¾è®¡æˆä¸€ä¸ªåˆå§‹åŒ–ç³»ç»Ÿï¼Œæ‰€ä»¥å®ƒå¿½ç•¥äº†å­¤å„¿è¿›ç¨‹ã€‚&lt;/p&gt;
&lt;h2 id=&#34;è§£å†³æ–¹æ¡ˆtini&#34;&gt;è§£å†³æ–¹æ¡ˆï¼šTini&lt;/h2&gt;
&lt;p&gt;ç»è¿‡è¿›ä¸€æ­¥è°ƒæŸ¥ï¼Œæˆ‘å‘ç°å›æ”¶åƒµå°¸è¿›ç¨‹æ˜¯ Docker é•¿æœŸå­˜åœ¨çš„é—®é¢˜ï¼Œæ‰€ä»¥å¸‚åœºä¸Šå·²ç»æœ‰äº†è§£å†³æ–¹æ¡ˆã€‚æœ€ç»ˆæˆ‘æ‰¾åˆ°äº† Tiniï¼Œè¿™æ˜¯ä¸€ä¸ªä¸ºå®¹å™¨è®¾è®¡çš„è½»é‡çº§åˆå§‹åŒ–ç³»ç»Ÿã€‚Tini ä½œä¸º PID 1 è¿è¡Œï¼Œé€šè¿‡å¤„ç† SIGCHLD å’Œ wait æ‰€æœ‰è¿›ç¨‹æ¥æ­£ç¡®å›æ”¶åƒµå°¸è¿›ç¨‹ã€‚æˆ‘æ›´æ–°äº†æˆ‘ä»¬çš„ Dockerfileï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;ENTRYPOINT&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;/usr/bin/tini&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;--&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;CMD&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;/app/stormkit&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;æˆ–è€…ï¼Œæˆ‘å¯ä»¥ä½¿ç”¨ Docker çš„ &amp;ndash;init æ ‡å¿—ï¼Œè¯¥æ ‡å¿—ä¼šè‡ªåŠ¨æ·»åŠ  Tiniã€‚&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨ Tini éƒ¨ç½²åï¼Œ &lt;code&gt;ps aux&lt;/code&gt; å¹²å‡€äº†â€”â€”æ²¡æœ‰åƒµå°¸è¿›ç¨‹ï¼ğŸ‰ æœåŠ¡å™¨ç¨³å®šäº†ï¼ŒRedis é”™è¯¯æ¶ˆå¤±äº†ï¼Œå› ä¸ºå®ƒä»¬æ˜¯èµ„æºè€—å°½çš„å‰¯ä½œç”¨ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æ€»ç»“&#34;&gt;æ€»ç»“&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Go è¿›ç¨‹ç®¡ç†ï¼šos.Process.Kill ä¸å¤„ç†å­è¿›ç¨‹ã€‚ä½¿ç”¨è¿›ç¨‹ç»„æˆ–é€‚å½“çš„ä¿¡å·å¤„ç†ä»¥å®ç°å¹²å‡€ç»ˆæ­¢ã€‚&lt;/li&gt;
&lt;li&gt;Docker PID 1ï¼šå¦‚æœä½ çš„åº”ç”¨ç¨‹åºä½œä¸º PID 1 è¿è¡Œï¼Œå®ƒéœ€è¦å›æ”¶åƒµå°¸è¿›ç¨‹æˆ–å§”æ‰˜ç»™åƒ Tini è¿™æ ·çš„åˆå§‹åŒ–ç³»ç»Ÿã€‚&lt;/li&gt;
&lt;li&gt;è°ƒè¯•æç¤ºï¼šå¤„ç†å´©æºƒæ—¶ï¼Œè¯·å§‹ç»ˆæ£€æŸ¥ &lt;code&gt;ps aux&lt;/code&gt; æŸ¥çœ‹è¿›ç¨‹ã€‚&lt;/li&gt;
&lt;li&gt;æ ¹æœ¬åŸå› å¾ˆé‡è¦ï¼šRedis é”™è¯¯åªæ˜¯ä¸€ä¸ªè¯¯å¯¼â€”â€”åƒµå°¸è¿›ç¨‹å¯¼è‡´çš„å†…å­˜è€—å°½æ‰æ˜¯çœŸæ­£çš„é—®é¢˜ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;å‚è€ƒ&#34;&gt;å‚è€ƒ&lt;/h2&gt;
&lt;p&gt;æœ¬æ–‡ç¿»è¯‘äº &lt;a class=&#34;link&#34; href=&#34;https://www.stormkit.io/blog/hunting-zombie-processes-in-go-and-docker&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Hunting Zombie Processes in Go and Docker  &lt;/a&gt;&lt;/p&gt;
</description>
        </item>
        <item>
        <title>Go ä¸­çš„å¼±æŒ‡é’ˆ:ä¸ºä»€ä¹ˆä»–ä»¬ç°åœ¨å¾ˆé‡è¦?</title>
        <link>https://blog.golang.space/p/go-%E4%B8%AD%E7%9A%84%E5%BC%B1%E6%8C%87%E9%92%88%E4%B8%BA%E4%BB%80%E4%B9%88%E4%BB%96%E4%BB%AC%E7%8E%B0%E5%9C%A8%E5%BE%88%E9%87%8D%E8%A6%81/</link>
        <pubDate>Sun, 01 Dec 2024 00:00:00 +0000</pubDate>
        
        <guid>https://blog.golang.space/p/go-%E4%B8%AD%E7%9A%84%E5%BC%B1%E6%8C%87%E9%92%88%E4%B8%BA%E4%BB%80%E4%B9%88%E4%BB%96%E4%BB%AC%E7%8E%B0%E5%9C%A8%E5%BE%88%E9%87%8D%E8%A6%81/</guid>
        <description>&lt;h2 id=&#34;ä»€ä¹ˆæ˜¯å¼±æŒ‡é’ˆå‘¢&#34;&gt;ä»€ä¹ˆæ˜¯å¼±æŒ‡é’ˆå‘¢?&lt;/h2&gt;
&lt;p&gt;å¼±æŒ‡é’ˆåŸºæœ¬ä¸Šæ˜¯ä¸€ç§å¼•ç”¨ä¸€å—å†…å­˜è€Œä¸é”å®šå®ƒçš„æ–¹æ³•ï¼Œå› æ­¤å¦‚æœæ²¡æœ‰å…¶ä»–äººä¸»åŠ¨æŒæœ‰å®ƒï¼Œåƒåœ¾æ”¶é›†å™¨å¯ä»¥æ¸…ç†å®ƒã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;em&gt;ä¸ºä»€ä¹ˆè¿˜è¦ä¸ºå¼±æŒ‡é’ˆçƒ¦æ¼å‘¢ï¼Ÿ Go æœ‰å—ï¼Ÿ&lt;/em&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;å—¯ï¼Œæ˜¯çš„ï¼ŒGo ç¡®å®æœ‰å¼±æŒ‡é’ˆçš„æ¦‚å¿µã€‚å®ƒæ˜¯å¼±åŒ…çš„ä¸€éƒ¨åˆ†ï¼Œä¸ Go è¿è¡Œæ—¶ç´§å¯†ç›¸è¿ã€‚æœ‰è¶£çš„æ˜¯ï¼Œå®ƒæ›¾ç»æ›´å¤šåœ°æ˜¯ä¸€ä¸ªå†…éƒ¨å·¥å…·ï¼Œä½†æœ€è¿‘æœ‰äººé€šè¿‡è¿™ä¸ª&lt;a class=&#34;link&#34; href=&#34;https://github.com/golang/go/issues/67552&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;ææ¡ˆ&lt;/a&gt;æ¨åŠ¨å°†å…¶å…¬å¼€ã€‚&lt;/p&gt;
&lt;p&gt;å¾ˆé…·ï¼Œå¯¹å§ï¼Ÿ&lt;/p&gt;
&lt;p&gt;å¼±æŒ‡é’ˆçš„å…³é”®æ˜¯å®ƒä»¬æ˜¯å®‰å…¨çš„ã€‚å¦‚æœå®ƒä»¬æŒ‡å‘çš„å†…å­˜è¢«æ¸…ç†ï¼Œå¼±æŒ‡é’ˆä¼šè‡ªåŠ¨å˜ä¸º&lt;code&gt;nil&lt;/code&gt;å› æ­¤ä¸å­˜åœ¨æ„å¤–æŒ‡å‘å·²é‡Šæ”¾å†…å­˜çš„é£é™©ã€‚å½“æ‚¨ç¡®å®éœ€è¦ä¿ç•™è¯¥å†…å­˜æ—¶ï¼Œå¯ä»¥å°†å¼±æŒ‡é’ˆè½¬æ¢ä¸ºå¼ºæŒ‡é’ˆã€‚è¿™ä¸ªå¼ºæŒ‡é’ˆå‘Šè¯‰åƒåœ¾æ”¶é›†å™¨ï¼Œâ€œå˜¿ï¼Œå½“æˆ‘ä½¿ç”¨å®ƒæ—¶ï¼Œè¯·æŠŠå®ƒæ”¾å¼€ã€‚â€&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;em&gt;ç­‰ç­‰ï¼Œå®ƒå°±è‡ªåŠ¨å˜æˆ nil äº†ï¼Ÿè¿™å¬èµ·æ¥â€¦â€¦æœ‰é£é™©&lt;/em&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;æ˜¯çš„ï¼Œå¼±æŒ‡é’ˆè‚¯å®šä¼šå˜æˆ&lt;code&gt;nil&lt;/code&gt;æœ‰æ—¶åœ¨ä½ æ„æƒ³ä¸åˆ°çš„æ—¶åˆ»ã€‚&lt;/p&gt;
&lt;p&gt;å®ƒä»¬æ¯”å¸¸è§„æŒ‡é’ˆæ›´éš¾ä½¿ç”¨ã€‚åœ¨ä»»ä½•æ—¶å€™ï¼Œå¦‚æœå¼±æŒ‡é’ˆæŒ‡å‘çš„å†…å­˜è¢«æ¸…ç†ï¼Œå®ƒå°±å¯ä»¥å˜æˆ&lt;code&gt;nil&lt;/code&gt; ã€‚å½“æ²¡æœ‰å¼ºæŒ‡é’ˆæŒæœ‰è¯¥å†…å­˜æ—¶ï¼Œå°±ä¼šå‘ç”Ÿè¿™ç§æƒ…å†µã€‚å› æ­¤ï¼Œå§‹ç»ˆæ£€æŸ¥åˆšåˆšä»å¼±æŒ‡é’ˆè½¬æ¢è€Œæ¥çš„å¼ºæŒ‡é’ˆæ˜¯å¦ä¸º&lt;code&gt;nil&lt;/code&gt;éå¸¸é‡è¦ã€‚&lt;/p&gt;
&lt;p&gt;ç°åœ¨ï¼Œå…³äºæ¸…ç†ä½•æ—¶å‘ç”Ÿâ€”â€”å®ƒä¸æ˜¯ç«‹å³å‘ç”Ÿçš„ã€‚å³ä½¿æ²¡æœ‰äººå¼•ç”¨å†…å­˜ï¼Œæ¸…ç†æ—¶é—´ä¹Ÿå®Œå…¨å–å†³äºåƒåœ¾æ”¶é›†å™¨ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ç°åœ¨ï¼Œå±•ç¤ºä¸€äº›ä»£ç ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;åœ¨æ’°å†™æœ¬æ–‡æ—¶ï¼Œå¼±åŒ…å°šæœªæ­£å¼å‘å¸ƒã€‚é¢„è®¡å°†åœ¨ Go 1.24 ä¸­è½åœ°ã€‚ä½†æˆ‘ä»¬å¯ä»¥å·çœ‹ä¸€ä¸‹æºä»£ç å¹¶å°è¯•ä¸€ä¸‹ã€‚è¯¥è½¯ä»¶åŒ…ä¸ºæ‚¨æä¾›äº†ä¸¤ä¸ªä¸»è¦çš„ APIï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;weak.Make&lt;/code&gt; ï¼šä»å¼ºæŒ‡é’ˆåˆ›å»ºå¼±æŒ‡é’ˆã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;weak.Pointer[T].Strong&lt;/code&gt; ï¼šå°†å¼±æŒ‡é’ˆè½¬æ¢å›å¼ºæŒ‡é’ˆã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kd&#34;&gt;type&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;T&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;struct&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;nx&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;nx&#34;&gt;b&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;nx&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;new&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;string&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;nb&#34;&gt;println&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;original:&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;c1&#34;&gt;// make a weak pointer
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;  &lt;span class=&#34;nx&#34;&gt;weakA&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;weak&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Make&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;nx&#34;&gt;runtime&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;GC&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;c1&#34;&gt;// use weakA
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;  &lt;span class=&#34;nx&#34;&gt;strongA&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;weakA&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Strong&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;nb&#34;&gt;println&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;strong:&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;strongA&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;nx&#34;&gt;runtime&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;GC&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;c1&#34;&gt;// use weakA again
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;  &lt;span class=&#34;nx&#34;&gt;strongA&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;weakA&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Strong&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;nb&#34;&gt;println&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;strong:&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;strongA&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// Output:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// original: 0x1400010c670
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// strong: 0x1400010c670 0x1400010c670
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// strong: 0x0
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;è¿™æ˜¯ä»£ç ä¸­å‘ç”Ÿçš„äº‹æƒ…ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;åœ¨ç¬¬ä¸€æ¬¡åƒåœ¾å›æ”¶ï¼ˆ &lt;code&gt;runtime.GC()&lt;/code&gt; ï¼‰ä¹‹åï¼Œå¼±æŒ‡é’ˆ&lt;code&gt;weakA&lt;/code&gt;ä»ç„¶æŒ‡å‘å†…å­˜ï¼Œå› ä¸ºæˆ‘ä»¬ä»åœ¨ä½¿ç”¨å˜é‡&lt;code&gt;a&lt;/code&gt; &lt;code&gt;println(&amp;quot;strong:&amp;quot;, strongA, a)&lt;/code&gt; çº¿ã€‚ç”±äºå†…å­˜æ­£åœ¨ä½¿ç”¨ä¸­ï¼Œå› æ­¤è¿˜æ— æ³•æ¸…ç†ã€‚&lt;/li&gt;
&lt;li&gt;ä½†æ˜¯å½“ç¬¬äºŒæ¬¡åƒåœ¾æ”¶é›†è¿è¡Œæ—¶ï¼Œå¼ºå¼•ç”¨ï¼ˆ &lt;code&gt;a&lt;/code&gt; ï¼‰ä¸å†ä½¿ç”¨ã€‚è¿™æ„å‘³ç€åƒåœ¾æ”¶é›†å™¨å¯ä»¥å®‰å…¨åœ°æ¸…ç†å†…å­˜ï¼Œè®©&lt;code&gt;weakA.Strong()&lt;/code&gt;è¿”å›&lt;code&gt;nil&lt;/code&gt; ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ç°åœ¨ï¼Œå¦‚æœæ‚¨å°è¯•ä½¿ç”¨&lt;code&gt;string&lt;/code&gt;æŒ‡é’ˆä»¥å¤–çš„å…¶ä»–å†…å®¹ï¼ˆä¾‹å¦‚&lt;code&gt;*int&lt;/code&gt; ã€ &lt;code&gt;*bool&lt;/code&gt;æˆ–å…¶ä»–ç±»å‹ï¼‰æ¥å°è¯•æ­¤ä»£ç ï¼Œæ‚¨å¯èƒ½ä¼šæ³¨æ„åˆ°ä¸åŒçš„è¡Œä¸ºï¼Œæœ€åä¸€ä¸ª&lt;code&gt;strong&lt;/code&gt;è¾“å‡ºå¯èƒ½ä¸æ˜¯&lt;code&gt;nil&lt;/code&gt; ã€‚&lt;/p&gt;
&lt;p&gt;è¿™ä¸ Go å¦‚ä½•å¤„ç†&lt;code&gt;int&lt;/code&gt; ã€ &lt;code&gt;bool&lt;/code&gt; ã€ &lt;code&gt;float32&lt;/code&gt; ã€ &lt;code&gt;float64&lt;/code&gt;ç­‰â€œå¾®å°å¯¹è±¡â€æœ‰å…³ã€‚è¿™äº›ç±»å‹è¢«åˆ†é…ä¸ºå¾®å°å¯¹è±¡ï¼Œå³ä½¿å®ƒä»¬åœ¨æŠ€æœ¯ä¸Šæœªä½¿ç”¨ï¼Œåƒåœ¾æ”¶é›†å™¨ä¹Ÿå¯èƒ½ä¸ä¼šç«‹å³æ¸…ç†å®ƒä»¬åœ¨åƒåœ¾æ”¶é›†æœŸé—´ã€‚è¦äº†è§£æ›´å¤šä¿¡æ¯ï¼Œæ‚¨å¯ä»¥æ›´æ·±å…¥åœ°ç ”ç©¶&lt;a class=&#34;link&#34; href=&#34;https://victoriametrics.com/blog/go-runtime-finalizer-keepalive&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Go Runtime Finalizer å’Œ Keep Alive&lt;/a&gt;ä¸­çš„å¾®å°å¯¹è±¡åˆ†é…ã€‚&lt;/p&gt;
&lt;p&gt;å¼±æŒ‡é’ˆå¯¹äºç‰¹å®šåœºæ™¯ä¸‹çš„å†…å­˜ç®¡ç†éå¸¸å®ç”¨ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä¾‹å¦‚ï¼Œå®ƒä»¬éå¸¸é€‚åˆè§„èŒƒåŒ–æ˜ å°„ - æ‚¨åªæƒ³ä¿ç•™ä¸€ä»½æ•°æ®çš„ä¸€ä»½å‰¯æœ¬çš„æƒ…å†µã€‚è¿™ä¸æˆ‘ä»¬ä¹‹å‰&lt;a class=&#34;link&#34; href=&#34;https://victoriametrics.com/blog/go-unique-package-intern-string&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;å…³äºå­—ç¬¦ä¸²é©»ç•™çš„è®¨è®º&lt;/a&gt;æœ‰å…³ã€‚&lt;/li&gt;
&lt;li&gt;å¦ä¸€ç§æƒ…å†µæ˜¯ï¼Œå½“æ‚¨å¸Œæœ›æŸäº›å†…å­˜çš„å¯¿å‘½ä¸å¦ä¸€ä¸ªå¯¹è±¡çš„å¯¿å‘½ç›¸åŒ¹é…æ—¶ï¼Œç±»ä¼¼äº JavaScript çš„ WeakMap çš„å·¥ä½œæ–¹å¼ã€‚ WeakMap å…è®¸å¯¹è±¡åœ¨ä¸å†ä½¿ç”¨æ—¶è‡ªåŠ¨æ¸…ç†ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å› æ­¤ï¼Œå¼±æŒ‡é’ˆçš„ä¸»è¦å¥½å¤„æ˜¯å®ƒä»¬å¯ä»¥è®©ä½ å‘Šè¯‰åƒåœ¾æ”¶é›†å™¨ï¼Œ *â€œå˜¿ï¼Œå¦‚æœæ²¡æœ‰äººä½¿ç”¨è¿™ä¸ªèµ„æºï¼Œå°±å¯ä»¥åˆ é™¤å®ƒâ€”â€”æˆ‘ä»¥åå¯ä»¥éšæ—¶é‡æ–°åˆ›å»ºå®ƒã€‚â€*è¿™å¯¹äºå ç”¨å¤§é‡å†…å­˜ä½†ä¸éœ€è¦ä¿ç•™çš„å¯¹è±¡éå¸¸æœ‰æ•ˆï¼Œé™¤éå®ƒä»¬æ­£åœ¨è¢«ç§¯æä½¿ç”¨ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;å¼±æŒ‡é’ˆå¦‚ä½•å·¥ä½œï¼Ÿ&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;æœ‰è¶£çš„æ˜¯ï¼Œå¼±æŒ‡é’ˆå®é™…ä¸Šå¹¶ä¸ç›´æ¥æŒ‡å‘å®ƒä»¬å¼•ç”¨çš„å†…å­˜ã€‚ç›¸åï¼Œå®ƒä»¬æ˜¯åŒ…å«â€œé—´æ¥å¯¹è±¡â€çš„ç®€å•ç»“æ„ï¼ˆä½¿ç”¨æ³›å‹ï¼‰ã€‚è¿™ä¸ªå¯¹è±¡å¾ˆå°ï¼Œåªæœ‰ 8 ä¸ªå­—èŠ‚ï¼Œå®ƒæŒ‡å‘å®é™…çš„å†…å­˜ç›®æ ‡ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kd&#34;&gt;type&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;Pointer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;T&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;any&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;struct&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;nx&#34;&gt;u&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;unsafe&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Pointer&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;http://img.golang.space/img-1734485576251.png&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;å¼±æŒ‡é’ˆé€šè¿‡é—´æ¥å¼•ç”¨å†…å­˜&#34;
	
	
&gt;&lt;/p&gt;
&lt;p&gt;ä¸ºä»€ä¹ˆè¦è¿™æ ·è®¾è®¡å‘¢ï¼Ÿ&lt;/p&gt;
&lt;p&gt;æ­¤è®¾ç½®ä½¿åƒåœ¾æ”¶é›†å™¨å¯ä»¥é«˜æ•ˆåœ°ä¸€æ¬¡æ€§æ¸…ç†æŒ‡å‘ç‰¹å®šå¯¹è±¡çš„å¼±æŒ‡é’ˆã€‚å½“å®ƒå†³å®šåº”è¯¥é‡Šæ”¾å†…å­˜æ—¶ï¼Œæ”¶é›†å™¨åªéœ€å°†é—´æ¥å¯¹è±¡ä¸­çš„æŒ‡é’ˆè®¾ç½®ä¸º&lt;code&gt;nil&lt;/code&gt; ï¼ˆæˆ–&lt;code&gt;0x0&lt;/code&gt; ï¼‰ã€‚å®ƒä¸å¿…å•ç‹¬æ›´æ–°æ¯ä¸ªå¼±æŒ‡é’ˆã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://img.golang.space/img-1734485968905.png&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;GCå›æ”¶å†…å­˜ï¼Œæ›´æ–°å¼±æŒ‡é’ˆé“¾æ¥&#34;
	
	
&gt;&lt;/p&gt;
&lt;p&gt;æœ€é‡è¦çš„æ˜¯ï¼Œè¿™ä¸ªè®¾è®¡æ”¯æŒç›¸ç­‰æ£€æŸ¥ï¼ˆ &lt;code&gt;==&lt;/code&gt; ï¼‰ã€‚ä»åŒä¸€åŸå§‹æŒ‡é’ˆåˆ›å»ºçš„å¼±æŒ‡é’ˆå°†è¢«è§†ä¸ºâ€œç›¸ç­‰â€ï¼Œå³ä½¿å®ƒä»¬æŒ‡å‘çš„å¯¹è±¡å·²è¢«åƒåœ¾å›æ”¶ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;nx&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;new&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;string&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;c1&#34;&gt;// make a weak pointers
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;nx&#34;&gt;weakA&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;weak&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Make&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;nx&#34;&gt;weakA2&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;weak&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Make&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;nb&#34;&gt;println&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;Before GC - Equality check:&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;weakA&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;weakA2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;nx&#34;&gt;runtime&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;GC&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;c1&#34;&gt;// Test their equality
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;nb&#34;&gt;println&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;After GC - Strong:&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;weakA&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Strong&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(),&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;weakA2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Strong&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;())&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;nb&#34;&gt;println&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;After GC - Equality check:&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;weakA&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;weakA2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// Before GC - Equality check: true
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// After GC - Strong: 0x0 0x0
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// After GC - Equality check: true
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;è¿™æ˜¯å¯è¡Œçš„ï¼Œå› ä¸ºæ¥è‡ªåŒä¸€åŸå§‹å¯¹è±¡çš„å¼±æŒ‡é’ˆå…±äº«ç›¸åŒçš„é—´æ¥å¯¹è±¡ã€‚å½“æ‚¨è°ƒç”¨&lt;code&gt;weak.Make&lt;/code&gt;æ—¶ï¼Œå¦‚æœä¸€ä¸ªå¯¹è±¡å·²ç»æœ‰ä¸€ä¸ªä¸ä¹‹å…³è”çš„å¼±æŒ‡é’ˆï¼Œåˆ™ç°æœ‰çš„é—´æ¥å¯¹è±¡å°†è¢«é‡ç”¨ï¼Œè€Œä¸æ˜¯åˆ›å»ºä¸€ä¸ªæ–°çš„ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ç­‰ç­‰ï¼Œä½¿ç”¨ 8 ä¸ªå­—èŠ‚ä½œä¸ºé—´æ¥å¯¹è±¡ä¸æ˜¯æœ‰ç‚¹æµªè´¹å—ï¼Ÿ&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;çœ‹èµ·æ¥å¥½åƒæ˜¯è¿™æ ·ï¼Œä½†ä½œè€…ä¼šè¯´ï¼Œè¿™å¹¶ä¸æ˜¯ä»€ä¹ˆå¤§é—®é¢˜ã€‚å¼±æŒ‡é’ˆé€šå¸¸ç”¨äºæ€»ä½“ç›®æ ‡æ˜¯èŠ‚çœå†…å­˜çš„æƒ…å†µã€‚ä¾‹å¦‚ï¼Œåœ¨è§„èŒƒåŒ–æ˜ å°„ä¸­ï¼ˆé€šè¿‡ä»…ä¿ç•™æ¯ä¸ªå”¯ä¸€æ•°æ®çš„ä¸€ä»½å‰¯æœ¬æ¥æ¶ˆé™¤é‡å¤é¡¹ï¼‰ï¼Œæ‚¨å·²ç»é€šè¿‡é¿å…å†—ä½™èŠ‚çœäº†å¤§é‡å†…å­˜ã€‚&lt;/p&gt;
&lt;p&gt;ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœæ‚¨å­˜åœ¨å¤§é‡å”¯ä¸€é¡¹å’Œå¾ˆå°‘é‡å¤é¡¹çš„æƒ…å†µä¸‹ä½¿ç”¨å¼±æŒ‡é’ˆï¼Œåˆ™æœ€ç»ˆå¯èƒ½ä¼šä½¿ç”¨æ¯”é¢„æœŸæ›´å¤šçš„å†…å­˜ã€‚å› æ­¤ï¼Œåœ¨å†³å®šå¼±æŒ‡é’ˆæ˜¯å¦æ˜¯é€‚åˆè¯¥å·¥ä½œçš„å·¥å…·æ—¶ï¼Œè€ƒè™‘å…·ä½“ç”¨ä¾‹éå¸¸é‡è¦ã€‚&lt;/p&gt;
&lt;h2 id=&#34;å‚è€ƒ&#34;&gt;å‚è€ƒ&lt;/h2&gt;
&lt;p&gt;æœ¬æ–‡ç¿»è¯‘äº &lt;a class=&#34;link&#34; href=&#34;https://victoriametrics.com/blog/go-weak-pointer/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Weak Pointers in Go: Why They Matter Now&lt;/a&gt;&lt;/p&gt;
</description>
        </item>
        <item>
        <title>ä¸è¦åœ¨å¯å†™æ–‡ä»¶ä¸Šå»¶è¿Ÿ Close</title>
        <link>https://blog.golang.space/p/%E4%B8%8D%E8%A6%81%E5%9C%A8%E5%8F%AF%E5%86%99%E6%96%87%E4%BB%B6%E4%B8%8A%E5%BB%B6%E8%BF%9F-close/</link>
        <pubDate>Tue, 17 Sep 2024 00:00:00 +0000</pubDate>
        
        <guid>https://blog.golang.space/p/%E4%B8%8D%E8%A6%81%E5%9C%A8%E5%8F%AF%E5%86%99%E6%96%87%E4%BB%B6%E4%B8%8A%E5%BB%B6%E8%BF%9F-close/</guid>
        <description>&lt;p&gt;å¯¹äº Go ç¨‹åºå‘˜æ¥è¯´ï¼Œè¿™æ˜¯ä¸€ä¸ªå¾ˆå¿«å°±ä¼šæ­»è®°ç¡¬èƒŒçš„ä¹ æƒ¯ç”¨æ³•ï¼šæ¯å½“ä½ æƒ³å‡ºä¸€ä¸ªå®ç°&lt;code&gt;io.Closer&lt;/code&gt;æ¥å£çš„å€¼æ—¶ï¼Œåœ¨æ£€æŸ¥é”™è¯¯åï¼Œä½ ä¼šç«‹å³&lt;code&gt;defer&lt;/code&gt;å…¶&lt;code&gt;Close()&lt;/code&gt;æ–¹æ³•ã€‚åœ¨å‘å‡º HTTP è¯·æ±‚æ—¶æœ€å¸¸çœ‹åˆ°è¿™ç§æƒ…å†µï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;resp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;http&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Get&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;https://joeshaw.org&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!=&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;nil&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;defer&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;resp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Body&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Close&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;æˆ–æ‰“å¼€æ–‡ä»¶ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;os&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Open&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;/home/joeshaw/notes.txt&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!=&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;nil&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;defer&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Close&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;ä½†è¿™ç§ä¹ æƒ¯ç”¨æ³•å®é™…ä¸Šå¯¹å¯å†™æ–‡ä»¶æœ‰å®³ï¼Œå› ä¸ºå»¶è¿Ÿå‡½æ•°è°ƒç”¨ä¼šå¿½ç•¥å…¶è¿”å›å€¼ï¼Œå¹¶ä¸”&lt;code&gt;Close()&lt;/code&gt;æ–¹æ³•å¯èƒ½ä¼šè¿”å›é”™è¯¯ã€‚&lt;strong&gt;å¯¹äºå¯å†™æ–‡ä»¶ï¼ŒGo ç¨‹åºå‘˜åº”è¯¥é¿å…&lt;code&gt;defer&lt;/code&gt;ä¹ æƒ¯ç”¨æ³•ï¼Œå¦åˆ™ä¼šå‡ºç°éå¸¸ç½•è§çš„ä»¤äººæŠ“ç‹‚çš„é”™è¯¯ã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ä¸ºä»€ä¹ˆæ‚¨ä¼šä»&lt;code&gt;Close()&lt;/code&gt;ä¸­æ”¶åˆ°é”™è¯¯ï¼Œä½†åœ¨ä¹‹å‰çš„&lt;code&gt;Write()&lt;/code&gt;è°ƒç”¨ä¸­å´æ²¡æœ‰æ”¶åˆ°é”™è¯¯ï¼Ÿä¸ºäº†å›ç­”è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦è¡¥å……ä¸€ä¸‹è®¡ç®—æœºä½“ç³»ç»“æ„é¢†åŸŸçŸ¥è¯†ã€‚&lt;/p&gt;
&lt;p&gt;ä¸€èˆ¬æ¥è¯´ï¼Œå½“ä½ ä» CPU å‘å¤–ç§»åŠ¨æ—¶ï¼Œæ“ä½œçš„é€Ÿåº¦ä¼šå˜å¾—æ…¢å‡ ä¸ªæ•°é‡çº§ã€‚å†™å…¥ CPU å¯„å­˜å™¨éå¸¸å¿«ã€‚è®¿é—®ç³»ç»Ÿ RAM ç›¸å¯¹è¾ƒæ…¢ã€‚è¿›è¡Œç£ç›˜æˆ–ç½‘ç»œ I/O åˆ™æ…¢å¾—å¤šã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœæ¯ä¸ª&lt;code&gt;Write()&lt;/code&gt;è°ƒç”¨éƒ½å°†æ•°æ®åŒæ­¥æäº¤åˆ°ç£ç›˜ï¼Œæˆ‘ä»¬ç³»ç»Ÿçš„æ€§èƒ½å°†ä¼šæ…¢å¾—æ— æ³•ä½¿ç”¨ã€‚è™½ç„¶åŒæ­¥å†™å…¥å¯¹äºæŸäº›ç±»å‹çš„è½¯ä»¶ï¼ˆä¾‹å¦‚æ•°æ®åº“ï¼‰éå¸¸é‡è¦ï¼Œä½†å¤§å¤šæ•°æ—¶å€™å®ƒæ˜¯å¤šä½™çš„ã€‚&lt;/p&gt;
&lt;p&gt;æœ€ç³Ÿç³•çš„æƒ…å†µæ˜¯ä¸€æ¬¡å†™å…¥ä¸€ä¸ªå­—èŠ‚åˆ°æ–‡ä»¶ä¸­ã€‚ç¡¬ç›˜é©±åŠ¨å™¨â€”â€”ç²—æš´çš„æœºæ¢°è®¾å¤‡â€”â€”éœ€è¦å°†ç£å¤´ç‰©ç†ç§»åŠ¨åˆ°ç›˜ç‰‡ä¸Šçš„ä½ç½®ï¼Œå¹¶å¯èƒ½éœ€è¦ç­‰å¾…æ•´ç›˜çš„æ—‹è½¬æ‰èƒ½å°†æ•°æ®æŒä¹…åŒ–ã€‚å›ºæ€ç¡¬ç›˜ï¼ˆSSDï¼‰ï¼Œå®ƒä»¬ä»¥å—çš„å½¢å¼å­˜å‚¨æ•°æ®ï¼Œå¹¶ä¸”æ¯ä¸ªå—çš„å†™å…¥å‘¨æœŸæ˜¯æœ‰é™çš„ï¼Œä¼šå› ä¸ºå—è¢«åå¤å†™å…¥å’Œè¦†ç›–è€Œè¿…é€Ÿç£¨æŸã€‚&lt;/p&gt;
&lt;p&gt;å¹¸è¿çš„æ˜¯ï¼Œè¿™ç§æƒ…å†µä¸ä¼šå‘ç”Ÿï¼Œå› ä¸ºç¡¬ä»¶å’Œè½¯ä»¶çš„å¤šä¸ªå±‚æ¬¡å®ç°äº†ç¼“å­˜å’Œå†™å…¥ç¼“å†²ã€‚å½“ä½ è°ƒç”¨ Write() æ—¶ï¼Œæ•°æ®ä¸ä¼šç«‹å³è¢«å†™å…¥åˆ°ä»‹è´¨ä¸Šã€‚æ“ä½œç³»ç»Ÿã€å­˜å‚¨æ§åˆ¶å™¨å’Œä»‹è´¨æœ¬èº«éƒ½åœ¨ç¼“å­˜æ•°æ®ï¼Œä»¥ä¾¿å°†è¾ƒå°çš„å†™å…¥æ“ä½œæ‰¹é‡å¤„ç†ï¼Œä¼˜åŒ–æ•°æ®åœ¨ä»‹è´¨ä¸Šçš„å­˜å‚¨ï¼Œå¹¶å†³å®šä½•æ—¶æœ€ä½³åœ°æäº¤æ•°æ®ã€‚è¿™å°†æˆ‘ä»¬çš„å†™å…¥æ“ä½œä»ç¼“æ…¢çš„ã€é˜»å¡çš„åŒæ­¥æ“ä½œè½¬å˜ä¸ºå¿«é€Ÿçš„ã€å¼‚æ­¥çš„æ“ä½œï¼Œè¿™äº›æ“ä½œä¸ä¼šç›´æ¥è§¦åŠæ›´æ…¢çš„ I/O è®¾å¤‡ã€‚ä¸€æ¬¡å†™å…¥ä¸€ä¸ªå­—èŠ‚ä»æ¥ä¸æ˜¯æœ€æœ‰æ•ˆçš„åšæ³•ï¼Œä½†è‡³å°‘æˆ‘ä»¬ä¸ä¼šå› ä¸ºè¿™æ ·åšè€Œè€—æŸç¡¬ä»¶ã€‚&lt;/p&gt;
&lt;p&gt;å½“ç„¶ï¼Œè¿™äº›å­—èŠ‚æœ€ç»ˆå¿…é¡»è¢«å†™å…¥ç£ç›˜ã€‚æ“ä½œç³»ç»ŸçŸ¥é“å½“æˆ‘ä»¬å…³é—­ä¸€ä¸ªæ–‡ä»¶æ—¶ï¼Œæˆ‘ä»¬å·²ç»å®Œæˆäº†å¯¹å®ƒçš„æ“ä½œï¼Œä¸ä¼šæœ‰åç»­çš„å†™å…¥æ“ä½œå‘ç”Ÿã€‚å®ƒè¿˜çŸ¥é“å…³é—­æ–‡ä»¶æ˜¯å®ƒæœ€åä¸€æ¬¡å‘Šè¯‰æˆ‘ä»¬æ˜¯å¦å‡ºç°äº†é—®é¢˜çš„æœºä¼šã€‚&lt;/p&gt;
&lt;p&gt;åœ¨ Linux å’Œ macOS ç­‰ POSIX ç³»ç»Ÿä¸Šï¼Œå…³é—­æ–‡ä»¶æ˜¯é€šè¿‡&lt;code&gt;close&lt;/code&gt;ç³»ç»Ÿè°ƒç”¨æ¥å¤„ç†çš„ã€‚ &lt;code&gt;close(2)&lt;/code&gt;çš„ BSD æ‰‹å†Œé¡µè®¨è®ºäº†å®ƒå¯èƒ½è¿”å›çš„é”™è¯¯ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;9
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;ERRORS
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;     The close&lt;span class=&#34;o&#34;&gt;()&lt;/span&gt; system call will fail &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;     &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;EBADF&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;            fildes is not a valid, active file descriptor.
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;     &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;EINTR&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;            Its execution was interrupted by a signal.
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;     &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;EIO&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;              A previously-uncommitted write&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;2&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; encountered an input/output
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;                        error.
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;EIO æ­£æ˜¯æˆ‘ä»¬æ‹…å¿ƒçš„é”™è¯¯ã€‚è¿™æ„å‘³ç€æˆ‘ä»¬åœ¨å°è¯•å°†æ•°æ®ä¿å­˜åˆ°ç£ç›˜æ—¶ä¸¢å¤±äº†æ•°æ®ï¼Œæˆ‘ä»¬çš„ Go ç¨‹åºåœ¨è¿™ç§æƒ…å†µä¸‹ç»å¯¹ä¸åº”è¿”å› nil é”™è¯¯ã€‚&lt;/p&gt;
&lt;p&gt;è§£å†³è¿™ä¸ªé—®é¢˜æœ€ç®€å•çš„æ–¹æ³•å°±æ˜¯åœ¨å†™å…¥æ–‡ä»¶æ—¶ä¸ä½¿ç”¨&lt;code&gt;defer&lt;/code&gt; ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;helloNotes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;error&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nx&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;os&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Create&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;/home/joeshaw/notes.txt&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!=&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;nil&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;WriteString&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;hello world&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!=&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;nil&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nx&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Close&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Close&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;è¿™ç¡®å®æ„å‘³ç€åœ¨å‡ºç°é”™è¯¯æ—¶éœ€è¦å¯¹æ–‡ä»¶è¿›è¡Œé¢å¤–çš„è®°å½•ï¼šåœ¨&lt;code&gt;io.WriteString()&lt;/code&gt;å¤±è´¥çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¿…é¡»æ˜¾å¼å…³é—­å®ƒï¼ˆå¹¶å¿½ç•¥å®ƒçš„é”™è¯¯ï¼Œå› ä¸ºå†™å…¥é”™è¯¯ä¼˜å…ˆï¼‰ã€‚ä½†å®ƒå¾ˆæ¸…æ™°ã€ç›´æ¥ï¼Œå¹¶ä¸”å¯ä»¥æ­£ç¡®æ£€æŸ¥&lt;code&gt;f.Close()&lt;/code&gt;è°ƒç”¨ä¸­çš„é”™è¯¯ã€‚&lt;/p&gt;
&lt;p&gt;&lt;em&gt;æœ‰&lt;/em&gt;ä¸€ç§æ–¹æ³•å¯ä»¥é€šè¿‡ä½¿ç”¨å‘½åè¿”å›å€¼å’Œé—­åŒ…&lt;code&gt;defer&lt;/code&gt;å¤„ç†è¿™ç§æƒ…å†µï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;helloNotes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;error&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;kd&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;f&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;os&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;File&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nx&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;os&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Create&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;/home/joeshaw/notes.txt&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!=&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;nil&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;defer&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nx&#34;&gt;cerr&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Close&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;nil&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;cerr&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;}()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;WriteString&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;hello world&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;æ­¤æ¨¡å¼çš„ä¸»è¦å¥½å¤„æ˜¯ä¸å¯èƒ½å¿˜è®°å…³é—­æ–‡ä»¶ï¼Œå› ä¸ºå»¶è¿Ÿå…³é—­å§‹ç»ˆä¼šæ‰§è¡Œã€‚åœ¨å…·æœ‰æ›´å¤š&lt;code&gt;if err != nil&lt;/code&gt;æ¡ä»¶åˆ†æ”¯çš„è¾ƒé•¿å‡½æ•°ä¸­ï¼Œæ­¤æ¨¡å¼è¿˜å¯ä»¥å‡å°‘ä»£ç è¡Œæ•°å’Œé‡å¤æ¬¡æ•°ã€‚&lt;/p&gt;
&lt;p&gt;å°½ç®¡å¦‚æ­¤ï¼Œæˆ‘è¿˜æ˜¯è§‰å¾—è¿™ç§æ¨¡å¼æœ‰ç‚¹é­”æ³•äº†ã€‚æˆ‘ä¸å–œæ¬¢ä½¿ç”¨å‘½åè¿”å›å€¼ï¼Œå¹¶ä¸”å³ä½¿å¯¹äºç»éªŒä¸°å¯Œçš„ Go ç¨‹åºå‘˜æ¥è¯´ï¼Œåœ¨æ ¸å¿ƒå‡½æ•°å®Œæˆåä¿®æ”¹è¿”å›å€¼ä¹Ÿä¸æ˜¯ç›´è§‚ä¸Šæ¸…æ¥šçš„ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘æ„¿æ„æ¥å—æ›´å…·å¯è¯»æ€§å’Œæ˜“äºç†è§£çš„ä»£ç çš„æƒè¡¡ï¼Œå› ä¸ºéœ€è¦ä¸æ–­åœ°å®¡æŸ¥ä»£ç ä»¥ç¡®ä¿æ–‡ä»¶åœ¨æ‰€æœ‰æƒ…å†µä¸‹éƒ½å·²å…³é—­ï¼Œè¿™å°±æ˜¯æˆ‘åœ¨å‘å…¶ä»–äººæä¾›çš„ä»£ç å®¡æŸ¥ä¸­æ¨èçš„æ–¹æ³•ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;æ›´æ–° 1&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://twitter.com/benbjohnson/status/874286396411961345&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Ben Johnson åœ¨ Twitter ä¸Šå»ºè®®&lt;/a&gt;ï¼Œå¯¹æ–‡ä»¶å¤šæ¬¡è¿è¡Œ&lt;code&gt;Close()&lt;/code&gt;å¯èƒ½æ˜¯å®‰å…¨çš„ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;doSomething&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;error&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nx&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;os&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Create&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;foo&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!=&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;nil&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;defer&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Close&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;_&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Write&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;([]&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;byte&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;bar&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!=&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;nil&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Close&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;code&gt;io.Closer&lt;/code&gt;ä¸Šçš„ Go æ–‡æ¡£&lt;a class=&#34;link&#34; href=&#34;https://golang.org/pkg/io/#Closer&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;æ˜ç¡®æŒ‡å‡º&lt;/a&gt;ï¼Œåœ¨ç¬¬ä¸€æ¬¡è°ƒç”¨åçš„æ¥å£çº§åˆ«è¡Œä¸ºæ˜¯æœªæŒ‡å®šçš„ï¼Œä½†ç‰¹å®šçš„å®ç°å¯èƒ½ä¼šè®°å½•å…¶è‡ªå·±çš„è¡Œä¸ºã€‚&lt;/p&gt;
&lt;p&gt;ä¸å¹¸çš„æ˜¯ï¼Œ &lt;code&gt;*os.File&lt;/code&gt;çš„æ–‡æ¡£&lt;a class=&#34;link&#34; href=&#34;https://golang.org/pkg/os/#File.Close&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;å¹¶ä¸æ¸…æ¥š&lt;/a&gt;å®ƒçš„è¡Œä¸ºï¼Œåªæ˜¯è¯´ï¼Œâ€œClose å…³é—­æ–‡ä»¶ï¼Œä½¿å…¶æ— æ³•ç”¨äº I/Oã€‚å¦‚æœæœ‰çš„è¯ï¼Œå®ƒä¼šè¿”å›ä¸€ä¸ªé”™è¯¯ã€‚â€ç„¶è€Œï¼Œä» 1.8 å¼€å§‹çš„å®ç°æ˜¾ç¤ºï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;f&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;File&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;Close&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;error&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;f&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;nil&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;ErrInvalid&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;file&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;close&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;file&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;file&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;close&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;error&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;file&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;nil&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;||&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;file&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;fd&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;badFd&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;syscall&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;EINVAL&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;kd&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;error&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;e&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;syscall&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Close&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;file&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;fd&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;e&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!=&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;nil&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;PathError&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;close&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;file&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;e&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nx&#34;&gt;file&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;fd&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// so it can&amp;#39;t be closed again
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;// no need for a finalizer anymore
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;nx&#34;&gt;runtime&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;SetFinalizer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;file&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;nil&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;ä¸ºäº†æ¸…æ¥šèµ·è§ï¼Œ &lt;code&gt;badFd&lt;/code&gt;è¢«å®šä¹‰ä¸º -1 ï¼Œå› æ­¤éšåå°è¯•å…³é—­&lt;code&gt;*os.File&lt;/code&gt;å°†ä¸ä¼šæ‰§è¡Œä»»ä½•æ“ä½œå¹¶è¿”å›&lt;code&gt;syscall.EINVAL&lt;/code&gt; ã€‚ä½†ç”±äºæˆ‘ä»¬å¿½ç•¥äº†&lt;code&gt;defer&lt;/code&gt;çš„é”™è¯¯ï¼Œæ‰€ä»¥è¿™å¹¶ä¸é‡è¦ã€‚ç¡®åˆ‡åœ°è¯´ï¼Œå®ƒä¸æ˜¯å¹‚ç­‰çš„ï¼Œä½†æ­£å¦‚ Ben åæ¥åœ¨ Twitter å¸–å­ä¸­æ‰€è¯´çš„é‚£æ ·ï¼Œ &lt;a class=&#34;link&#34; href=&#34;https://twitter.com/benbjohnson/status/874289044800368640&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;â€œwonâ€™t blow shit up if you call it twice.â€&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;æ›´æ–° 2&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;å…³é—­æ–‡ä»¶æ˜¯æ“ä½œç³»ç»Ÿå‘Šè¯‰æˆ‘ä»¬é—®é¢˜çš„æœ€åæœºä¼šï¼Œä½†å…³é—­æ–‡ä»¶æ—¶ç¼“å†²åŒºä¸ä¸€å®šä¼šè¢«åˆ·æ–°ã€‚å…³é—­æ–‡ä»¶&lt;em&gt;å&lt;/em&gt;å®Œå…¨æœ‰å¯èƒ½å°†å†™å…¥ç¼“å†²åŒºåˆ·æ–°åˆ°ç£ç›˜ï¼Œå¹¶ä¸”æ— æ³•æ•è·å…¶ä¸­çš„æ•…éšœã€‚å¦‚æœå‘ç”Ÿè¿™ç§æƒ…å†µï¼Œé€šå¸¸æ„å‘³ç€å‡ºç°ä¸¥é‡é”™è¯¯ï¼Œä¾‹å¦‚ç£ç›˜å‡ºç°æ•…éšœã€‚&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨&lt;code&gt;*os.File&lt;/code&gt;ä¸Šçš„&lt;code&gt;Sync()&lt;/code&gt;æ–¹æ³•å¼ºåˆ¶å†™å…¥ç£ç›˜ï¼Œè¯¥æ–¹æ³•è°ƒç”¨&lt;code&gt;fsync&lt;/code&gt;ç³»ç»Ÿè°ƒç”¨ã€‚æ‚¨åº”è¯¥æ£€æŸ¥è¯¥è°ƒç”¨ä¸­çš„é”™è¯¯ï¼Œä½†æˆ‘è®¤ä¸ºå¿½ç•¥&lt;code&gt;Close()&lt;/code&gt;ä¸­çš„é”™è¯¯æ˜¯å®‰å…¨çš„ã€‚è°ƒç”¨&lt;code&gt;fsync&lt;/code&gt;å¯¹æ€§èƒ½æœ‰ä¸¥é‡å½±å“ï¼šå®ƒå°†å†™å…¥ç¼“å†²åŒºåˆ·æ–°åˆ°é€Ÿåº¦è¾ƒæ…¢çš„ç£ç›˜ã€‚ä½†å¦‚æœæ‚¨çœŸçš„éå¸¸æƒ³è¦å°†æ•°æ®å­˜å‚¨åœ¨ç£ç›˜ä¸Šï¼Œé‚£ä¹ˆæœ€å¥½éµå¾ªçš„æ¨¡å¼å¯èƒ½æ˜¯ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;helloNotes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;error&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nx&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;os&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Create&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;/home/joeshaw/notes.txt&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!=&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;nil&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;defer&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Close&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;WriteString&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;hello world&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!=&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;nil&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Sync&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;</description>
        </item>
        <item>
        <title>æŒ‡é’ˆä¸­çš„éšæœºå€¼</title>
        <link>https://blog.golang.space/p/%E6%8C%87%E9%92%88%E4%B8%AD%E7%9A%84%E9%9A%8F%E6%9C%BA%E5%80%BC/</link>
        <pubDate>Mon, 16 Sep 2024 00:00:00 +0000</pubDate>
        
        <guid>https://blog.golang.space/p/%E6%8C%87%E9%92%88%E4%B8%AD%E7%9A%84%E9%9A%8F%E6%9C%BA%E5%80%BC/</guid>
        <description>&lt;h2 id=&#34;è ¢èŒçš„æ­»æ³•-æŒ‡é’ˆä¸­çš„éšæœºå€¼&#34;&gt;è ¢èŒçš„æ­»æ³•: æŒ‡é’ˆä¸­çš„éšæœºå€¼&lt;/h2&gt;
&lt;p&gt;æœ€è¿‘æœ‰äººæå‡ºã€Œæ˜¯å¦å¯ä»¥å°†éæŒ‡é’ˆæ”¾å…¥ unsafe.Pointer å˜é‡ã€çš„é—®é¢˜ã€‚æ™®éçš„ååº”æ˜¯ã€ŒNOï¼Œè¿™æ˜¯ä¸€ä¸ªåä¸»æ„ã€ã€‚æˆ‘åŒæ„ï¼Œä½†å¦‚æœæˆ‘ä»¬ä»ä¸æ¢ç´¢ç³Ÿç³•çš„æƒ³æ³•ï¼Œæ°¸è¿œä¸ä¼š&amp;hellip;å—¯ï¼Œå®é™…ä¸Šï¼Œå¦‚æœä»ä¸æ¢ç´¢ç³Ÿç³•çš„æƒ³æ³•ï¼Œç»å¯¹ä¸ä¼šå‡ºé—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;è®©æˆ‘ä»¬æ¢è®¨ä¸€ä¸‹è¿™ä¸ª Bad idea&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ä¸ºä»€ä¹ˆæ˜¯åä¸»æ„? ä¸»è¦æ˜¯å¯èƒ½æ˜¯ä¼šè®© Go çš„åƒåœ¾æ”¶é›†å™¨å´©æºƒã€‚Go GC ä¼šæŸ¥çœ‹ç¨‹åºå¯è§çš„æ¯ä¸ªæŒ‡é’ˆï¼Œä»¥æŸ¥çœ‹å“ªäº›å†…å­˜ä»åœ¨ä½¿ç”¨ï¼Œä»¥åŠå“ªäº›å†…å­˜å¯ä»¥é‡Šæ”¾ã€‚å¦‚æœå®ƒè·Ÿéšçš„æŒ‡é’ˆæœªæŒ‡å‘æœ‰æ•ˆçš„å†…å­˜åœ°å€ï¼Œåˆ™å¯èƒ½ä¼šå´©æºƒã€‚&lt;/p&gt;
&lt;p&gt;è®©æˆ‘ä»¬å°è¯•ä¸€ä¸‹ï¼Œåˆ†é…åäº¿ä¸ª unsafe.Pointers å¹¶å°†ä»–ä»¬å…¨éƒ¨è®¾ç½®ä¸ºæ— æ•ˆæŒ‡é’ˆçš„å€¼ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;TestRandomUnsafePointers&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;t&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;testing&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;T&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;nx&#34;&gt;x&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;make&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;([]&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;unsafe&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Pointer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mf&#34;&gt;1e9&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;range&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;x&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;c1&#34;&gt;// Possible misuse of unsafe.Pointer? Definite misuse of unsafe.Pointer!
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;		&lt;span class=&#34;nx&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;unsafe&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Pointer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;uintptr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;8&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;nx&#34;&gt;runtime&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;GC&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nx&#34;&gt;runtime&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;KeepAlive&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;æ­¤ä»£ç åˆ›å»ºä¸€ä¸ªåŒ…å« 10 äº¿ä¸ª&lt;code&gt;unsafe.Pointer&lt;/code&gt;çš„åˆ‡ç‰‡ï¼Œç„¶åå¼ºåˆ¶ GC è¿è¡Œã€‚å®ƒä¸ä¼šå´©æºƒã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å¯ä»¥ç”¨çœŸæ­£çš„éšæœºå€¼å†è¯•ä¸€æ¬¡ï¼Œå¹¶ä¸”åšä¸€äº›å‚»äº‹ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;TestRandomUnsafePointers2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;t&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;testing&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;T&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;nx&#34;&gt;x&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;make&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;([]&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;unsafe&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Pointer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mf&#34;&gt;1e9&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;range&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;x&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;c1&#34;&gt;// Possible misuse of unsafe.Pointer? Definite misuse of unsafe.Pointer!
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;		&lt;span class=&#34;nx&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;unsafe&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Pointer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;uintptr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;rand&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Int64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;nx&#34;&gt;runtime&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;GC&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;range&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;10&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;range&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;x&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;			&lt;span class=&#34;c1&#34;&gt;// Possible misuse of unsafe.Pointer? Definite misuse of unsafe.Pointer!
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;			&lt;span class=&#34;nx&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;unsafe&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Add&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;nx&#34;&gt;runtime&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;GC&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nx&#34;&gt;runtime&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;KeepAlive&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;ä»æ—§æœªå´©æºƒã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;å¦‚æœæˆ‘ä»¬ä¸å¤Ÿèªæ˜æ€ä¹ˆåŠï¼Ÿ&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Go å¯èƒ½ä¼šæŸ¥çœ‹è¿™äº›å€¼å¹¶æ€è€ƒã€Œå•Šå˜ã€ï¼Œç„¶åå¿½ç•¥ä»–ã€‚ Go å¯ä»¥ä¸ C äº¤äº’ï¼Œå› æ­¤å®ƒéœ€è¦èƒ½å¤Ÿå¤„ç†åœ¨å…¶æ§åˆ¶ä¹‹å¤–åˆ†é…çš„å†…å­˜ã€‚å¤šå¹´æ¥ï¼Œæˆ‘è¿˜ä½¿ç”¨ Go ç›´æ¥é€šè¿‡ç³»ç»Ÿè°ƒç”¨åˆ†é…çš„å†…å­˜ï¼Œæ²¡æœ‰ä»»ä½•é—®é¢˜ï¼ˆç¥ˆç¥·ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœæŒ‡é’ˆçš„å€¼çœ‹èµ·æ¥åƒå®ƒåº”è¯¥å…³å¿ƒçš„å†…å­˜ï¼ŒGo å¯èƒ½ä¼šå‘ç°å®ƒæ›´å›°éš¾ã€‚å¦‚æœæˆ‘ä»¬å­˜å‚¨çš„å€¼æ›¾ç»æ˜¯ Go æœ¬èº«åˆ†é…çš„æœ‰æ•ˆå†…å­˜åœ°å€ï¼Œä½†æˆ‘ä»¬çŸ¥é“å®ƒä¸å†æœ‰æ•ˆæ€ä¹ˆåŠï¼Ÿ&lt;/p&gt;
&lt;p&gt;è¿™é‡Œæˆ‘ä»¬åˆ†é…ä¸€ä¸ªè¶³å¤Ÿå¤§çš„åˆ‡ç‰‡ï¼Œä»¥ä¾¿å§‹ç»ˆåˆ†é…åœ¨å †ä¸Šã€‚ç„¶åï¼Œæˆ‘ä»¬è·å–æ”¯æŒè¯¥åˆ‡ç‰‡çš„æ•°ç»„çš„åœ°å€ï¼Œå¹¶å°†å…¶æ”¾å…¥ uintptr ä¸­ã€‚æˆ‘ä»¬çŸ¥é“ Go ä¸ä¼šå°† uintptr è§†ä¸ºæŒ‡é’ˆï¼Œå› æ­¤å°†å€¼ä¿å­˜åœ¨ uintptr ä¸­ä¸åº”å¯¼è‡´ Go ä¿ç•™åˆ†é…ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœæˆ‘ä»¬éšååˆ é™¤å¯¹åˆ‡ç‰‡çš„å¼•ç”¨å¹¶å¼ºåˆ¶æ‰§è¡Œ GCï¼Œåˆ™åº”è¯¥é‡Šæ”¾å†…å­˜ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;y&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;make&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;([]&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mf&#34;&gt;1e4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;yptr&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;uintptr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;unsafe&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Pointer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;unsafe&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;SliceData&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;y&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;y&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;nil&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;runtime&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;GC&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;ç°åœ¨ï¼Œå¦‚æœæˆ‘ä»¬å°†æ­¤å€¼å­˜å‚¨åœ¨&lt;code&gt;unsafe.Pointer&lt;/code&gt;ä¸­å¹¶å†æ¬¡è¿è¡Œ GCï¼Œæˆ‘ä»¬å¯èƒ½ä¼šé‡åˆ°éº»çƒ¦ã€‚è¿™æ˜¯å®Œæ•´çš„æµ‹è¯•ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;TestUnsafePointerBadNumber&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;t&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;testing&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;T&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;nx&#34;&gt;y&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;make&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;([]&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mf&#34;&gt;1e4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;nx&#34;&gt;yptr&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;uintptr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;unsafe&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Pointer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;unsafe&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;SliceData&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;y&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;nx&#34;&gt;y&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;nil&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;nx&#34;&gt;runtime&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;GC&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;nx&#34;&gt;runtime&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;GC&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;nx&#34;&gt;x&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;unsafe&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Pointer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;yptr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;nx&#34;&gt;runtime&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;GC&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;nx&#34;&gt;runtime&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;GC&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;nx&#34;&gt;runtime&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;KeepAlive&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;äº‹å®ä¸Šï¼Œè¿™ç¡®å®å¼•èµ·äº† panic ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;runtime&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;pointer&lt;/span&gt; &lt;span class=&#34;mh&#34;&gt;0xc000162000&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;to&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;unallocated&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;span&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;span&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;base&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()=&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0xc000288000&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;span&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;limit&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0xc000290000&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;span&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;state&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;runtime&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;found&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;object&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;at&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0xc00005ff58&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0x0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;object&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0xc00005ff58&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;s&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;base&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()=&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0xc00005e000&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;s&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;limit&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mh&#34;&gt;0xc000066000&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;s&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;spanclass&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;s&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;elemsize&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2048&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;s&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;state&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;mSpanManual&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; &lt;span class=&#34;o&#34;&gt;...&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;fatal&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;error&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;found&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;bad&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;pointer&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;Go&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;heap&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;incorrect&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;use&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;of&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;unsafe&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;or&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;cgo&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;?&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;å¦‚æœæ‚¨æƒ³çŸ¥é“ä¸ºä»€ä¹ˆè¦å¤šæ¬¡è°ƒç”¨&lt;code&gt;runtime.GC()&lt;/code&gt; ï¼Œæˆ‘ä¹Ÿæ˜¯ã€‚è¿™ä¼¼ä¹ä½¿å®ƒæ›´å¯é åœ°å´©æºƒã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;è¿™æ„å‘³ç€ä»€ä¹ˆï¼Ÿ&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Go çš„åƒåœ¾æ”¶é›†å™¨éå¸¸å¼ºå¤§ï¼Œå¯ä»¥å¤„ç†å¾ˆå¤šæ»¥ç”¨æƒ…å†µã€‚æ‚¨å¯ä»¥å°†å€¼å­˜å‚¨åœ¨ GC ä¸çŸ¥é“çš„æŒ‡é’ˆä¸­ï¼Œæˆ–è€…ç”šè‡³ä¸æ˜¯æœ‰æ•ˆçš„å†…å­˜åœ°å€ã€‚&lt;/p&gt;
&lt;p&gt;ä½†å¦‚æœä½ å­˜å‚¨äº† GC è®¤ä¸ºå®ƒèƒ½æ§åˆ¶çš„å†…å­˜åœ°å€ï¼Œé‚£ä¹ˆå®ƒå°±ä¼šå‘ç”Ÿ Panicã€‚å¦‚æœæ‚¨å°†éæŒ‡é’ˆå€¼å­˜å‚¨åœ¨&lt;code&gt;unsafe.Pointer&lt;/code&gt;ä¸­ï¼Œæ‚¨å¯èƒ½ä¸ä¼šç«‹å³çœ‹åˆ°é—®é¢˜ã€‚ä½ çš„æµ‹è¯•å¯èƒ½ä¸ä¼šæ˜¾ç¤ºä»»ä½•é—®é¢˜ã€‚ä½†æœ‰ä¸€å¤©ï¼Œæ€»ä¼šæœ‰å¼‚å¸¸ç”©ä½ è„¸ä¸Šï¼Œè€Œä½ å´ä¸çŸ¥é“ä¸ºä»€ä¹ˆã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘çš„ç»“è®ºå¦‚ä¸‹ã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;é™¤éç¡®å®å¿…è¦ï¼Œå¦åˆ™ä¸è¦ä½¿ç”¨&lt;code&gt;unsafe.Pointer&lt;/code&gt; ã€‚&lt;/li&gt;
&lt;li&gt;é™¤éç¡®å®æœ‰å¿…è¦ï¼Œå¦åˆ™ä¸è¦ä¿ç•™&lt;code&gt;unsafe.Pointer&lt;/code&gt;æŒ‡é’ˆå€¼ã€‚å¤§å¤šæ•°ä½¿ç”¨&lt;code&gt;unsafe.Pointer&lt;/code&gt;çš„å®‰å…¨æ“ä½œä»…å°†å…¶ç”¨ä½œç¬æ€å€¼ï¼ŒåŒæ—¶å°†æŸäº›å†…å®¹è½¬æ¢ä¸ºå…¶ä»–å†…å®¹ã€‚&lt;/li&gt;
&lt;li&gt;ä½ å¯èƒ½ä¸éœ€è¦ã€‚&lt;/li&gt;
&lt;li&gt;ä»…å°†å†…å­˜åœ°å€å­˜å‚¨åœ¨&lt;code&gt;unsafe.Pointer&lt;/code&gt;ä¸­ã€‚&lt;/li&gt;
&lt;li&gt;ä¹Ÿè®¸åªæœ‰åœ¨ Go è¿è¡Œæ—¶ä¹‹å¤–åˆ†é…çš„å†…å­˜åœ°å€ï¼ˆä¾‹å¦‚é€šè¿‡ç›´æ¥è°ƒç”¨ mmap ç³»ç»Ÿè°ƒç”¨ï¼‰ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;å‚è€ƒ&#34;&gt;å‚è€ƒ&lt;/h2&gt;
&lt;p&gt;æœ¬æ–‡ç¿»è¯‘äº&lt;a class=&#34;link&#34; href=&#34;https://philpearl.github.io/post/dumb_ways_to_die_random_pointers/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Dumb ways to die: Random Values in Pointers&lt;/a&gt;&lt;/p&gt;
</description>
        </item>
        <item>
        <title>Golang IO Cookbook</title>
        <link>https://blog.golang.space/p/golang-io-cookbook/</link>
        <pubDate>Tue, 27 Aug 2024 00:00:00 +0000</pubDate>
        
        <guid>https://blog.golang.space/p/golang-io-cookbook/</guid>
        <description>&lt;p&gt;è¿™å‡ å¤©ï¼Œæˆ‘å¼€å‘äº†ä¸€ä¸ªåä¸º &amp;ldquo;Horcux&amp;rdquo; çš„ç¨‹åºï¼Œå®ƒå…è®¸å°†ä¸€ä¸ªæ–‡ä»¶æ‹†åˆ†ä¸ºä»»æ„æ•°é‡çš„é­‚å™¨ï¼Œç„¶åå¯ä»¥é‡æ–°ç»„åˆä»¥æ¢å¤åŸå§‹æ–‡ä»¶ã€‚æœŸé—´ï¼Œæˆ‘äº†è§£äº†å¾ˆå¤šæœ‰å…³ io.Reader å’Œ io.Writer æ¥å£çš„çŸ¥è¯†ï¼Œä¸å¤§å®¶åˆ†äº«ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºä»€ä¹ˆä½¿ç”¨ io.Reader å’Œ io.Writer? åœ¨ Horcrux çš„ç¬¬ä¸€ä¸ªç‰ˆæœ¬ä¸­ï¼Œåšäº†ç±»ä¼¼ä»¥ä¸‹çš„äº‹æƒ…æ¥åŠ å¯†æ–‡ä»¶ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;9
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;c1&#34;&gt;// plaintext: &amp;#34;this is my file&amp;#39;s content&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;  &lt;span class=&#34;nx&#34;&gt;content&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;_&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;ioutil&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;ReadFile&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;myfile&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;nx&#34;&gt;encryptedContent&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;encrypt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;content&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;c1&#34;&gt;// ciphertext: &amp;#34;uijt!jt!nz!gjmf(t!dpoufou&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;  &lt;span class=&#34;nx&#34;&gt;ioutil&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;WriteFile&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;myfile.encryped&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;encryptedContent&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mo&#34;&gt;0644&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;å°æ–‡ä»¶è¶…çº§å¿«ã€‚å½“æ–‡ä»¶ä¸º 1GB æ—¶è¶…çº§æ…¢ã€‚æˆ‘çš„ç›®çš„æ˜¯åŠ å¯†æºæ–‡ä»¶ï¼Œè€Œä¸æ˜¯å°†æ•´ä¸ªæ–‡ä»¶åŠ è½½åˆ°å†…å­˜ä¸­ã€‚è¿™å°±æ˜¯ io.Reader å’Œ io.Writer å‘æŒ¥ä½œç”¨çš„åœ°æ–¹ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://img.golang.space/img-1724691975028.png&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;image-20240827010614870&#34;
	
	
&gt;&lt;/p&gt;
&lt;p&gt;io.Reader ä»æºè¯»å–æ•°æ®ã€‚io.Writer å°†å†…å®¹å†™å…¥ç›®çš„åœ°ï¼Œä¸¤ä¸ªæ¥å£æ˜¯å¤„ç†æµä¿¡æ¯çš„æ¥å£ã€‚&lt;/p&gt;
&lt;p&gt;æµå¼æ–¹æ³•æœ‰å‡ ä¸ªå¥½å¤„:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ç”¨ä¸€ä¸ªå°çš„ç¼“å†²åŒºè¯»å†™æ•°æ®ï¼Œä¸éœ€è¦å°†æ•´ä¸ªæ–‡ä»¶åŠ è½½åˆ°å†…å­˜&lt;/li&gt;
&lt;li&gt;ä¸éœ€è¦ç­‰å¾…æ•´ä¸ªæ–‡ä»¶åŠ è½½å¥½æ‰å¼€å§‹åŠ å¯†ï¼Œä¸€æ—¦æ•°æ®è¯»å…¥ç¼“å†²åŒºï¼Œå³å¯å¼€å§‹å†™å…¥ç›®æ ‡æ–‡ä»¶ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;ioreader&#34;&gt;io.Reader&lt;/h2&gt;
&lt;p&gt;ä»€ä¹ˆæ˜¯ io.Reader?&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kd&#34;&gt;type&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;Reader&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;interface&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nf&#34;&gt;Read&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;p&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[]&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;byte&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;n&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;error&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;å¸¸è§çš„è¿”å›é”™è¯¯æ˜¯ io.EOFï¼Œå®ƒä»£è¡¨è¯»å–ç»“æŸã€‚&lt;/p&gt;
&lt;p&gt;æŒ‰ç…§æƒ¯ä¾‹ï¼Œåœ¨ Go ä¸­ï¼Œå½“å‡½æ•°æœ‰å¤šä¸ªè¿”å›å€¼æ—¶ï¼Œå…¶ä¸­ä¸€ä¸ªæ˜¯ errorï¼Œå¦‚æœå‘ç”Ÿé”™è¯¯ï¼Œå…¶ä»–å€¼åº”ä¸ºé›¶å€¼ã€‚ä½†è€ƒè™‘å¦‚æœè¯»å–ä¸­é€”å‘ç”Ÿé”™è¯¯ï¼Œåº”è¯¥å‘Šè¯‰è°ƒç”¨è€…å½“å‰è¯»å–äº†å¤šå°‘å­—èŠ‚ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ä½¿ç”¨ io.Reader&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(){&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;nx&#34;&gt;reader&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;strings&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;NewReader&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;this is the stuff i&amp;#39;m reading&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;kd&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;result&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[]&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;byte&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;nx&#34;&gt;buf&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;make&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;([]&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;byte&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nx&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;reader&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Read&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;buf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nx&#34;&gt;result&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;append&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;result&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;buf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[:&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;...&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!=&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;nil&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;EOF&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;break&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;nx&#34;&gt;log&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Fatal&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;nx&#34;&gt;fmt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Println&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;string&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;result&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œåˆ›å»ºç¼“å†²åŒº(å¤§å°ä¸º 4 å­—èŠ‚) å¹¶æ‰§è¡Œå¾ªç¯ï¼Œåœ¨æ¯æ¬¡å¾ªç¯ä¸­è°ƒç”¨è¯»å–å™¨ä¸Šçš„ Read æ–¹æ³•ï¼Œå¹¶ä½¿ç”¨ç¬¬ä¸€ä¸ªè¿”å›å€¼æ¥æŸ¥çœ‹å·²å†™å…¥å¤šå°‘å­—èŠ‚ã€‚æœ€åå°†è¿™äº›æ•°æ®é™„åŠ åˆ°ç»“æœä¸­ï¼Œå¦‚æœå‡ºç° EOF é”™è¯¯ï¼Œè·³å‡ºå¾ªç¯ã€‚\&lt;/p&gt;
&lt;p&gt;æ³¨æ„æœ‰ä¸€ä¸ªç‚¹æ˜¯å…ˆå¤„ç†æ•°æ®ï¼Œå†å¤„ç†é”™è¯¯ã€‚è¿”å› (0,nil) å¹¶ä¸æ„å‘³ç€æ²¡æœ‰æ›´å¤šå†…å®¹å¯è¯»ï¼Œå¯èƒ½æ˜¯æ­£åœ¨ç­‰å¾…åº•å±‚æºè¿”å›æ›´å¤šçš„æ•°æ®ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;å®ç° io.Reader&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kd&#34;&gt;type&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;myReader&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;strcut&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;nx&#34;&gt;content&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[]&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;byte&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;nx&#34;&gt;position&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;r&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;myReader&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;Read&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;buf&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[]&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;byte&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;error&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;nx&#34;&gt;remainingBytes&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;len&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;r&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;content&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;r&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;position&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;nx&#34;&gt;n&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;min&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;remainingBytes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;len&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;buf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;n&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;EOF&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;nb&#34;&gt;copy&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;buf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[:&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;r&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;content&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;r&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;position&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;r&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;position&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;nx&#34;&gt;r&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;position&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;n&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;kc&#34;&gt;nil&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;åœ¨è¿™é‡Œï¼Œåˆ›å»ºä¸€ä¸ªç»“æ„ä½“ï¼ŒåŒ…å«è¦è¯»å–çš„å†…å®¹ content å­—æ®µï¼Œä»¥åŠç”¨äºè·Ÿè¸ªè¯»å–ä½ç½®çš„ position å­—æ®µã€‚ å°†æºæ•°æ®å¡«å……ç¼“å­˜åŒºå¹¶é˜²æ­¢æº¢å‡ºã€‚&lt;/p&gt;
&lt;p&gt;æ³¨æ„ï¼Œå½“æ²¡æœ‰æ›´å¤šå†…å®¹å¯è¯»å–æ—¶ï¼Œè¿”å› (0,io.EOF) ï¼Œä»è€Œé¿å…è°ƒç”¨è€…å¯¹ Read æ–¹æ³•è¿›è¡Œä¸å¿…è¦çš„è°ƒç”¨ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ç¼–å†™ io.Readers&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kd&#34;&gt;type&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;augmentedReader&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;struct&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;nx&#34;&gt;innerReader&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Reader&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;nx&#34;&gt;augmentFunc&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;([]&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;byte&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[]&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;byte&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// replaces &amp;#39; &amp;#39; with &amp;#39;!&amp;#39;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;bangify&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;buf&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[]&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;byte&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[]&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;byte&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;bytes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Replace&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;buf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[]&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;byte&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34; &amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[]&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;byte&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;!&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;r&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;augmentedReader&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;Read&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;buf&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[]&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;byte&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;error&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;nx&#34;&gt;tmpBuf&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;make&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;([]&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;byte&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;len&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;buf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;nx&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;r&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;innerReader&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Read&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;tmpBuf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;nb&#34;&gt;copy&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;buf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[:&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;r&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;augmentFunc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;tmpBuf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[:&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;BangReader&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;r&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Reader&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Reader&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;augmentedReader&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;innerReader&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;r&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;augmentFunc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;bangify&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;UpcaseReader&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;r&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Reader&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;io&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Reader&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;augmentedReader&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;innerReader&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;r&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;augmentFunc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;bytes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;ToUpper&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;...&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;package&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;main&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;.&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;augment&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;o&#34;&gt;...&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;nx&#34;&gt;originalReader&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;strings&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;NewReader&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;this is the stuff I&amp;#39;m reading&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;nx&#34;&gt;augmentedReader&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;UpcaseReader&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;BangReader&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;originalReader&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;nx&#34;&gt;result&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;ioutil&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;ReadAll&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;augmentedReader&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!=&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;nil&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;nx&#34;&gt;log&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Fatal&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;nx&#34;&gt;fmt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Println&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;string&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;result&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// THIS!IS!THE!STUFF!I&amp;#39;M!READING
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;è¿™ä¸€ä¸ªå¢å¼ºåŒ…ï¼Œå®ƒå¯¼å‡ºä¸€äº›å¯ç»„åˆçš„è¯»å–å™¨å‡½æ•°ã€‚æ¯ä¸ªå‡½æ•°éƒ½æ¥å—ä¸€ä¸ª io.Readerï¼Œå¹¶è¿”å›ä¸€ä¸ª io.Readerã€‚ä½†å†…éƒ¨ io.Reader çš„è¾“å‡ºç”±å¤–éƒ¨ IO å¢å¼ºã€‚åœ¨æœ¬ä¾‹ä¸­ï¼Œå°† &lt;code&gt;&amp;quot; &amp;quot;&lt;/code&gt; ä¸ &lt;code&gt;!&lt;/code&gt; äº¤æ¢ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ä½¿ç”¨ io.Writer&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;nx&#34;&gt;writer&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;os&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Stdout&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;nx&#34;&gt;writer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Write&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;([]&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;byte&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;hello there\n&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;strong&gt;å®ç° io.Writer&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kd&#34;&gt;type&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;myWriter&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;struct&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;nx&#34;&gt;content&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[]&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;byte&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;w&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;myWriter&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;Write&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;buf&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[]&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;byte&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;error&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;nx&#34;&gt;w&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;content&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;append&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;w&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;content&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;buf&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;...&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;len&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;buf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;nil&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;w&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;myWriter&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;String&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;string&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;string&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;w&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;content&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;nx&#34;&gt;writer&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;myWriter&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;nx&#34;&gt;writer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Write&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;([]&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;byte&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;hello there\n&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;nx&#34;&gt;fmt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Println&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;writer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;String&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;())&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// &amp;#34;hello there\n&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;åœ¨ Write æ–¹æ³•ä¸­ä»…è·å–ç¼“å†²åŒºå¹¶å°†å…¶é™„åŠ åˆ°å…¶å†…éƒ¨å†…å®¹ã€‚æˆ‘ä»¬è¿˜ç»™å®ƒä¸€ä¸ª&lt;code&gt;String&lt;/code&gt;æ–¹æ³•æ¥å‘Šè¯‰æˆ‘ä»¬åˆ°ç›®å‰ä¸ºæ­¢å®ƒå†™äº†ä»€ä¹ˆã€‚ç¢°å·§æˆ‘ä»¬åœ¨è¿™é‡Œå®ç°äº† bytes.Buffer çš„ç²¾ç®€ç¼–å†™å™¨ç‰ˆæœ¬ã€‚&lt;/p&gt;
&lt;h2 id=&#34;å‚è€ƒ&#34;&gt;å‚è€ƒ&lt;/h2&gt;
&lt;p&gt;æœ¬æ–‡ç¿»è¯‘äº &lt;a class=&#34;link&#34; href=&#34;https://jesseduffield.com/Golang-IO-Cookbook/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Golang IO Cookbook&lt;/a&gt;&lt;/p&gt;
</description>
        </item>
        <item>
        <title>Go Maps åˆ†æ é”®å€¼å¯¹å®é™…ä¸Šæ˜¯å¦‚ä½•å­˜å‚¨çš„?</title>
        <link>https://blog.golang.space/p/go-maps-%E5%88%86%E6%9E%90-%E9%94%AE%E5%80%BC%E5%AF%B9%E5%AE%9E%E9%99%85%E4%B8%8A%E6%98%AF%E5%A6%82%E4%BD%95%E5%AD%98%E5%82%A8%E7%9A%84/</link>
        <pubDate>Thu, 22 Aug 2024 00:00:00 +0000</pubDate>
        
        <guid>https://blog.golang.space/p/go-maps-%E5%88%86%E6%9E%90-%E9%94%AE%E5%80%BC%E5%AF%B9%E5%AE%9E%E9%99%85%E4%B8%8A%E6%98%AF%E5%A6%82%E4%BD%95%E5%AD%98%E5%82%A8%E7%9A%84/</guid>
        <description>&lt;p&gt;ç†è§£ maps çš„çœŸæ­£å·¥ä½œåŸç†æœ‰å¯èƒ½ç›¸å½“å›°éš¾ï¼Œä¸¾ä¸ªä¾‹å­: ä½ æ˜¯å¦æ›¾ç»è®¾ç½®è¿‡ map çš„ hintï¼Œå³ &lt;code&gt;make(map,hint)&lt;/code&gt;ï¼Œä¸ºä»€ä¹ˆå®ƒå« hint ï¼Œè€Œä¸æ˜¯sliceé‚£æ ·çš„ len?&lt;/p&gt;
&lt;p&gt;ä½ å¯ä»¥å·²ç»æ³¨æ„åˆ°ï¼Œå½“ä½ åœ¨ map ä¸Šä½¿ç”¨ for-range æ—¶ï¼Œé¡ºåºä¸æ’å…¥é¡ºåºä¸åŒ¹é…ã€‚å¦‚æœåœ¨ä¸åŒçš„æ—¶é—´å¾ªç¯åŒä¸€ä¸ª mapï¼Œæ¯æ¬¡çš„ç»“æœå¯èƒ½éƒ½ä¸ä¸€æ ·ã€‚å¥‡æ€ªçš„æ˜¯ï¼ŒåŒä¸€ä¸ªæ—¶é—´å¾ªç¯ï¼Œé¡ºåºé€šå¸¸ä¿æŒä¸å˜ã€‚&lt;/p&gt;
&lt;p&gt;è·Ÿä¸Šï¼Œå¸¦ä½ çœ‹çœ‹ã€‚&lt;/p&gt;
&lt;p&gt;æœ¬æ–‡åŸºäº Go 1.23 ç‰ˆæœ¬ã€‚&lt;/p&gt;
&lt;h2 id=&#34;å¿«é€Ÿå¼€å§‹&#34;&gt;å¿«é€Ÿå¼€å§‹&lt;/h2&gt;
&lt;p&gt;Go ä¸­çš„ mapï¼Œæ˜¯ä¸€ç§å†…ç½®ç±»å‹ï¼Œå……å½“é”®å€¼å­˜å‚¨ï¼Œ key å¯ä»¥æ˜¯ä»»ä½•å¯æ¯”è¾ƒçš„ç±»å‹ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;m&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;make&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;map&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;string&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;m&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;a&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;m&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;b&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;m&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// map[a:1 b:2]
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;åœ¨è¯¥ç¤ºä¾‹ä¸­ï¼Œä½¿ç”¨ &lt;code&gt;make()&lt;/code&gt; åˆ›å»ºäº†ä¸€ä¸ªç©º mapï¼Œå…¶ä¸­ key æ˜¯å­—ç¬¦ä¸²ï¼Œvalue æ˜¯æ•´æ•°ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://img.golang.space/img-1724336931681.png&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;image-20240822222851523&#34;
	
	
&gt;&lt;/p&gt;
&lt;p&gt;å¯ä»¥åœ¨å£°æ˜ map çš„åŒæ—¶èµ‹å€¼é”®å€¼å¯¹ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;m&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;map&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;string&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;s&#34;&gt;&amp;#34;a&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;s&#34;&gt;&amp;#34;b&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;åˆ é™¤çš„æ–¹æ³•æ˜¯ &lt;code&gt;delete(m,&amp;quot;a&amp;quot;)&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;map çš„é›¶å€¼æ˜¯ nilï¼Œå¹¶ä¸” nil map åœ¨æŸäº›æ–¹é¢æœ‰ç‚¹åƒ empty mapï¼Œå¯ä»¥å°è¯•åœ¨å…¶ä¸­æŸ¥æ‰¾ keyï¼Œgolang ä¸ä¼šå‘ç”Ÿ panic ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœæœç´¢ä¸å­˜åœ¨çš„ keyï¼ŒGo ä¼šæä¾›è¯¥ç±»å‹çš„é›¶å€¼ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kd&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;m&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;map&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;string&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nb&#34;&gt;println&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;m&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;a&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// 0
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;m&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;a&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;      &lt;span class=&#34;c1&#34;&gt;// panic: assignment to entry in nil map
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;è­¦å‘Š: ä½†ä¸èƒ½å¯¹ nil map æ·»åŠ æ–°çš„é”®å€¼å¯¹!&lt;/p&gt;
&lt;p&gt;äº‹å®ä¸Šï¼Œ Go å¤„ç† map çš„æ–¹å¼ä¸å¤„ç† slice çš„æ–¹å¼éå¸¸ç›¸ä¼¼ï¼Œä¸¤è€…çš†ä»¥ nil å¼€å§‹ï¼Œfor-range ä¹Ÿä¸ä¼šå‘ç”Ÿ panicï¼ŒGo å°†ä»»ä½•ç±»å‹çš„é›¶å€¼è§†ä¸ºæœ‰ç”¨çš„ä¸œè¥¿ï¼Œè€Œä¸æ˜¯å¯¼è‡´ç¨‹åºå´©æºƒçš„ä¸œè¥¿ï¼Œé™¤éå½“ä½ åšäº†ä¸€äº›éæ³•çš„äº‹æƒ…ï¼Œä¾‹å¦‚å°è¯•åƒ nil map æ·»åŠ æ–°çš„é”®å€¼å¯¹ï¼Œæˆ–è€…å¯¹ nil slice è¶Šç•Œç´¢å¼•ã€‚&lt;/p&gt;
&lt;p&gt;å…³äº Go ä¸­çš„ mapï¼Œåº”è¯¥äº†è§£ä»¥ä¸‹å‡ ç‚¹:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;map çš„éå†æ˜¯ä¹±åºçš„&lt;/li&gt;
&lt;li&gt;map éçº¿ç¨‹å®‰å…¨ï¼Œå¹¶ä¸”æ•°æ®ç«äº‰æ—¶ä¼šå‘ç”Ÿ panic&lt;/li&gt;
&lt;li&gt;å¯ä»¥é€šè¿‡ &lt;code&gt;ok&lt;/code&gt; æ¥æ£€æŸ¥ key æ˜¯å¦å­˜åœ¨ &lt;code&gt;_,ok := m[key]&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;map çš„ key å¿…é¡»æ˜¯å¯æ¯”è¾ƒçš„&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;é‚£ä¹ˆï¼Œå¯æ¯”è¾ƒç±»å‹åˆ°åº•æ˜¯ä»€ä¹ˆ?&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ç®€å•çš„å¾ˆï¼Œå¦‚æœå¯ä»¥ä½¿ç”¨ &lt;code&gt;==&lt;/code&gt; æ¥åˆ¤æ–­ç›¸åŒç±»å‹çš„ä¸¤ä¸ªå€¼ï¼Œé‚£ä¹ˆè¯¥ç±»å‹è¢«è®¤ä¸ºå¯ä»¥æ¯”è¾ƒã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;9
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;kd&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;s&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;map&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;string&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;s&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;s&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nb&#34;&gt;println&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;comparable&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// compile error: invalid operation: s == s (map can only be compared to nil)
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;æ˜¾ç„¶ï¼Œä¸Šé¢çš„ä»£ç æ— æ³•é€šè¿‡ç¼–è¯‘ï¼Œmap åªèƒ½ä¸ nil æ¯”è¾ƒã€‚&lt;/p&gt;
&lt;p&gt;åŒæ ·çš„è§„åˆ™é€‚ç”¨äºå…¶ä»–ä¸å¯æ¯”è¾ƒçš„ç±»å‹ï¼Œä¾‹å¦‚sliceã€å‡½æ•°æˆ–åŒ…å«sliceæˆ–mapçš„ç»“æ„ç­‰ã€‚&lt;/p&gt;
&lt;p&gt;ä½†è¿™é‡Œæœ‰ä¸ªå°æŠ€å·§ï¼Œæ¥å£æ˜¯å¯ä»¥æ¯”è¾ƒçš„ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸å¯æ¯”è¾ƒçš„ã€‚&lt;/p&gt;
&lt;p&gt;ä»€ä¹ˆæ„æ€? å³å¯ä»¥å®šä¹‰ä¸€ä¸ªç©ºæ¥å£ä¸ºé”®çš„ map ï¼Œè€Œä¸ä¼šç¼–è¯‘å‡ºé”™ï¼Œä½†å¯ä»¥è¿è¡Œæ—¶å‡ºé”™ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nx&#34;&gt;m&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;map&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;interface&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{}]&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;s&#34;&gt;&amp;#34;a&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nx&#34;&gt;m&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[[]&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}]&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nx&#34;&gt;m&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{}]&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// panic: runtime error: hash of unhashable type []int
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// panic: runtime error: hash of unhashable type func()
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;ä¸€åˆ‡çœ‹èµ·æ¥éƒ½å¾ˆå¥½ï¼Œç›´åˆ°å°è¯•åˆ†é…ä¸€ä¸ªä¸å¯æ¯”è¾ƒçš„ç±»å‹ä½œä¸º key ã€‚è¿™æ¯”ç¼–è¯‘é”™è¯¯æ›´éš¾å¤„ç†ï¼Œåº”å½“é¿å…ä½¿ç”¨ interface{} ä½œä¸º map çš„ key ã€‚&lt;/p&gt;
&lt;h2 id=&#34;map-å‰–æ&#34;&gt;Map å‰–æ&lt;/h2&gt;
&lt;p&gt;è®©æˆ‘ä»¬ç”±æµ…å…¥æ·±ï¼Œç»†å“ï¼Œåˆ«é™·å…¥ Go æºç çš„å…·ä½“å®ç°ã€‚&lt;/p&gt;
&lt;p&gt;å®é™…ä¸Šï¼Œé”®å€¼å¯¹æ˜¯ä¸€ä¸ªæŠ½è±¡ï¼Œåº•å±‚æ˜¯ç”±è®¸å¤šç§°ä¸º &lt;code&gt;bucket&lt;/code&gt; çš„è¾ƒå°å•å…ƒé˜»å¡ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kd&#34;&gt;type&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;hmap&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;struct&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;o&#34;&gt;...&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;nx&#34;&gt;buckets&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;unsafe&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Pointer&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;o&#34;&gt;...&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;æ³¨æ„çœ‹ï¼Œè¿™ä¸ª buckets æ˜¯æŒ‡é’ˆï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆå°† map åˆ†é…ç»™å˜é‡æˆ–ä¼ é€’ç»™å‡½æ•°æ—¶ï¼Œåœ¨å¤–éƒ¨çš„ä¿®æ”¹ä¹Ÿä¼šå½±å“åˆ°è¿™ä¸ªå€¼ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;9
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;changeMap&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;m2&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;map&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;string&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;nx&#34;&gt;m2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;hello&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;nx&#34;&gt;m1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;map&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;string&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;hello&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;nf&#34;&gt;changeMap&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;m1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;nb&#34;&gt;println&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;m1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;hello&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// 2
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;map æ˜¯æŒ‡å‘è¿è¡Œæ—¶ hmap çš„æŒ‡é’ˆï¼Œä½†å®ƒä»¬ä¸æ˜¯å¼•ç”¨ç±»å‹ï¼Œå¦‚æœå¦‚ä¸‹æ‰€ç¤ºçš„æ›´æ”¹ï¼Œå®ƒä¸ä¼šåæ˜ åˆ°è°ƒç”¨è€…ä¸­ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;9
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;changeMap&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;m2&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;map&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;string&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;nx&#34;&gt;m2&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;map&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;string&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;hello&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;nx&#34;&gt;m1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;map&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;string&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;hello&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;nf&#34;&gt;changeMap&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;m1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;nb&#34;&gt;println&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;m1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;hello&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// 1
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;åœ¨ Go ä¸­ï¼Œä¸€åˆ‡éƒ½æ˜¯æŒ‰å€¼ä¼ é€’çš„ã€‚çœŸæ­£å‘ç”Ÿçš„æƒ…å†µæœ‰ç‚¹ä¸åŒï¼Œå½“ä½ å°† map m1 ä¼ é€’ç»™ changeMap å‡½æ•°æ—¶ï¼ŒGo ä¼šåˆ›å»º &lt;code&gt;*hmap&lt;/code&gt; ç»“æ„çš„å‰¯æœ¬ã€‚å› æ­¤ï¼Œ&lt;code&gt;main()&lt;/code&gt; ä¸­çš„ &lt;code&gt;m1&lt;/code&gt; å’Œ &lt;code&gt;changeMap()&lt;/code&gt; å‡½æ•°ä¸­çš„ m2 ä»æŠ€æœ¯ä¸Šè®²æ˜¯æŒ‡å‘ç›¸åŒ hmap ä¸åŒçš„æŒ‡é’ˆã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://img.golang.space/img-1724338240761.png&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;image-20240822225040639&#34;
	
	
&gt;&lt;/p&gt;
&lt;p&gt;æ¯ä¸ªå­˜å‚¨æ¡¶æœ€å¤šåªèƒ½å®¹çº³ 8 ä¸ªé”®å€¼å¯¹ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://img.golang.space/img-1724338257501.png&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;image-20240822225057396&#34;
	
	
&gt;&lt;/p&gt;
&lt;p&gt;ä¸Šé¢çš„mapæœ‰2ä¸ªbucketï¼Œ &lt;code&gt;len(map)&lt;/code&gt;æ˜¯6ã€‚&lt;/p&gt;
&lt;p&gt;å½“æ·»åŠ é”®å€¼å¯¹æ—¶ï¼Œä¼šæ ¹æ® &lt;code&gt;hash(key, seed)&lt;/code&gt; å°†é”®å€¼å¯¹æ”¾å…¥å…¶ä¸­ä¸€ä¸ªå­˜å‚¨æ¡¶ä¸­ã€‚&lt;/p&gt;
&lt;p&gt;çœ‹çœ‹ä»¥ä¸‹åœºæ™¯: æœ‰ä¸€ä¸ª nil map  å¹¶ä¸ºå…¶åˆ†é…é”®å€¼å¯¹&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://img.golang.space/img-1724338358306.png&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;image-20240822225238187&#34;
	
	
&gt;&lt;/p&gt;
&lt;p&gt;å®ƒé¦–å…ˆå°†â€œhelloâ€æ•£åˆ—åˆ°ä¸€ä¸ªæ•°å­—ï¼Œç„¶åè·å–è¯¥æ•°å­—å¹¶æŒ‰å­˜å‚¨æ¡¶çš„æ•°é‡å¯¹å…¶è¿›è¡Œä¿®æ”¹ã€‚&lt;/p&gt;
&lt;p&gt;ç”±äºæˆ‘ä»¬è¿™é‡Œåªæœ‰ä¸€ä¸ªå­˜å‚¨æ¡¶ï¼Œä»»ä½•æ•°å­— mod 1 éƒ½æ˜¯ 0ï¼Œæ‰€ä»¥å®ƒä¼šç›´æ¥è¿›å…¥å­˜å‚¨æ¡¶ 0ï¼Œå½“æ‚¨æ·»åŠ å¦ä¸€ä¸ªé”®å€¼å¯¹æ—¶ï¼Œä¹Ÿä¼šå‘ç”Ÿç›¸åŒçš„è¿‡ç¨‹ã€‚å®ƒå°†å°è¯•å°†å…¶æ”¾å…¥å­˜å‚¨æ¡¶ 0 ä¸­ï¼Œå¦‚æœç¬¬ä¸€ä¸ª bucket å·²è¢«å ç”¨æˆ–å…·æœ‰ä¸åŒçš„å¯†é’¥ï¼Œå®ƒå°†ç§»åŠ¨åˆ°è¯¥å­˜å‚¨æ¡¶ä¸­çš„ä¸‹ä¸€ä¸ª bucketã€‚&lt;/p&gt;
&lt;p&gt;çœ‹ä¸€ä¸‹&lt;code&gt;hash(key, seed)&lt;/code&gt; ï¼Œå½“æ‚¨åœ¨å…·æœ‰ç›¸åŒé”®çš„ä¸¤ä¸ªmapä¸Šä½¿ç”¨ for-range å¾ªç¯æ—¶ï¼Œæ‚¨å¯èƒ½ä¼šæ³¨æ„åˆ°é”®ä»¥ä¸åŒçš„é¡ºåºå‡ºç°ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;nx&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;map&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;string&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;a&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;b&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;c&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;d&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;e&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;5&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;f&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;6&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;nx&#34;&gt;b&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;map&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;string&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;a&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;b&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;c&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;d&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;e&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;5&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;f&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;6&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;range&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;nb&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34; &amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;nb&#34;&gt;println&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;range&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;b&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;nb&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34; &amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// Output:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// a b c d e f
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// c d e f a b
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;è¿™æ€ä¹ˆå¯èƒ½ï¼Ÿmap a ä¸­çš„é”®â€œaâ€å’Œmap b ä¸­çš„é”®â€œaâ€ä¸æ˜¯ä»¥ç›¸åŒçš„æ–¹å¼æ•£åˆ—å—ï¼Ÿ&lt;/p&gt;
&lt;p&gt;ä½†äº‹æƒ…æ˜¯è¿™æ ·çš„ï¼Œè™½ç„¶ Go ä¸­ç”¨äº map çš„å“ˆå¸Œå‡½æ•°åœ¨å…·æœ‰&lt;strong&gt;ç›¸åŒé”®ç±»å‹&lt;/strong&gt;çš„æ‰€æœ‰ map ä¸­æ˜¯ä¸€è‡´çš„ï¼Œä½†è¯¥å“ˆå¸Œå‡½æ•°ä½¿ç”¨çš„&lt;code&gt;seed&lt;/code&gt;å¯¹äºæ¯ä¸ª map å®ä¾‹æ˜¯ä¸åŒçš„ã€‚å› æ­¤ï¼Œå½“æ‚¨åˆ›å»ºæ–° map æ—¶ï¼ŒGo ä¼šä¸“é—¨ä¸ºè¯¥ map ç”Ÿæˆä¸€ä¸ªéšæœºç§å­ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ä¸€ä¸ª bucket çš„é•¿åº¦æœ€å¤§æ˜¯ 8ï¼Œé‚£æ»¡äº†ä¼šæ€æ ·?&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;å½“æ¡¶å¼€å§‹å˜æ»¡ï¼Œç”šè‡³å‡ ä¹æ»¡æ—¶ï¼Œæ ¹æ®ç®—æ³•å¯¹â€œæ»¡â€çš„å®šä¹‰ï¼Œmap å°†è§¦å‘æ‰©å®¹ï¼Œè¿™å¯èƒ½ä¼šä½¿ main buckets çš„æ•°é‡å¢åŠ ä¸€å€ã€‚&lt;/p&gt;
&lt;p&gt;æœ‰è¶£ã€‚&lt;/p&gt;
&lt;p&gt;å½“æˆ‘è¯´â€œ main bucketsâ€ æ—¶ï¼Œæˆ‘æ­£åœ¨è®¾ç½®å¦ä¸€ä¸ªæ¦‚å¿µï¼šâ€œoverflow bucketsâ€ã€‚å½“é‡åˆ°é«˜ç¢°æ’çš„æƒ…å†µæ—¶ï¼Œè¿™äº›å°±ä¼šå‘æŒ¥ä½œç”¨ã€‚è¯•æƒ³: å­˜åœ¨ 4 ä¸ªbucketï¼Œä½†å…¶ä¸­ä¸€ä¸ªç”±äºé«˜å†²çªè€Œå®Œå…¨è£…æ»¡ï¼Œå¦å¤– 3 ä¸ªåˆ™ç©ºç€ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://img.golang.space/img-1724338742096.png&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;image-20240822225901973&#34;
	
	
&gt;&lt;/p&gt;
&lt;p&gt;æ˜¯å¦çœŸçš„éœ€è¦å°† map ç¿»å€æ‰©å®¹åˆ° 8 ä¸ª buckets? ä»…ä»…æ˜¯éœ€è¦æ·»åŠ ä¸€ä¸ªä¸å¹¸ä¹Ÿè½åˆ° bucket 0 çš„é”®å€¼å¯¹?&lt;/p&gt;
&lt;p&gt;No! è¿™æ ·å¤ªæµªè´¹äº†ã€‚&lt;/p&gt;
&lt;p&gt;Go é€šè¿‡åˆ›å»ºé“¾æ¥åˆ°ç¬¬ä¸€ä¸ª bucket çš„ &lt;code&gt;overflow bucket&lt;/code&gt; æ¥æ›´æœ‰æ•ˆå¤„ç†è¿™ä¸ªé—®é¢˜ã€‚æ–°çš„é”®å€¼å¯¹å­˜å‚¨åœ¨è¿™ä¸ªæº¢å‡ºæ¡¶ä¸­ï¼Œè€Œä¸æ˜¯å¼ºåˆ¶å®Œå…¨æ‰©å®¹ã€‚&lt;/p&gt;
&lt;p&gt;å½“æ»¡è¶³ä¸¤ä¸ªæ¡ä»¶ä¹‹ä¸€æ—¶ï¼ŒGo ä¸­çš„ map å°±ä¼šæ‰©å®¹: è¦ä¹ˆæº¢å‡ºæ¡¶å¤ªå¤šï¼Œè¦ä¹ˆ map è¿‡è½½(è´Ÿè½½å› å­å¤ªé«˜)ã€‚&lt;/p&gt;
&lt;p&gt;å¯¹åº”è¿™ä¸¤ç§æ¡ä»¶ï¼Œä¹Ÿæœ‰ä¸¤ç§æ‰©å®¹æ–¹å¼:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ç¿»å€æ‰©å®¹(è¿‡è½½æ—¶)&lt;/li&gt;
&lt;li&gt;ä¿æŒç›¸åŒå¤§å°ï¼Œä½†é‡æ–°åˆ†é… bucket ä¸­çš„æ•°æ®ã€‚(å½“æº¢å‡ºæ¡¶å¤ªå¤šæ—¶)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ç›®å‰ï¼ŒGo çš„è´Ÿè½½å› å­è®¾ç½®ä¸º 6.5ï¼Œè¿™æ„å‘³ç€ map è®¾è®¡ä¸ºæ¯ä¸ª bucket å¹³å‡ç»´æŠ¤ 6,5 ä¸ªï¼Œå¤§çº¦æ˜¯ 80%çš„å®¹é‡ï¼Œå½“è´Ÿè½½å› å­è¶…è¿‡æ­¤é˜ˆå€¼ï¼Œmap è§†ä¸ºè¿‡è½½ã€‚æ­¤æ—¶ï¼Œå°†é€šè¿‡åˆ†é…ä¸€ä¸ªæ–°çš„ buckets æ•°ç»„ï¼Œè¯¥æ•°ç»„æ˜¯å¤§å°æ˜¯å½“å‰çš„ä¸¤å€ï¼Œç„¶åå…ƒç´ é‡æ–°æ•£åˆ—åˆ°æ–°çš„ buckets ä¸­ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬é€šå¸¸è®¤ä¸ºåœ¨mapä¸­è®¿é—®å’Œèµ‹å€¼æ˜¯ O(1)ï¼Œå¯¹å§ï¼Ÿä½†äº‹æƒ…å¹¶ä¸æ€»æ˜¯é‚£ä¹ˆç®€å•ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://img.golang.space/img-1724339247109.png&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;image-20240822230726996&#34;
	
	
&gt;&lt;/p&gt;
&lt;p&gt;bucket ä¸­çš„å…ƒç´ è¶Šå¤šï¼Œé€Ÿåº¦å°±è¶Šæ…¢ã€‚&lt;/p&gt;
&lt;p&gt;å½“æ‚¨æƒ³è¦æ·»åŠ å¦ä¸€ä¸ªé”®å€¼å¯¹æ—¶ï¼Œä¸ä»…ä»…æ˜¯æ£€æŸ¥å­˜å‚¨æ¡¶æ˜¯å¦æœ‰ç©ºé—´ï¼Œè€Œæ˜¯å°†é”®ä¸è¯¥å­˜å‚¨æ¡¶ä¸­çš„æ¯ä¸ªç°æœ‰é”®è¿›è¡Œæ¯”è¾ƒï¼Œä»¥å†³å®šæ˜¯æ·»åŠ æ–°æ¡ç›®è¿˜æ˜¯æ›´æ–°ç°æœ‰æ¡ç›®ã€‚&lt;/p&gt;
&lt;p&gt;å½“æ‚¨æœ‰æº¢å‡ºæ¡¶æ—¶ï¼Œæƒ…å†µä¼šå˜å¾—æ›´ç³Ÿï¼Œå› ä¸ºæ‚¨è¿˜å¿…é¡»æ£€æŸ¥è¿™äº›æº¢å‡ºæ¡¶ä¸­çš„æ¯ä¸ªæ’æ§½ã€‚è¿™ç§é€Ÿåº¦å‡æ…¢ä¹Ÿä¼šå½±å“è®¿é—®å’Œåˆ é™¤æ“ä½œã€‚&lt;/p&gt;
&lt;p&gt;ä½† Go å›¢é˜Ÿå¼ºå‘€ï¼Œä»–ä»¬ä¸ºæˆ‘ä»¬ä¼˜åŒ–äº†è¿™ä¸ªæ¯”è¾ƒã€‚&lt;/p&gt;
&lt;p&gt;è¿˜è®°å¾—æˆ‘ä»¬å¯¹é”®â€œHelloâ€è¿›è¡Œæ•£åˆ—æ—¶å¾—åˆ°çš„æ•£åˆ—å—ï¼Ÿ Go ä¸åªæ˜¯æŠŠå®ƒæ‰”æ‰ã€‚å®ƒå®é™…ä¸Šå°†â€œHelloâ€çš„ tophash ä½œä¸º&lt;code&gt;uint8&lt;/code&gt;ç¼“å­˜åœ¨å­˜å‚¨æ¡¶ä¸­ï¼Œå¹¶ä½¿ç”¨å®ƒä¸ä»»ä½•æ–°å¯†é’¥çš„ tophash è¿›è¡Œå¿«é€Ÿæ¯”è¾ƒã€‚è¿™ä½¿å¾—åˆå§‹æ£€æŸ¥è¶…çº§å¿«ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://img.golang.space/img-1724339343910.png&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;image-20240822230903757&#34;
	
	
&gt;&lt;/p&gt;
&lt;p&gt;æ¯”è¾ƒ&lt;code&gt;tophash&lt;/code&gt;åï¼Œå¦‚æœå®ƒä»¬åŒ¹é…ï¼Œåˆ™æ„å‘³ç€å¯†é’¥â€œå¯èƒ½â€ç›¸åŒã€‚ç„¶åï¼ŒGo ç»§ç»­è¿›è¡Œè¾ƒæ…¢çš„è¿‡ç¨‹ï¼Œæ£€æŸ¥å¯†é’¥æ˜¯å¦å®é™…ä¸Šç›¸åŒã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ä¸ºä»€ä¹ˆä½¿ç”¨ make(map,hint) åˆ›å»ºæ–° map ä¸æä¾›ç¡®åˆ‡çš„å¤§å°è€Œåªæä¾› hintï¼Ÿ&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;code&gt;make(map, hint)&lt;/code&gt;ä¸­çš„&lt;code&gt;hint&lt;/code&gt;å‚æ•°å‘Šè¯‰Goæ‚¨&lt;strong&gt;æœŸæœ›&lt;/strong&gt;mapä¿å­˜çš„å…ƒç´ çš„åˆå§‹æ•°é‡ã€‚æ­¤ hint æœ‰åŠ©äºæœ€å¤§é™åº¦åœ°å‡å°‘æ·»åŠ å…ƒç´ æ—¶ map éœ€è¦æ‰©å®¹çš„æ¬¡æ•°ã€‚&lt;/p&gt;
&lt;p&gt;ç”±äºæ¯ä¸ªæ‰©å®¹æ“ä½œéƒ½æ¶‰åŠåˆ†é…æ–°çš„å­˜å‚¨æ¡¶æ•°ç»„å¹¶å¤åˆ¶ç°æœ‰å…ƒç´ ï¼Œå› æ­¤è¿™ä¸æ˜¯æœ€æœ‰æ•ˆçš„è¿‡ç¨‹ã€‚ä»è¾ƒå¤§çš„åˆå§‹å®¹é‡å¼€å§‹å¯ä»¥å¸®åŠ©é¿å…ä¸€äº›æˆæœ¬é«˜æ˜‚çš„æ‰©å®¹æ“ä½œã€‚&lt;/p&gt;
&lt;p&gt;å½“æ‚¨æ·»åŠ æ›´å¤šå…ƒç´ æ—¶ï¼Œå­˜å‚¨æ¡¶å¤§å°è¿™æ ·æ‰©å®¹ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Hint Range&lt;/th&gt;
&lt;th&gt;Bucket Count&lt;/th&gt;
&lt;th&gt;Capacity&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;0 - 8&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;8&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;9 - 13&lt;/td&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;16&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;14 - 26&lt;/td&gt;
&lt;td&gt;4&lt;/td&gt;
&lt;td&gt;32&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;27 - 52&lt;/td&gt;
&lt;td&gt;8&lt;/td&gt;
&lt;td&gt;64&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;53 - 104&lt;/td&gt;
&lt;td&gt;16&lt;/td&gt;
&lt;td&gt;128&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;105 - 208&lt;/td&gt;
&lt;td&gt;32&lt;/td&gt;
&lt;td&gt;256&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;209 - 416&lt;/td&gt;
&lt;td&gt;64&lt;/td&gt;
&lt;td&gt;512&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;417 - 832&lt;/td&gt;
&lt;td&gt;128&lt;/td&gt;
&lt;td&gt;1024&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;833 - 1664&lt;/td&gt;
&lt;td&gt;256&lt;/td&gt;
&lt;td&gt;2048&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;ä¸ºä»€ä¹ˆ hint= 14 ä¼šäº§ç”Ÿ 4 ä¸ªæ¡¶ï¼Ÿæˆ‘ä»¬åªéœ€è¦ 2 ä¸ªæ¡¶å°±å¯ä»¥å®¹çº³ 14 ä¸ªå…ƒç´ ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;è¿™å°±æ˜¯è´Ÿè½½å› å­å‘æŒ¥ä½œç”¨çš„åœ°æ–¹ï¼Œå½“ hint=13ï¼Œæœ‰ 2 ä¸ª bucketsï¼Œè´Ÿè½½å› å­ä¸º 13/2=6.5ï¼Œè¾¾åˆ°é˜ˆå€¼ä½†æœªè¶…è¿‡ã€‚å› æ­¤ï¼Œå½“ hint=14ï¼Œè´Ÿè½½å› å­è¶…è¿‡ 6.5ï¼Œè§¦å‘ç¿»å€æ‰©å®¹ã€‚&lt;/p&gt;
&lt;p&gt;hint=26ä¹Ÿæ˜¯å¦‚æ­¤ï¼Œ26/4=6.5ï¼Œå½“ hint&amp;gt;26ï¼Œmap éœ€è¦æ‰©å®¹ä»¥æœ‰æ•ˆå®¹çº³æ›´å¤šå…ƒç´ ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æ•£åˆ—&#34;&gt;æ•£åˆ—&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;ä¸ºä»€ä¹ˆæ— æ³•è·å– map å…ƒç´ çš„åœ°å€? ä¸ºä»€ä¹ˆä¸åŒæ—¶é—´ä¸èƒ½ä¿è¯èŒƒå›´å†…çš„é¡ºåº?&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;å½“ map å¢é•¿æ—¶ï¼Œä¼šåˆ†é…ä¸€ä¸ªæ–°çš„ buckets æ•°ç»„ï¼Œæ˜¯æ—§ buckets çš„ä¸¤å€ï¼Œæ—§ buckets ä¸­æ‰€æœ‰å…ƒç´ éƒ½å˜å¾—æ— æ•ˆï¼Œéœ€è¦ç§»åŠ¨åˆ°æ–°å†…å­˜åœ°å€çš„ buckets ä¸­ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://img.golang.space/img-1724339906450.png&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;image-20240822231826323&#34;
	
	
&gt;&lt;/p&gt;
&lt;p&gt;å¦‚æœ map å¾ˆå¤§ï¼Œä¸€æ¬¡æ€§çš„ç§»åŠ¨æƒ³å½“æ˜‚è´µï¼Œå¯èƒ½åœ¨ç›¸å½“é•¿çš„æ—¶é—´å†…é˜»å¡ goroutineã€‚ä¸ºäº†é¿å…è¿™ç§æƒ…å†µï¼ŒGo ä½¿ç”¨å¢é‡çš„æ–¹å¼ï¼Œä¸€æ¬¡åªé‡æ–°å“ˆå¸Œä¸€éƒ¨åˆ†å…ƒç´ ã€‚ä½ çš„ç¨‹åºå¯ä»¥ä¿æŒå¹³ç¨³è¿è¡Œï¼Œä¸ä¼šçªç„¶å‡ºç°æ»åã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ä»æ—§ buckets è¿ç§»åˆ° æ–° buckets  ä»€ä¹ˆæ—¶å€™å‘ç”Ÿ?&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ä¸¤ç§æƒ…å†µ:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ·»åŠ æ–°çš„é”®å€¼å¯¹&lt;/li&gt;
&lt;li&gt;ä» map ä¸­åˆ é™¤é”®å€¼å¯¹&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ä¾‹å¦‚ &lt;code&gt;map[&amp;quot;hello&amp;quot;]=2&lt;/code&gt; æ—¶ï¼Œå®é™…ç¬¬ä¸€ä»¶äº‹æ˜¯æ¸…ç©ºåŒ…å« &lt;code&gt;hello&lt;/code&gt; çš„æ—§ bucketsã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://img.golang.space/img-1724340184080.png&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;image-20240822232303757&#34;
	
	
&gt;&lt;/p&gt;
&lt;p&gt;å¦‚æœæ—§ buckets æœ‰æº¢å‡ºæ¡¶ï¼Œ map ä¹Ÿä¼šå°†è¿™äº› overflow buckets çš„å…ƒç´ ç§»åŠ¨åˆ°æ–° bucketsï¼Œç§»åŠ¨æ‰€æœ‰å…ƒç´ åï¼Œ map é€šè¿‡åœ¨ tophash å­—æ®µå°†æ—§æ¡¶æ ‡è®°ä¸º &lt;code&gt;evacuated&lt;/code&gt; ã€‚&lt;/p&gt;
&lt;p&gt;å…ˆè¿™ä¹ˆå¤šå“ˆï¼ŒGo map ç¡®å®æ¯”è¿™æ›´å¤æ‚ï¼Œå¾ˆå¤šå°ç»†èŠ‚å…ˆä¸ç»†è¯´ã€‚&lt;/p&gt;
&lt;h2 id=&#34;å‚è€ƒ&#34;&gt;å‚è€ƒ&lt;/h2&gt;
&lt;p&gt;æœ¬æ–‡ç¿»è¯‘äº &lt;a class=&#34;link&#34; href=&#34;https://victoriametrics.com/blog/go-map/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;&lt;em&gt;Go Maps Explained: How Key-Value Pairs Are Actually Stored&lt;/em&gt;&lt;/a&gt;&lt;/p&gt;
</description>
        </item>
        <item>
        <title>Go ä¸­çš„ 7 ä¸ªå¸¸è§æ¥å£é”™è¯¯</title>
        <link>https://blog.golang.space/p/go-%E4%B8%AD%E7%9A%84-7-%E4%B8%AA%E5%B8%B8%E8%A7%81%E6%8E%A5%E5%8F%A3%E9%94%99%E8%AF%AF/</link>
        <pubDate>Mon, 01 Jul 2024 00:00:00 +0000</pubDate>
        
        <guid>https://blog.golang.space/p/go-%E4%B8%AD%E7%9A%84-7-%E4%B8%AA%E5%B8%B8%E8%A7%81%E6%8E%A5%E5%8F%A3%E9%94%99%E8%AF%AF/</guid>
        <description>&lt;p&gt;Go ä»ç„¶æ˜¯ä¸€é—¨æ–°è¯­è¨€ï¼Œå¦‚æœä½ æ­£åœ¨ä½¿ç”¨å®ƒï¼Œå®ƒå¾ˆå¯èƒ½ä¸æ˜¯ä½ çš„ç¬¬ä¸€é—¨ç¼–ç¨‹è¯­è¨€ã€‚&lt;/p&gt;
&lt;p&gt;ä¸åŒçš„è¯­è¨€ï¼Œæ—¢ä¸ºä½ å¸¦æ¥äº†ç»éªŒï¼Œä¹Ÿå¸¦æ¥äº†åè§ã€‚ä½ ç”¨ä»¥å‰çš„ä»»ä½•è¯­è¨€åšçš„äº‹æƒ…ï¼Œåœ¨ Go ä¸­ç”¨ç›¸åŒçš„æ–¹æ³•å¯èƒ½ä¸æ˜¯ä¸€ä¸ªå¥½ä¸»æ„ã€‚&lt;/p&gt;
&lt;p&gt;å­¦ä¹  Go ä¸ä»…ä»…æ˜¯å­¦ä¹ ä¸€ç§æ–°çš„è¯­æ³•ã€‚è¿™ä¹Ÿæ˜¯å­¦ä¹ ä¸€ç§æ–°çš„æ€ç»´æ–¹å¼æ¥æ€è€ƒä½ çš„ç¨‹åºï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;em&gt;Go is a language for writing Go programs, not Java programs or Haskell programs or any other languageâ€™s programs. You need to think a different way to write good Go programs. But that takes time and effort, more than most will invest. So the usual story is to translate one program from another language into Go and see how it turns out. But translation misses idiom. A first attempt to write, for example, some Java construct in Go will likely fail, while a different Go-specific approach might succeed and illuminate. After 10 years of Java programming and 10 minutes of Go programming, any comparison of the languageâ€™s capabilities is unlikely to generate insight, yet here come the results, because thatâ€™s a modern programmerâ€™s job.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Rob Pike&lt;/strong&gt; &lt;em&gt;â€”&lt;/em&gt; &lt;a class=&#34;link&#34; href=&#34;https://commandcenter.blogspot.com/2011/12/esmereldas-imagination.html&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Esmereldaâ€™s Imagination&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;æ­£å¦‚ Rob Pike æ‰€å»ºè®®çš„é‚£æ ·ï¼Œå¦‚æœä½ æƒ³æé«˜å›´æ£‹æŠ€èƒ½ï¼Œéœ€è¦æŠ•å…¥æ—¶é—´å’Œç²¾åŠ›æ¥å­¦ä¹ è¿™é—¨è¯­è¨€çš„ä¹ è¯­ã€‚&lt;/p&gt;
&lt;p&gt;Go åœ¨å‡ ä»¶äº‹ä¸Šä¸å…¶ä»–ä¼ ç»Ÿè¯­è¨€ä¸åŒï¼Œåœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘å°†é‡ç‚¹ä»‹ç»å…¶ä¸­ä¹‹ä¸€ï¼šæ¥å£ã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹é¢åˆ—å‡ºäº†äººä»¬åœ¨ç¼–å†™ Go æ¥å£æ—¶å¸¸çŠ¯çš„é”™è¯¯ã€‚è¿™äº›åœ¨å…¶ä»–è¯­è¨€ä¸­å¯èƒ½ä¸æ˜¯é”™è¯¯ï¼Œä½†åœ¨ Go ä¸­ï¼Œä½ éœ€è¦å¿˜è®°å®ƒä»¬ã€‚æˆ–è€…è‡³å°‘ï¼Œç»™ä¸€ä¸ªæœºä¼šï¼Œæš‚æ—¶ä¸å’Œä»–ä»¬ä¸€èµ·å·¥ä½œï¼Œçœ‹çœ‹è¿™ä¼šæŠŠä½ å¼•å‘ä½•æ–¹ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ä½†åœ¨è¿™ä¹‹å‰&#34;&gt;ä½†åœ¨è¿™ä¹‹å‰&lt;/h2&gt;
&lt;p&gt;ä»¥ä¸‹æ˜¯é˜…è¯»æœ¬æ–‡æ—¶è¦è®°ä½çš„äº‹é¡¹åˆ—è¡¨ã€‚å¦‚æœä½ å·²ç»ç†Ÿæ‚‰å®ƒä»¬ï¼Œè¯·éšæ„è·³è¿‡ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;æ¥å£éš”ç¦»åŸåˆ™ï¼šä¸åº”å¼ºåˆ¶å®¢æˆ·ç«¯å®ç°å®ƒä¸ä½¿ç”¨çš„æ¥å£ï¼Œä¹Ÿä¸åº”å¼ºåˆ¶å®¢æˆ·ç«¯ä¾èµ–äºå®ƒä»¬ä¸ä½¿ç”¨çš„æ–¹æ³•ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;å¤šæ€æ€§ï¼šä¸€æ®µä»£ç æ ¹æ®å®ƒæ”¶åˆ°çš„å…·ä½“æ•°æ®æ”¹å˜å…¶è¡Œä¸ºã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Liskov æ›¿æ¢åŸåˆ™ï¼šå¦‚æœä½ çš„ä»£ç ä¾èµ–äºæŠ½è±¡ï¼Œé‚£ä¹ˆä¸€ä¸ªå®ç°å¯ä»¥è¢«å¦ä¸€ä¸ªå®ç°æ›¿æ¢ï¼Œè€Œæ— éœ€æ›´æ”¹ä½ çš„ä»£ç ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;em&gt;æŠ½è±¡çš„ç›®çš„ä¸æ˜¯æ¨¡ç³Šä¸æ¸…ï¼Œè€Œæ˜¯åˆ›é€ ä¸€ä¸ªæ–°çš„è¯­ä¹‰å±‚æ¬¡ï¼Œåœ¨è¿™ä¸ªå±‚æ¬¡ä¸Šå¯ä»¥ç»å¯¹ç²¾ç¡®ã€‚â€” E.W.è¿ªå…‹æ–¯ç‰¹æ‹‰&lt;/em&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æ¥å£æ˜¯ç²¾ç¡®åŒ…å«ç”¨äºç¼–å†™ç¨‹åºçš„æƒ³æ³•çš„æ¦‚å¿µã€‚&lt;/p&gt;
&lt;p&gt;ä»¥æ­£ç¡®çš„æ–¹å¼ä½¿ç”¨æ¥å£å¯ä»¥å¸¦æ¥ç®€å•æ€§ã€å¯è¯»æ€§å’Œ organic code è®¾è®¡ã€‚&lt;/p&gt;
&lt;p&gt;organic code æ˜¯ä»£ç ä¼šæ ¹æ®ä½ åœ¨æŸä¸ªæ—¶é—´ç‚¹æ‰€éœ€çš„è¡Œä¸ºè€Œå¢é•¿ã€‚å®ƒä¸ä¼šå¼ºè¿«ä½ æå‰è€ƒè™‘ä½ çš„ç±»å‹ä»¥åŠå®ƒä»¬ä¹‹é—´çš„å…³ç³»ï¼Œå› ä¸ºä½ å¾ˆå¯èƒ½æ— æ³•æ­£ç¡®ç†è§£å®ƒä»¬ã€‚&lt;/p&gt;
&lt;p&gt;è¿™å°±æ˜¯ä¸ºä»€ä¹ˆè¯´ Go åçˆ±ç»„åˆè€Œä¸æ˜¯ç»§æ‰¿ã€‚ä½ æœ‰ä¸€å°ç»„è¡Œä¸ºï¼Œä½ å¯ä»¥ä»ä¸­ç¼–å†™ä»»ä½•ä½ æƒ³è¦çš„ï¼Œè€Œä¸æ˜¯é¢„å®šä¹‰ç”±å…¶ä»–ç±»å‹ç»§æ‰¿çš„ç±»å‹å¹¶å¸Œæœ›å®ƒä»¬é€‚åˆé—®é¢˜åŸŸã€‚&lt;/p&gt;
&lt;p&gt;Rob Pike åœ¨ golang-nuts è®ºå›ä¸Šè§£é‡Šäº†è¿™ç§æ–¹æ³•ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://img.golang.space/img-1719847716977.png&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;img&#34;
	
	
&gt;&lt;/p&gt;
&lt;p&gt;Go çš„æ¥å£ä¸æ˜¯ Java æˆ– C# æ¥å£çš„å˜ä½“ï¼Œå®ƒä»¬è¿œä¸æ­¢äºæ­¤ã€‚å®ƒä»¬æ˜¯å¤§è§„æ¨¡ç¼–ç¨‹å’Œé€‚åº”æ€§å¼ºçš„æ¼”è¿›è®¾è®¡çš„å…³é”®ã€‚&lt;/p&gt;
&lt;p&gt;æ— è®ºå¦‚ä½•ï¼Œç†è®ºå·²ç»è¶³å¤Ÿäº†ï¼Œè®©æˆ‘ä»¬æ¥çœ‹çœ‹æœ€å¸¸è§çš„é”™è¯¯ï¼š&lt;/p&gt;
&lt;h2 id=&#34;1-ä½ åˆ›å»ºäº†å¤ªå¤šçš„æ¥å£&#34;&gt;1. ä½ åˆ›å»ºäº†å¤ªå¤šçš„æ¥å£&lt;/h2&gt;
&lt;p&gt;æ¥å£è¿‡å¤šçš„æœ¯è¯­ç§°ä¸ºæ¥å£æ±¡æŸ“ &lt;a class=&#34;link&#34; href=&#34;https://www.ardanlabs.com/blog/2016/10/avoid-interface-pollution.html&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;interface pollution&lt;/a&gt;.ã€‚å½“ä½ åœ¨ç¼–å†™å…·ä½“ç±»å‹ä¹‹å‰å¼€å§‹æŠ½è±¡æ—¶ï¼Œå°±ä¼šå‘ç”Ÿè¿™ç§æƒ…å†µã€‚ç”±äºä½ æ— æ³•é¢„è§ä½ éœ€è¦ä»€ä¹ˆæŠ½è±¡ï¼Œæ‰€ä»¥å¾ˆå®¹æ˜“å†™å‡ºå¤ªå¤šçš„æ¥å£ï¼Œè¿™äº›æ¥å£åœ¨ä»¥åè¦ä¹ˆæ˜¯é”™è¯¯çš„ï¼Œè¦ä¹ˆæ˜¯æ— ç”¨çš„ã€‚&lt;/p&gt;
&lt;p&gt;Rob Pike æœ‰ä¸€ä¸ªå¾ˆå¥½çš„æŒ‡å—ï¼Œå¯ä»¥å¸®åŠ©æˆ‘ä»¬é¿å…ç•Œé¢æ±¡æŸ“ï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;em&gt;Donâ€™t design with interfaces, discover them.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Rob Pike&lt;/strong&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Rob åœ¨è¿™é‡ŒæŒ‡å‡ºçš„æ˜¯ï¼Œä½ ä¸éœ€è¦æå‰è€ƒè™‘ä½ éœ€è¦ä»€ä¹ˆæŠ½è±¡ã€‚ä½ å¯ä»¥ä½¿ç”¨å…·ä½“ç»“æ„å¼€å§‹è®¾è®¡ï¼Œå¹¶ä»…åœ¨è®¾è®¡éœ€è¦æ—¶åˆ›å»ºæ¥å£ã€‚é€šè¿‡è¿™æ ·åšï¼Œä½ çš„ä»£ç ä¼šé¡ºå…¶è‡ªç„¶çš„å¢é•¿åˆ°é¢„æœŸçš„è®¾è®¡ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»ç„¶çœ‹åˆ°äººä»¬æå‰åˆ›å»ºæ¥å£ï¼Œå› ä¸ºä»–ä»¬è®¤ä¸ºä»–ä»¬å°†æ¥å¯èƒ½éœ€è¦å¤šä¸ªå®ç°ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘å¯¹ä»–ä»¬è¯´ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://img.golang.space/img-1719848026883.png&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;img&#34;
	
	
&gt;&lt;/p&gt;
&lt;p&gt;ä»¥ä¸€ç§å¥½çš„æ–¹å¼æ‡’æƒ°ã€‚åˆ›å»ºæ¥å£çš„æœ€ä½³æ—¶æœºæ˜¯ä½ çœŸæ­£éœ€è¦å®ƒçš„æ—¶å€™ï¼Œè€Œä¸æ˜¯ä½ é¢„æµ‹éœ€è¦å®ƒçš„æ—¶å€™ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªé€šè¿‡æå‰æ€è€ƒåˆ›å»ºæ¥å£çš„ç¤ºä¾‹ï¼Œä»¥åŠå®ƒå¯¼è‡´äº†ä»€ä¹ˆã€‚&lt;/p&gt;
&lt;p&gt;æ— ç”¨çš„æ¥å£å¾€å¾€åªæœ‰ä¸€ä¸ªå®ç°ã€‚å®ƒä»¬åªæ˜¯å¢åŠ äº†ä¸€ä¸ªé¢å¤–çš„é—´æ¥çº§åˆ«ï¼Œè¿«ä½¿ç¨‹åºå‘˜åœ¨çœŸæ­£æƒ³è¦å®ç°æ—¶æ€»æ˜¯é€šè¿‡å®ƒä»¬ã€‚&lt;/p&gt;
&lt;p&gt;æ¥å£æ˜¯æœ‰ä»£ä»·çš„ï¼šè¿™æ˜¯æ‚¨åœ¨æ¨ç†ä»£ç æ—¶éœ€è¦è®°ä½çš„ä¸€ä¸ªæ–°æ¦‚å¿µã€‚æ­£å¦‚ Djikstra æ‰€è¯´ï¼Œç†æƒ³çš„ç•Œé¢å¿…é¡»æ˜¯â€œa new semantic level in which one can be absolutely precise.â€ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœä½ çš„ä»£ç éœ€è¦ &lt;code&gt;Box&lt;/code&gt; çš„æ¦‚å¿µï¼Œä»…ç”± Box å®ç°çš„åä¸º Container çš„é¢å¤–æ¥å£æ²¡æœ‰å¸¦æ¥ä»»ä½•å¥½å¤„ï¼Œé™¤äº†æ··æ·†ã€‚&lt;/p&gt;
&lt;p&gt;å› æ­¤ï¼Œåœ¨åˆ›å»ºæ¥å£ä¹‹å‰ï¼Œå…ˆé—®é—®è‡ªå·±ï¼šæ¥å£æœ‰å¤šä¸ªå®ç°å—ï¼Ÿæˆ‘å¼ºè°ƒä½¿ç”¨äº†â€˜æœ‰â€™ï¼Œå› ä¸ºâ€˜å°†ä¼šæœ‰â€™å‡è®¾äº†ä½ èƒ½é¢„æµ‹æœªæ¥ï¼Œè€Œä½ ä¸èƒ½ã€‚&lt;/p&gt;
&lt;h2 id=&#34;2-ä½ æœ‰å¤ªå¤šçš„æ–¹æ³•&#34;&gt;2. ä½ æœ‰å¤ªå¤šçš„æ–¹æ³•&lt;/h2&gt;
&lt;p&gt;åœ¨ PHP é¡¹ç›®ä¸­ï¼Œçœ‹åˆ° 10 ç§æ–¹æ³•æ¥å£æ˜¯å¾ˆå¸¸è§çš„ã€‚åœ¨ Go ä¸­ï¼Œæ¥å£å¾ˆå°ï¼Œæ ‡å‡†åº“ä¸­æ‰€æœ‰æ¥å£ä¸Šçš„å¹³å‡æ–¹æ³•æ•°ä¸º 2ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;The bigger the interface the weaker the abstraction&lt;/strong&gt;ï¼Œè¿™æ˜¯ Go è°šè¯­ä¹‹ä¸€ã€‚æ­£å¦‚ Rob Pike æ‰€è¯´ï¼Œè¿™æ˜¯æ¥å£æœ€é‡è¦çš„ä¸€ç‚¹ï¼Œè¿™æ„å‘³ç€æ¥å£è¶Šå°ï¼Œå®ƒå°±è¶Šæœ‰ç”¨ã€‚&lt;/p&gt;
&lt;p&gt;æ¥å£å¯ä»¥æ‹¥æœ‰çš„å®ç°è¶Šå¤šï¼Œå®ƒçš„é€šç”¨æ€§å°±è¶Šå¼ºã€‚å¦‚æœä½ æœ‰ä¸€ä¸ªåŒ…å«å¤§é‡æ–¹æ³•çš„æ¥å£ï¼Œåˆ™å¾ˆéš¾æœ‰å®ƒçš„å¤šä¸ªå®ç°ã€‚æ‚¨æ‹¥æœ‰çš„æ–¹æ³•è¶Šå¤šï¼Œæ¥å£å°±è¶Šå…·ä½“ã€‚å®ƒè¶Šå…·ä½“ï¼Œä¸åŒç±»å‹æ˜¾ç¤ºç›¸åŒè¡Œä¸ºçš„å¯èƒ½æ€§å°±è¶Šä½ã€‚&lt;/p&gt;
&lt;p&gt;æœ‰ç”¨æ¥å£çš„ä¸€ä¸ªå¾ˆå¥½çš„ä¾‹å­æ˜¯ io.Reader å’Œ io.Writerï¼Œå®ƒä»¬å…·æœ‰æ•°ç™¾ä¸ªå®ç°ã€‚æˆ–è€… error æ¥å£ï¼Œå®ƒéå¸¸å¼ºå¤§ï¼Œå¯ä»¥åœ¨ Go ä¸­å®ç°æ•´ä¸ªé”™è¯¯å¤„ç†ã€‚&lt;/p&gt;
&lt;p&gt;è¯·è®°ä½ï¼Œä½ å¯ä»¥ç¨åç”¨å…¶ä»–æ¥å£ç»„åˆæ¥å£ã€‚ä¾‹å¦‚ï¼Œ &lt;code&gt;ReadWriteCloser&lt;/code&gt; ä¸‹é¢æ˜¯ç”± 3 ä¸ªè¾ƒå°çš„æ¥å£ç»„æˆçš„ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kd&#34;&gt;type&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;ReadWriteCloser&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;interface&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;nx&#34;&gt;Reader&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;nx&#34;&gt;Writer&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;nx&#34;&gt;Closer&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;3-ä½ ä¸ç¼–å†™è¡Œä¸ºé©±åŠ¨çš„æ¥å£&#34;&gt;3. ä½ ä¸ç¼–å†™è¡Œä¸ºé©±åŠ¨çš„æ¥å£&lt;/h2&gt;
&lt;p&gt;åœ¨ä¼ ç»Ÿè¯­è¨€ä¸­ï¼Œåè¯æ¥å£å¦‚ Userã€Requestã€ç­‰ç­‰éƒ½æ˜¯å¾ˆå¸¸è§çš„ã€‚åœ¨ Go ä¸­ï¼Œå¤§å¤šæ•°æ¥å£éƒ½æœ‰ä¸€ä¸ª &lt;code&gt;er&lt;/code&gt; åç¼€ï¼š &lt;code&gt;Reader&lt;/code&gt;  &lt;code&gt;Writer&lt;/code&gt; &lt;code&gt;Closer&lt;/code&gt; ç­‰ã€‚è¿™æ˜¯å› ä¸ºï¼Œåœ¨ Go ä¸­ï¼Œæ¥å£å…¬å¼€äº†è¡Œä¸ºï¼Œå®ƒä»¬çš„åç§°æŒ‡å‘äº†è¯¥è¡Œä¸ºã€‚&lt;/p&gt;
&lt;p&gt;æ­£å¦‚æˆ‘ä¹‹å‰åœ¨ IO åŸºç¡€ä¸­æ‰€å†™çš„ï¼Œåœ¨ Go ä¸­å®šä¹‰æ¥å£æ—¶ï¼Œä½ å®šä¹‰çš„ä¸æ˜¯æŸç‰©æ˜¯ä»€ä¹ˆï¼Œè€Œæ˜¯å®ƒæä¾›äº†ä»€ä¹ˆâ€”â€”è¡Œä¸ºï¼Œè€Œä¸æ˜¯äº‹ç‰©ï¼è¿™å°±æ˜¯ä¸ºä»€ä¹ˆ Go ä¸­æ²¡æœ‰ &lt;code&gt;File&lt;/code&gt; æ¥å£ï¼Œè€Œæ˜¯  &lt;code&gt;Reader&lt;/code&gt; å’Œ  &lt;code&gt;Writer&lt;/code&gt; ï¼š è¿™äº›æ˜¯è¡Œä¸ºï¼Œå¹¶ä¸”æ˜¯ &lt;code&gt;File&lt;/code&gt; å®ç° &lt;code&gt;Reader&lt;/code&gt; å’Œ &lt;code&gt;Writer&lt;/code&gt; çš„ä¸œè¥¿ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨å®˜æ–¹æŒ‡å—ã€ŠEffective Goã€‹ä¸­ä¹Ÿæåˆ°äº†åŒæ ·çš„æƒ³æ³•ï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;em&gt;Go ä¸­çš„æ¥å£æä¾›äº†ä¸€ç§æŒ‡å®šå¯¹è±¡è¡Œä¸ºçš„æ–¹æ³•ï¼šå¦‚æœæŸäº›ä¸œè¥¿å¯ä»¥åšåˆ°è¿™ä¸€ç‚¹ï¼Œé‚£ä¹ˆå®ƒå¯ä»¥åœ¨è¿™é‡Œä½¿ç”¨ã€‚&lt;/em&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;åœ¨ç¼–å†™æ¥å£æ—¶ï¼Œè¯·å°è¯•è€ƒè™‘æ“ä½œæˆ–è¡Œä¸ºã€‚å¦‚æœä½ å®šä¹‰äº†ä¸€ä¸ªåä¸ºçš„ &lt;code&gt;Thing&lt;/code&gt; æ¥å£ï¼Œé—®é—®è‡ªå·±ä¸ºä»€ä¹ˆ &lt;code&gt;Thing&lt;/code&gt; ä¸æ˜¯ä¸€ä¸ªç»“æ„ã€‚&lt;/p&gt;
&lt;h2 id=&#34;4-ä½ åœ¨ç”Ÿäº§è€…ç«¯ç¼–å†™æ¥å£&#34;&gt;4. ä½ åœ¨ç”Ÿäº§è€…ç«¯ç¼–å†™æ¥å£&lt;/h2&gt;
&lt;p&gt;æˆ‘ç»å¸¸åœ¨ä»£ç å®¡æŸ¥ä¸­çœ‹åˆ°è¿™ä¸€ç‚¹ï¼šäººä»¬åœ¨ç¼–å†™å…·ä½“å®ç°çš„åŒä¸€åŒ…ä¸­å®šä¹‰æ¥å£ã€‚&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯ï¼Œä¹Ÿè®¸å®¢æˆ·ç«¯ä¸æƒ³ä½¿ç”¨ç”Ÿäº§è€…ç•Œé¢ä¸­çš„æ‰€æœ‰æ–¹æ³•ã€‚è¯·è®°ä½ï¼Œä»æ¥å£éš”ç¦»åŸåˆ™ä¸­ï¼Œâ€œä¸åº”å¼ºè¿«å®¢æˆ·ç«¯å®ç°å®ƒä¸ä½¿ç”¨çš„æ–¹æ³•â€ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªç¤ºä¾‹ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;package&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;main&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// ====== producer side
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// This interface is not needed
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;type&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;UsersRepository&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;interface&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nf&#34;&gt;GetAllUsers&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nf&#34;&gt;GetUser&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;id&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;string&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kd&#34;&gt;type&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;UserRepository&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;struct&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;UserRepository&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;GetAllUsers&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;      &lt;span class=&#34;p&#34;&gt;{}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;UserRepository&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;GetUser&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;id&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;string&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// ====== client side
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// Client only needs GetUser and
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// can create this interface implicitly implemented
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// by concrete UserRepository on his side 
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;type&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;UserGetter&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;interface&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nf&#34;&gt;GetUser&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;id&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;string&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;å¦‚æœå®¢æˆ·æƒ³ä½¿ç”¨ producer çš„æ‰€æœ‰æ–¹æ³•ï¼Œä»–å¯ä»¥ä½¿ç”¨å…·ä½“ç»“æ„ã€‚è¯¥è¡Œä¸ºå·²é€šè¿‡ struct æ–¹æ³•æä¾›ã€‚&lt;/p&gt;
&lt;p&gt;å³ä½¿å®¢æˆ·ç«¯æƒ³è¦è§£è€¦å…¶ä»£ç å¹¶ä½¿ç”¨å¤šä¸ªå®ç°ï¼Œä»–ä»ç„¶å¯ä»¥åˆ›å»ºä¸€ä¸ªåŒ…å«ä»–è¿™è¾¹æ‰€æœ‰æ–¹æ³•çš„æ¥å£ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://img.golang.space/img-1719849001610.png&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;img&#34;
	
	
&gt;&lt;/p&gt;
&lt;p&gt;è¿™äº›ä¸œè¥¿æ˜¯é€šè¿‡ Go ä¸­çš„æ¥å£éšå¼æ»¡è¶³è¿™ä¸€äº‹å®æ¥å®ç°çš„ã€‚å®¢æˆ·ç«¯ä»£ç ä¸å†éœ€è¦å¯¼å…¥æŸäº›æ¥å£å¹¶å†™å…¥ &lt;code&gt;implements&lt;/code&gt; ï¼Œå› ä¸º Go ä¸­æ²¡æœ‰è¿™æ ·çš„å…³é”®å­—ã€‚å¦‚æœ &lt;code&gt;Implementation&lt;/code&gt; å…·æœ‰ä¸ &lt;code&gt;Interface&lt;/code&gt; ç›¸åŒçš„æ–¹æ³•ï¼Œåˆ™ &lt;code&gt;Implementation&lt;/code&gt; å·²æ»¡è¶³è¯¥æ¥å£ï¼Œå¹¶ä¸”å¯ä»¥åœ¨å®¢æˆ·ç«¯ä»£ç ä¸­ä½¿ç”¨ã€‚&lt;/p&gt;
&lt;h2 id=&#34;5-ä½ çš„æ–¹æ³•è¿”å›æ¥å£&#34;&gt;5. ä½ çš„æ–¹æ³•è¿”å›æ¥å£&lt;/h2&gt;
&lt;p&gt;å¦‚æœæ–¹æ³•è¿”å›æ¥å£è€Œä¸æ˜¯å…·ä½“ç»“æ„ï¼Œåˆ™è°ƒç”¨è¯¥æ–¹æ³•çš„æ‰€æœ‰å®¢æˆ·ç«¯éƒ½å°†å¼ºåˆ¶ä½¿ç”¨ç›¸åŒçš„æŠ½è±¡ã€‚ä½ éœ€è¦è®©å®¢æˆ·å†³å®šä»–ä»¬éœ€è¦ä»€ä¹ˆæŠ½è±¡ï¼Œå› ä¸ºä»£ç æ˜¯ä»–ä»¬çš„åº­é™¢ã€‚&lt;/p&gt;
&lt;p&gt;å½“ä½ æƒ³ä½¿ç”¨ç»“æ„ä¸­çš„æŸäº›å†…å®¹ä½†ä¸èƒ½ä½¿ç”¨æ—¶ï¼Œè¿™å¾ˆçƒ¦äººï¼Œå› ä¸ºæ¥å£æ²¡æœ‰å…¬å¼€å®ƒã€‚è¿™ç§é™åˆ¶å¯èƒ½æœ‰åŸå› ï¼Œä½†å¹¶éæ€»æ˜¯å¦‚æ­¤ã€‚è¿™é‡Œæœ‰ä¸€ä¸ªäººä¸ºçš„ä¾‹å­ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;package&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;main&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;math&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kd&#34;&gt;type&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;Shape&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;interface&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nf&#34;&gt;Area&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;float64&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nf&#34;&gt;Perimeter&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;float64&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kd&#34;&gt;type&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;Circle&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;struct&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nx&#34;&gt;Radius&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;float64&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;c&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;Circle&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;Area&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;float64&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;math&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Pi&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Radius&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Radius&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;c&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;Circle&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;Perimeter&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;float64&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;math&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Pi&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Radius&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// NewCircle returns an interface instead of struct
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;NewCircle&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;radius&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;float64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;Shape&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;Circle&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Radius&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;radius&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nx&#34;&gt;circle&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;NewCircle&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;5&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;// we lose access to circle.Radius
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä¸ä»…å¤±å»äº†å¯¹ &lt;code&gt;circle.Radius&lt;/code&gt; çš„è®¿é—®æƒé™ï¼Œè€Œä¸”æ¯æ¬¡æˆ‘ä»¬æƒ³è¦è®¿é—®å®ƒæ—¶ï¼Œæˆ‘ä»¬éƒ½éœ€è¦ç”¨ç±»å‹æ–­è¨€å¡«å……æˆ‘ä»¬çš„ä»£ç ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;shape&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;NewCircle&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;5&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;circle&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;ok&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;shape&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Circle&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;ok&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nx&#34;&gt;fmt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Println&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;circle&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Radius&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;è¦éµå¾ªæ³¢æ–¯ç‰¹å°”å®šå¾‹ï¼Œâ€œ&lt;strong&gt;ä½ æ¥å—ä»€ä¹ˆæ˜¯è‡ªç”±çš„ï¼Œè€Œä½ å‘é€ä»€ä¹ˆæ˜¯ä¿å®ˆçš„&lt;/strong&gt;â€ï¼Œä»ä½ çš„æ–¹æ³•ä¸­è¿”å›å…·ä½“çš„ç»“æ„ï¼Œå¹¶é€‰æ‹©ç”¨æ¥å£æ¥æ”¶ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨ Dave Cheney çš„ Practical Go ä¸­ï¼Œæœ‰ä¸€ç¯‡å¾ˆå¥½çš„æ–‡ç«   &lt;a class=&#34;link&#34; href=&#34;https://dave.cheney.net/practical-go/presentations/qcon-china.html#_let_functions_define_the_behaviour_they_requires&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;a nice write-up&lt;/a&gt;  è§£é‡Šäº†ä¸ºä»€ä¹ˆä»¥ä¸‹ä»£ç ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// Save writes the contents of doc to the file f.
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;Save&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;f&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;os&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;File&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;doc&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Document&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;error&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;é€šè¿‡æ¥å—æ¥å£è¿›è¡Œæ”¹è¿›ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;// Save writes the contents of doc to the supplied
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;// Writer.
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;func Save(w io.Writer, doc *Document) error
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;6-ä½ åˆ›å»ºæ¥å£çº¯ç²¹æ˜¯ä¸ºäº†æµ‹è¯•&#34;&gt;6. ä½ åˆ›å»ºæ¥å£çº¯ç²¹æ˜¯ä¸ºäº†æµ‹è¯•&lt;/h2&gt;
&lt;p&gt;è¿™æ˜¯æ¥å£æ±¡æŸ“çš„å¦ä¸€ä¸ªåŸå› ï¼šåˆ›å»ºä¸€ä¸ªåªæœ‰ä¸€ä¸ªå®ç°çš„æ¥å£ï¼Œåªæ˜¯å› ä¸ºä½ æƒ³æ¨¡æ‹Ÿè¿™ä¸ªå®ç°ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœé€šè¿‡åˆ›å»ºè®¸å¤šæ¨¡æ‹Ÿæ¥æ»¥ç”¨æ¥å£ï¼Œåˆ™æœ€ç»ˆä¼šæµ‹è¯•ä»æœªåœ¨ç”Ÿäº§ä¸­ä½¿ç”¨è¿‡çš„æ¨¡æ‹Ÿï¼Œè€Œä¸æ˜¯åº”ç”¨ç¨‹åºçš„å®é™…é€»è¾‘ã€‚åœ¨ä½ çš„å®é™…ä»£ç ä¸­ï¼Œä½ ç°åœ¨æœ‰ 2 ä¸ªæ¦‚å¿µï¼ˆæ­£å¦‚ Djikstra æ‰€è¯´ï¼Œè¯­ä¹‰çº§åˆ«ï¼‰å¯ä»¥åœ¨å…¶ä¸­æ‰§è¡Œã€‚è¿™åªæ˜¯ä¸ºäº†ä½ æƒ³è¦æµ‹è¯•çš„ä¸œè¥¿ã€‚ä½ æƒ³åœ¨æ¯æ¬¡åˆ›å»ºæ–°æµ‹è¯•æ—¶å°†è¯­ä¹‰çº§åˆ«æé«˜ä¸€å€å—ï¼Ÿ&lt;/p&gt;
&lt;p&gt;ä¾‹å¦‚ï¼Œä½ å§‹ç»ˆå¯ä»¥ä½¿ç”¨ testcontainers è€Œä¸æ˜¯æ¨¡æ‹Ÿä½ çš„æ•°æ®åº“ã€‚æˆ–è€…ï¼Œå¦‚æœ &lt;code&gt;testcontainers&lt;/code&gt; å°šä¸æ”¯æŒï¼Œåˆ™åªéœ€æ‹¥æœ‰è‡ªå·±çš„å®¹å™¨ã€‚&lt;/p&gt;
&lt;p&gt;æˆ–è€…ï¼Œä¹Ÿè®¸ä½ éœ€è¦ mock ä¸€äº›ä¸œè¥¿ï¼Œä½†ä¸æ˜¯æ•´ä¸ªäº‹æƒ…ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ æœ‰ä¸€ä¸ªåŒ…å« 10 ç§æ–¹æ³•çš„ç»“æ„ï¼Œä¹Ÿè®¸ä½ ä¸éœ€è¦æ¨¡æ‹Ÿæ•´ä¸ªç»“æ„ã€‚ä¹Ÿè®¸ä½ åªèƒ½æ¨¡æ‹Ÿä¸€å°éƒ¨åˆ†ï¼Œä½ å¯ä»¥åœ¨æµ‹è¯•ä¸­ä½¿ç”¨ä½ çš„å…·ä½“ç»“æ„ã€‚æ¨¡æ‹Ÿæ•´ä¸ªç»“æ„ä½“æ˜¯ä¸€ç§éå¸¸æ‡’æƒ°çš„æµ‹è¯•è§£å†³æ–¹æ¡ˆã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœä½ ç¼–å†™ä¸€ä¸ª APIï¼Œä½ ä¸éœ€è¦å‘ä½ çš„å®¢æˆ·ç«¯æä¾›ä¸€ä¸ªæ¥å£ï¼Œè¿™æ ·ä»–ä»¬å°±å¯ä»¥ç”¨å®ƒæ¥æ¨¡æ‹Ÿã€‚å¦‚æœä»–ä»¬æƒ³ç¼–å†™æ¨¡æ‹Ÿï¼Œä»–ä»¬å¯ä»¥é€šè¿‡æŒ‡å®šè‡ªå·±çš„æ¥å£æ¥è‡ªå·±å®Œæˆï¼ˆå‚è§ç¬¬ 4 ç‚¹ï¼‰&lt;/p&gt;
&lt;h2 id=&#34;7-æ‚¨ä¸éªŒè¯æ¥å£åˆè§„æ€§&#34;&gt;7. æ‚¨ä¸éªŒè¯æ¥å£åˆè§„æ€§&lt;/h2&gt;
&lt;p&gt;å‡è®¾ä½ æœ‰ä¸€ä¸ªåŒ…ï¼Œè¯¥åŒ…å¯¼å‡ºäº†åä¸º &lt;code&gt;User&lt;/code&gt; çš„ç±»å‹ï¼Œå¹¶ä¸”nä½ å®ç°äº†è¯¥ &lt;code&gt;Stringer&lt;/code&gt; æ¥å£ï¼Œå› ä¸ºå‡ºäºæŸç§åŸå› ï¼Œå½“ä½ æ‰“å°å®ƒæ—¶ï¼Œä½ ä¸å¸Œæœ›æ˜¾ç¤ºç”µå­é‚®ä»¶ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;package&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;users&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kd&#34;&gt;type&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;User&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;struct&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nx&#34;&gt;Name&lt;/span&gt;  &lt;span class=&#34;kt&#34;&gt;string&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nx&#34;&gt;Email&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;string&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;u&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;User&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;String&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;string&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;u&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Name&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;å®¢æˆ·ç«¯å…·æœ‰ä»¥ä¸‹ä»£ç ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;package&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;main&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;s&#34;&gt;&amp;#34;fmt&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;s&#34;&gt;&amp;#34;pkg/users&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nx&#34;&gt;u&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;users&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;User&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;       &lt;span class=&#34;nx&#34;&gt;Name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;  &lt;span class=&#34;s&#34;&gt;&amp;#34;John Doe&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;       &lt;span class=&#34;nx&#34;&gt;Email&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;john.doe@gmail.com&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nx&#34;&gt;fmt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Printf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;%s&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;u&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;è¿™å°†æ­£ç¡®è¾“å‡ºï¼š &lt;code&gt;John Doe&lt;/code&gt; ã€‚&lt;/p&gt;
&lt;p&gt;ç°åœ¨ï¼Œå‡è®¾æ‚¨é‡æ„ï¼Œå¹¶ä¸”é”™è¯¯åœ°åˆ é™¤æˆ–æ³¨é‡Šäº† &lt;code&gt;String()&lt;/code&gt; å®ç°ï¼Œå¹¶ä¸”æ‚¨çš„ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;package&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;users&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kd&#34;&gt;type&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;User&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;struct&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nx&#34;&gt;Name&lt;/span&gt;  &lt;span class=&#34;kt&#34;&gt;string&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nx&#34;&gt;Email&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;string&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä»£ç ä»å°†ç¼–è¯‘å¹¶è¿è¡Œï¼Œä½†è¾“å‡ºç°åœ¨å°†ä¸º &lt;code&gt;{John Doe john.doe@gmail.com}&lt;/code&gt; â€œæ²¡æœ‰åé¦ˆå¼ºåˆ¶æ‰§è¡Œä¹‹å‰çš„æ„å›¾â€ã€‚&lt;/p&gt;
&lt;p&gt;å½“æ‚¨æœ‰æ¥å— User çš„æ–¹æ³•æ—¶ï¼Œç¼–è¯‘å™¨ä¼šä¸ºæ‚¨æä¾›å¸®åŠ©ï¼Œä½†åœ¨ä¸Šè¿°æƒ…å†µä¸‹ï¼Œç¼–è¯‘å™¨ä¸ä¼šã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†å¼ºåˆ¶æ‰§è¡ŒæŸä¸ªç±»å‹å®ç°æ¥å£çš„äº‹å®ï¼Œæˆ‘ä»¬å¯ä»¥æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;package&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;users&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;fmt&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kd&#34;&gt;type&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;User&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;struct&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nx&#34;&gt;Name&lt;/span&gt;  &lt;span class=&#34;kt&#34;&gt;string&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nx&#34;&gt;Email&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;string&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kd&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;_&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;fmt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Stringer&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;User&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{}&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// User implements the fmt.Stringer
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;u&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;User&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;String&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;string&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;u&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Name&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;ç°åœ¨ï¼Œå¦‚æœæˆ‘ä»¬åˆ é™¤è¯¥ &lt;code&gt;String()&lt;/code&gt; æ–¹æ³•ï¼Œæˆ‘ä»¬å°†åœ¨æ„å»ºæ—¶å¾—åˆ°ä»¥ä¸‹å†…å®¹ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-fallback&#34; data-lang=&#34;fallback&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;cannot use User{} (value of type User) as fmt.Stringer value in variable declaration: User does not implement fmt.Stringer (missing method String)
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;æˆ‘ä»¬åœ¨é‚£ä¸€è¡Œä¸­æ‰€åšçš„æ˜¯ï¼Œå°è¯•å°†ä¸€ä¸ªç©º &lt;code&gt;User{}&lt;/code&gt; åˆ†é…ç»™ç±»å‹ &lt;code&gt;fmt.Stringer&lt;/code&gt; ã€‚ç”±äºåœæ­¢å®ç° &lt;code&gt;fmt.Stringer&lt;/code&gt; ï¼Œ &lt;code&gt;User{}&lt;/code&gt; æ”¶åˆ°äº†æŠ•è¯‰ã€‚æˆ‘ä»¬ä½¿ç”¨ &lt;code&gt;_&lt;/code&gt; ä½œä¸ºå˜é‡åç§°ï¼Œæˆ‘ä»¬å¹¶æ²¡æœ‰çœŸæ­£ä½¿ç”¨å®ƒæ‰€ä»¥ä¸ä¼šæ‰§è¡Œä»»ä½•åˆ†é…ã€‚&lt;/p&gt;
&lt;p&gt;ä¸Šé¢æˆ‘ä»¬æœ‰ &lt;code&gt;User&lt;/code&gt; å®ç°æ¥å£ã€‚ &lt;code&gt;User&lt;/code&gt; å¹¶ä¸”æ˜¯ &lt;code&gt;*User&lt;/code&gt; ä¸åŒçš„ç±»å‹ã€‚å› æ­¤ï¼Œå¦‚æœä½ æƒ³å®ç°å®ƒï¼Œ &lt;code&gt;*User&lt;/code&gt; ä½ å¯ä»¥åšè¿™æ ·çš„äº‹æƒ…ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kd&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;_&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;fmt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Stringer&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;User&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)(&lt;/span&gt;&lt;span class=&#34;kc&#34;&gt;nil&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// *User implements the fmt.Stringer
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;æˆ‘ä¹Ÿå–œæ¬¢åœ¨è¿™æ ·åšæ—¶ï¼Œæˆ‘çš„Goland IDEä¼šå‘æˆ‘æ˜¾ç¤ºä¸€ä¸ªâ€œå®ç°ç¼ºå°‘çš„æ–¹æ³•â€é€‰é¡¹ï¼š&lt;/p&gt;
&lt;p&gt;å¦‚éœ€äº†è§£è¯¦æƒ…ï¼Œè¯·æŸ¥çœ‹ &lt;a class=&#34;link&#34; href=&#34;https://medium.com/@matryer/golang-tip-compile-time-checks-to-ensure-your-type-satisfies-an-interface-c167afed3aae&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;article from Mat Ryer&lt;/a&gt; æˆ–  &lt;a class=&#34;link&#34; href=&#34;https://github.com/uber-go/guide/blob/master/style.md#verify-interface-compliance&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Uber Go Style&lt;/a&gt; çš„æŒ‡å—ã€‚&lt;/p&gt;
&lt;p&gt;è™½ç„¶è¿™æ˜¯ä¸€ä¸ªå¾ˆé…·çš„æŠ€å·§ï¼Œä½†ä½ ä¸éœ€è¦å¯¹æ¯ä¸ªå®ç°æ¥å£çš„ç±»å‹éƒ½è¿™æ ·åšï¼Œå¦‚æœæˆ‘ä»¬æœ‰éœ€è¦æ¥å£çš„å‡½æ•°ï¼Œå¦‚æœä½ å°è¯•ä½¿ç”¨ä¸å®ç°å®ƒä»¬çš„ç±»å‹ï¼Œç¼–è¯‘å™¨å·²ç»æŠ±æ€¨äº†ã€‚æˆ‘è‡ªå·±ä¸å¾—ä¸æ€è€ƒä¸€æ®µæ—¶é—´æ‰èƒ½ä¸ºæœ¬æ–‡æƒ³å‡ºä¸€ä¸ªä¾‹å­ï¼Œæ‰€ä»¥çœŸçš„ï¼Œè¿™æ˜¯ä¸€ä¸ªç½•è§çš„æ¡ˆä¾‹ã€‚&lt;/p&gt;
&lt;p&gt;æ­£å¦‚æˆ‘ä»¬åœ¨ Effective Go ä¸­è¢«è­¦å‘Šçš„é‚£æ ·ï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;em&gt;The appearance of the blank identifier in this construct indicates that the declaration exists only for the type checking, not to create a variable. Donâ€™t do this for every type that satisfies an interface, though. By convention, such declarations are only used when there are no static conversions already present in the code, which is a rare event.&lt;/em&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;å°±è¿™äº›äº†!&lt;/p&gt;
&lt;h2 id=&#34;å‚è€ƒ&#34;&gt;å‚è€ƒ&lt;/h2&gt;
&lt;p&gt;æœ¬æ–‡ç¿»è¯‘äº&lt;a class=&#34;link&#34; href=&#34;https://medium.com/@andreiboar/7-common-interface-mistakes-in-go-1d3f8e58be60&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt; &amp;lt;7 Common Interface Mistakes in Go&amp;gt;&lt;/a&gt;&lt;/p&gt;
</description>
        </item>
        
    </channel>
</rss>
